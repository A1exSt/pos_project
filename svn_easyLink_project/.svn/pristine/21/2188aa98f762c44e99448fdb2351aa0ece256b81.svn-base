/*------------------------------------------------------------
* FileName: EmvTest.c
* Author:	ZhangYuan
* Date:		2016-08-10
------------------------------------------------------------*/

#include "..\inc\global.h"

//#define DEBUG_	1
//#define DEBUG_SERIAL 1
#ifdef EMV_PARAM_TEST_

EMVParamInfo	g_stEmvParamInfo = {0x00, 0, FILE_EMV_AID_BLOCK_START, 0, FILE_EMV_CAPK_BLOCK_START, 0, 0, FILE_EMV_REVOKE_CAPK_BLOCK_START, 0, FILE_EMV_PARAMETER_BLOCK_START, FILE_EMV_EXTM_PARAM_BLOCK_START, FILE_EMV_MCK_PARAM_BLOCK_START};

extern void AppLog(char *formatString, ...);
extern void AppHexLog(unsigned char *pucMsg, unsigned char *pucData, int iDataLen);

int writeEMVAPP(void)
{
	int			iRet=0, i=0, iAppNum=0, iFd=0;
	EMVAppInfo	stEmvAppInfo;

	EMV_APPLIST stAppList[]={
		{
			"",
			"\xA0\x00\x00\x00\x25\x01",	// AE
			6,PART_MATCH,0,0,0,1,1,1,
			5000,0,
			"\x00\x10\x00\x00\x00",
			"\xD8\x40\x04\xF8\x00",
			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x8c",
			"",
		},

		{
			"",
			"\xA0\x00\x00\x00\x65\x10\x10",	// JCB
			7,PART_MATCH,0,0,0,1,1,1,
			10000,0,
			"\x00\x10\x00\x00\x00",
			"\xD8\x40\x04\xF8\x00",
			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x02\x00",
			"",
		},
		
		{
			"VISA CREDIT",
			"\xA0\x00\x00\x00\x03\x10\x10",	// VISA--VSDC
			7,PART_MATCH,0,0,0,1,1,1,
			10000,0,
			"\x00\x10\x00\x00\x00",
			"\xD8\x40\x04\xF8\x00",
			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x8c",
			"",
		},
		
		{
			"VISA ELECTRON",
			"\xA0\x00\x00\x00\x03\x20\x10",	// VISA--ELECTRON
			7,PART_MATCH,0,0,0,1,1,1,
			10000,0,
			"\x00\x10\x00\x00\x00",
			"\xD8\x40\x04\xF8\x00",
			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x8c",
			"",
		},
		
		{
			"MCHIP",
			"\xA0\x00\x00\x00\x04\x10\x10",	// MASTER--MCHIP
			7, 
			PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x04\x00\x00\x00\x00",
//			"\xF8\x50\xAC\xF8\x00",
//			"\xFC\x50\xAC\xA0\x00",
//			"\x00\x10\x00\x00\x00",
//			"\xD8\x40\x04\xF8\x00",
//			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x00\x00",
			"\xFC\x50\xBC\xF8\x00",
			"\xFC\x50\xBC\xA0\x00",			
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x02",
			"",
		},
		
		{
			"MAESTRO",
			"\xA0\x00\x00\x00\x04\x30\x60",	// MASTER--MAESTRO
			7, /*7->5*/
			PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x00\x10\x00\x00\x00",
//			"\xD8\x40\x04\xF8\x00",
//			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x00\x00",
			"\xFC\x50\xBC\xF8\x00",
			"\xFC\x50\xBC\xA0\x00",	
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x02",
			"",
		},
		
		{
			"CIRRUS",
			"\xA0\x00\x00\x00\x04\x60\x00",	// MASTER--CIRRUS
			7, /*7->5*/
			PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x04\x00\x00\x00\x00",
//			"\xF8\x50\xAC\xF8\x00",
//			"\xFC\x50\xAC\xA0\x00",
//			"\x00\x10\x00\x00\x00",
//			"\xD8\x40\x04\xF8\x00",
//			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x00\x00",
			"\xFC\x50\xBC\xF8\x00",
			"\xFC\x50\xBC\xA0\x00",	
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x02",
			"",
		},
		
		{
			"",
			"\xA0\x00\x00\x00\x04\x60\x10",
			7, /*7->5*/
			PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x04\x00\x00\x00\x00",
//			"\xF8\x50\xAC\xF8\x00",
//			"\xFC\x50\xAC\xA0\x00",
//			"\x00\x10\x00\x00\x00",
//			"\xD8\x40\x04\xF8\x00",
//			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x00\x00",
			"\xFC\x50\xBC\xF8\x00",
			"\xFC\x50\xBC\xA0\x00",	
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x02",
			"",
		},

		{	// added by Jay -- 20150122
			"",
			"\xA0\x00\x00\x00\x04\x22\x03",
			7, /*7->5*/
			PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x04\x00\x00\x00\x00",
//			"\xF8\x50\xAC\xF8\x00",
//			"\xFC\x50\xAC\xA0\x00",
//			"\x00\x10\x00\x00\x00",
//			"\xD8\x40\x04\xF8\x00",
//			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x00\x00",
			"\xFC\x50\xBC\xF8\x00",
			"\xFC\x50\xBC\xA0\x00",	
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x02",
			"",
		},

			
		{
			"",
			"\xA0\x00\x00\x00\x10\x10\x30",	// What is this?
			7, /*7->5*/
			PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x04\x00\x00\x00\x00",
//			"\xF8\x50\xAC\xF8\x00",
//			"\xFC\x50\xAC\xA0\x00",
			"\x00\x10\x00\x00\x00",
			"\xD8\x40\x04\xF8\x00",
			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x0F\x9F\x02\x06\x5F\x2A\x02\x9A\x03\x9C\x01\x95\x05\x9F\x37\x04",
			"\x00\x02",
			"",
		},
		
		{
			"",
			"\xA0\x00\x00\x01\x52\x30\x10",
			7,PART_MATCH,0,0,0,1,1,1,
			10000,0,
//			"\x00\x00\x00\x00\x00",
//			"\x00\x00\x00\x00\x00",
//			"\x00\x00\x00\x00\x00",
			"\x00\x10\x00\x00\x00",
			"\xD8\x40\x04\xF8\x00",
			"\xD8\x40\x00\xA8\x00",
			"\x00\x00\x00\x12\x34\x56",
			"\x03\x9F\x37\x04",
			"\x9F\x37\x04",
			"\x00\x01",
			"",
		}
	};

	iFd = PdkFile_Open(EMV_APP_LIST_FILE);
	if ( iFd < 0 ) {
		return iFd;
	}

	iAppNum = sizeof(stAppList) /sizeof(EMV_APPLIST);
	for(i=0; i < iAppNum; i++)
	{
		iRet = PdkFile_Write(iFd, (unsigned char *)&stAppList[i], sizeof(EMV_APPLIST));
#ifdef DEBUG_
		AppLog("save aid PdkFile_Write = %d ", iRet);
#endif
	}
	g_stEmvParamInfo.usAidNum = iAppNum; 

#ifdef DEBUG_
	iRet = PdkFile_GetSize(EMV_APP_LIST_FILE);
	AppLog("PdkFile_GetSize = %d ", iRet);
#endif

	PdkFile_Close(iFd);
	return 0;
}


int writeEMVCAPK_MoreVisa(int *piBlockIndex, int *piBlockPos)
{

	int				iRet=0, i=0, iFd=0;
	EMVCapkInfo		stEmvCapkInfo;

	EMV_CAPK capk_visa_v03={{0xA0,0x00,0x00,0x00,0x03},0x03,
		0x01,0x01,112,
	{0xB3,0xE5,0xE6,0x67,0x50,0x6C,0x47,0xCA,0xAF,0xB1,0x2A,0x26,0x33,0x81,0x93,0x50,
	0x84,0x66,0x97,0xDD,0x65,0xA7,0x96,0xE5,0xCE,0x77,0xC5,0x7C,0x62,0x6A,0x66,0xF7,
	0x0B,0xB6,0x30,0x91,0x16,0x12,0xAD,0x28,0x32,0x90,0x9B,0x80,0x62,0x29,0x1B,0xEC,
	0xA4,0x6C,0xD3,0x3B,0x66,0xA6,0xF9,0xC9,0xD4,0x8C,0xED,0x8B,0x4F,0xC8,0x56,0x1C,
	0x8A,0x1D,0x8F,0xB1,0x58,0x62,0xC9,0xEB,0x60,0x17,0x8D,0xEA,0x2B,0xE1,0xF8,0x22,
	0x36,0xFF,0xCF,0xF4,0xF3,0x84,0x3C,0x27,0x21,0x79,0xDC,0xDD,0x38,0x4D,0x54,0x10,
	0x53,0xDA,0x6A,0x6A,0x0D,0x3C,0xE4,0x8F,0xDC,0x2D,0xC4,0xE3,0xE0,0xEE,0xE1,0x5F},
	1,{0x03},{0x15,0x12,0x31},
	{0xFE,0x70,0xAB,0x3B,0x4D,0x5A,0x1B,0x99,0x24,0x22,0x8A,0xDF,0x80,0x27,0xC7,0x58,
	0x48,0x3A,0x8B,0x7E}
	};

	EMV_CAPK capk_visa_v05={{0xA0,0x00,0x00,0x00,0x03},0x05,
		0x01,0x01,96,
	{0xD0,0x13,0x5C,0xE8,0xA4,0x43,0x6C,0x7F,0x9D,0x5C,0xC6,0x65,0x47,0xE3,0x0E,0xA4,
	0x02,0xF9,0x81,0x05,0xB7,0x17,0x22,0xE2,0x4B,0xC0,0x8D,0xCC,0x80,0xAB,0x7E,0x71,
	0xEC,0x23,0xB8,0xCE,0x6A,0x1D,0xC6,0xAC,0x2A,0x8C,0xF5,0x55,0x43,0xD7,0x4A,0x8A,
	0xE7,0xB3,0x88,0xF9,0xB1,0x74,0xB7,0xF0,0xD7,0x56,0xC2,0x2C,0xBB,0x59,0x74,0xF9,
	0x01,0x6A,0x56,0xB6,0x01,0xCC,0xA6,0x4C,0x71,0xF0,0x4B,0x78,0xE8,0x6C,0x50,0x1B,
	0x19,0x3A,0x55,0x56,0xD5,0x38,0x9E,0xCE,0x4D,0xEA,0x25,0x8A,0xB9,0x7F,0x52,0xA3},
	1,{0x03},{0x15,0x12,0x31},
	{0x86,0xDF,0x04,0x1E,0x79,0x95,0x02,0x35,0x52,0xA7,0x9E,0x26,0x23,0xE4,0x91,0x80,
	0xC0,0xCD,0x95,0x7A}
	};

	EMV_CAPK capk_visa_v09={{0xA0,0x00,0x00,0x00,0x03},0x09,
		0x01,0x01,248,
	{0x9D,0x91,0x22,0x48,0xDE,0x0A,0x4E,0x39,0xC1,0xA7,0xDD,0xE3,0xF6,0xD2,0x58,0x89,
	0x92,0xC1,0xA4,0x09,0x5A,0xFB,0xD1,0x82,0x4D,0x1B,0xA7,0x48,0x47,0xF2,0xBC,0x49,
	0x26,0xD2,0xEF,0xD9,0x04,0xB4,0xB5,0x49,0x54,0xCD,0x18,0x9A,0x54,0xC5,0xD1,0x17,
	0x96,0x54,0xF8,0xF9,0xB0,0xD2,0xAB,0x5F,0x03,0x57,0xEB,0x64,0x2F,0xED,0xA9,0x5D,
	0x39,0x12,0xC6,0x57,0x69,0x45,0xFA,0xB8,0x97,0xE7,0x06,0x2C,0xAA,0x44,0xA4,0xAA,
	0x06,0xB8,0xFE,0x6E,0x3D,0xBA,0x18,0xAF,0x6A,0xE3,0x73,0x8E,0x30,0x42,0x9E,0xE9,
	0xBE,0x03,0x42,0x7C,0x9D,0x64,0xF6,0x95,0xFA,0x8C,0xAB,0x4B,0xFE,0x37,0x68,0x53,
	0xEA,0x34,0xAD,0x1D,0x76,0xBF,0xCA,0xD1,0x59,0x08,0xC0,0x77,0xFF,0xE6,0xDC,0x55,
	0x21,0xEC,0xEF,0x5D,0x27,0x8A,0x96,0xE2,0x6F,0x57,0x35,0x9F,0xFA,0xED,0xA1,0x94,
	0x34,0xB9,0x37,0xF1,0xAD,0x99,0x9D,0xC5,0xC4,0x1E,0xB1,0x19,0x35,0xB4,0x4C,0x18,
	0x10,0x0E,0x85,0x7F,0x43,0x1A,0x4A,0x5A,0x6B,0xB6,0x51,0x14,0xF1,0x74,0xC2,0xD7,
	0xB5,0x9F,0xDF,0x23,0x7D,0x6B,0xB1,0xDD,0x09,0x16,0xE6,0x44,0xD7,0x09,0xDE,0xD5,
	0x64,0x81,0x47,0x7C,0x75,0xD9,0x5C,0xDD,0x68,0x25,0x46,0x15,0xF7,0x74,0x0E,0xC0,
	0x7F,0x33,0x0A,0xC5,0xD6,0x7B,0xCD,0x75,0xBF,0x23,0xD2,0x8A,0x14,0x08,0x26,0xC0,
	0x26,0xDB,0xDE,0x97,0x1A,0x37,0xCD,0x3E,0xF9,0xB8,0xDF,0x64,0x4A,0xC3,0x85,0x01,
	0x05,0x01,0xEF,0xC6,0x50,0x9D,0x7A,0x41},
	1,{0x03},{0x15,0x12,0x31},
	{0x1F,0xF8,0x0A,0x40,0x17,0x3F,0x52,0xD7,0xD2,0x7E,0x0F,0x26,0xA1,0x46,0xA1,0xC8,
	0xCC,0xB2,0x90,0x46}
	};

	EMV_CAPK capk_visa_v92={{0xA0,0x00,0x00,0x00,0x03},0x92,
		0x01,0x01,176,
	{0x99,0x6A,0xF5,0x6F,0x56,0x91,0x87,0xD0,0x92,0x93,0xC1,0x48,0x10,0x45,0x0E,0xD8,
	0xEE,0x33,0x57,0x39,0x7B,0x18,0xA2,0x45,0x8E,0xFA,0xA9,0x2D,0xA3,0xB6,0xDF,0x65,
	0x14,0xEC,0x06,0x01,0x95,0x31,0x8F,0xD4,0x3B,0xE9,0xB8,0xF0,0xCC,0x66,0x9E,0x3F,
	0x84,0x40,0x57,0xCB,0xDD,0xF8,0xBD,0xA1,0x91,0xBB,0x64,0x47,0x3B,0xC8,0xDC,0x9A,
	0x73,0x0D,0xB8,0xF6,0xB4,0xED,0xE3,0x92,0x41,0x86,0xFF,0xD9,0xB8,0xC7,0x73,0x57,
	0x89,0xC2,0x3A,0x36,0xBA,0x0B,0x8A,0xF6,0x53,0x72,0xEB,0x57,0xEA,0x5D,0x89,0xE7,
	0xD1,0x4E,0x9C,0x7B,0x6B,0x55,0x74,0x60,0xF1,0x08,0x85,0xDA,0x16,0xAC,0x92,0x3F,
	0x15,0xAF,0x37,0x58,0xF0,0xF0,0x3E,0xBD,0x3C,0x5C,0x2C,0x94,0x9C,0xBA,0x30,0x6D,
	0xB4,0x4E,0x6A,0x2C,0x07,0x6C,0x5F,0x67,0xE2,0x81,0xD7,0xEF,0x56,0x78,0x5D,0xC4,
	0xD7,0x59,0x45,0xE4,0x91,0xF0,0x19,0x18,0x80,0x0A,0x9E,0x2D,0xC6,0x6F,0x60,0x08,
	0x05,0x66,0xCE,0x0D,0xAF,0x8D,0x17,0xEA,0xD4,0x6A,0xD8,0xE3,0x0A,0x24,0x7C,0x9F},
	1,{0x03},{0x15,0x12,0x31},
	{0x42,0x9C,0x95,0x4A,0x38,0x59,0xCE,0xF9,0x12,0x95,0xF6,0x63,0xC9,0x63,0xE5,0x82,0xED,
	0x6E,0xB2,0x53}
	};

	EMV_CAPK capk_visa_v94={{0xA0,0x00,0x00,0x00,0x03},0x94,
		0x01,0x01,248,
	{0xD1,0xBE,0x39,0x61,0x5F,0x39,0x5A,0xC9,0x33,0x7E,0x33,0x07,0xAA,0x5A,0x7A,0xC3,
	0x5E,0xAE,0x00,0x36,0xBF,0x20,0xB9,0x2F,0x9A,0x45,0xD1,0x90,0xB2,0xF4,0x61,0x6A,
	0xBF,0x9D,0x34,0x0C,0xBF,0x5F,0xBB,0x3A,0x2B,0x94,0xBD,0x8F,0x2F,0x97,0x7C,0x0A,
	0x10,0xB9,0x0E,0x59,0xD4,0x20,0x1A,0xA3,0x26,0x69,0xE8,0xCB,0xE7,0x53,0xF5,0x36,
	0x11,0x9D,0xF4,0xFB,0x5E,0x63,0xCE,0xD8,0x7F,0x11,0x53,0xCE,0x91,0x4B,0x12,0x4F,
	0x3E,0x6B,0x64,0x8C,0xD5,0xC9,0x76,0x55,0xF7,0xAB,0x4D,0xF6,0x26,0x07,0xC9,0x5D,
	0xA5,0x05,0x17,0xAB,0x8B,0xE3,0x83,0x66,0x72,0xD1,0xC7,0x1B,0xCD,0xE9,0xBA,0x72,
	0x93,0xFF,0x34,0x82,0xF1,0x24,0xF8,0x66,0x91,0x13,0x0A,0xB0,0x81,0x77,0xB0,0x2F,
	0x45,0x9C,0x02,0x5A,0x1F,0x3D,0xFF,0xE0,0x88,0x4C,0xE7,0x81,0x22,0x54,0x2E,0xA1,
	0xC8,0xEA,0x09,0x2B,0x55,0x2B,0x58,0x69,0x07,0xC8,0x3A,0xD6,0x5E,0x0C,0x6F,0x91,
	0xA4,0x00,0xE4,0x85,0xE1,0x11,0x92,0xAA,0x4C,0x17,0x1C,0x5A,0x1E,0xF5,0x63,0x81,
	0xF4,0xD0,0x91,0xCC,0x7E,0xF6,0xBD,0x86,0x04,0xCB,0xC4,0xC7,0x4D,0x5D,0x77,0xFF,
	0xA0,0x7B,0x64,0x1D,0x53,0x99,0x8C,0xDB,0x5C,0x21,0xB7,0xBC,0x65,0xE0,0x82,0xA6,
	0x51,0x3F,0x42,0x4A,0x4B,0x25,0x2E,0x0D,0x77,0xFA,0x40,0x56,0x98,0x6A,0x0A,0xB0,
	0xCD,0xA6,0x15,0x5E,0xD9,0xA8,0x83,0xC6,0x9C,0xC2,0x99,0x2D,0x49,0xEC,0xBD,0x47,
	0x97,0xDD,0x28,0x64,0xFF,0xC9,0x6B,0x8D},
	3,{0x01,0x00,0x01},{0x15,0x12,0x31},
	{0x1D,0x19,0x31,0x49,0xFD,0x83,0xDC,0xB3,0x37,0xF4,0xA1,0xB5,0xCF,0xAA,0x14,0x4D,
	0x06,0x6B,0x66,0xFB}
	};

	EMV_CAPK capk_visa_v95={{0xA0,0x00,0x00,0x00,0x03},0x95,
		0x01,0x01,144,
	{0xBE,0x9E,0x1F,0xA5,0xE9,0xA8,0x03,0x85,0x29,0x99,0xC4,0xAB,0x43,0x2D,0xB2,0x86,
	0x00,0xDC,0xD9,0xDA,0xB7,0x6D,0xFA,0xAA,0x47,0x35,0x5A,0x0F,0xE3,0x7B,0x15,0x08,
	0xAC,0x6B,0xF3,0x88,0x60,0xD3,0xC6,0xC2,0xE5,0xB1,0x2A,0x3C,0xAA,0xF2,0xA7,0x00,
	0x5A,0x72,0x41,0xEB,0xAA,0x77,0x71,0x11,0x2C,0x74,0xCF,0x9A,0x06,0x34,0x65,0x2F,
	0xBC,0xA0,0xE5,0x98,0x0C,0x54,0xA6,0x47,0x61,0xEA,0x10,0x1A,0x11,0x4E,0x0F,0x0B,
	0x55,0x72,0xAD,0xD5,0x7D,0x01,0x0B,0x7C,0x9C,0x88,0x7E,0x10,0x4C,0xA4,0xEE,0x12,
	0x72,0xDA,0x66,0xD9,0x97,0xB9,0xA9,0x0B,0x5A,0x6D,0x62,0x4A,0xB6,0xC5,0x7E,0x73,
	0xC8,0xF9,0x19,0x00,0x0E,0xB5,0xF6,0x84,0x89,0x8E,0xF8,0xC3,0xDB,0xEF,0xB3,0x30,
	0xC6,0x26,0x60,0xBE,0xD8,0x8E,0xA7,0x8E,0x90,0x9A,0xFF,0x05,0xF6,0xDA,0x62,0x7B},
	1,{0x03},{0x15,0x12,0x31},
	{0xEE,0x15,0x11,0xCE,0xC7,0x10,0x20,0xA9,0xB9,0x04,0x43,0xB3,0x7B,0x1D,0x5F,0x6E,
	0x70,0x30,0x30,0xF6}
	};

	EMV_CAPK capk_visa_v96={{0xA0,0x00,0x00,0x00,0x03},0x96, 
		0x01,0x01,128, 
	{0xB7,0x45,0x86,0xD1,0x9A,0x20,0x7B,0xE6,0x62,0x7C,0x5B,0x0A,0xAF,0xBC,0x44,0xA2,
	0xEC,0xF5,0xA2,0x94,0x2D,0x3A,0x26,0xCE,0x19,0xC4,0xFF,0xAE,0xEE,0x92,0x05,0x21,
	0x86,0x89,0x22,0xE8,0x93,0xE7,0x83,0x82,0x25,0xA3,0x94,0x7A,0x26,0x14,0x79,0x6F,
	0xB2,0xC0,0x62,0x8C,0xE8,0xC1,0x1E,0x38,0x25,0xA5,0x6D,0x3B,0x1B,0xBA,0xEF,0x78,
	0x3A,0x5C,0x6A,0x81,0xF3,0x6F,0x86,0x25,0x39,0x51,0x26,0xFA,0x98,0x3C,0x52,0x16,
	0xD3,0x16,0x6D,0x48,0xAC,0xDE,0x8A,0x43,0x12,0x12,0xFF,0x76,0x3A,0x7F,0x79,0xD9,
	0xED,0xB7,0xFE,0xD7,0x6B,0x48,0x5D,0xE4,0x5B,0xEB,0x82,0x9A,0x3D,0x47,0x30,0x84,
	0x8A,0x36,0x6D,0x33,0x24,0xC3,0x02,0x70,0x32,0xFF,0x8D,0x16,0xA1,0xE4,0x4D,0x8D},
	1,{0x03},{0x15,0x12,0x31},
	{0x76,0x16,0xE9,0xAC,0x8B,0xE0,0x14,0xAF,0x88,0xCA,0x11,0xA8,0xFB,0x17,0x96,0x7B,
	0x73,0x94,0x03,0x0E} 
	}; 

	EMV_CAPK capk_visa_v98={{0xA0,0x00,0x00,0x00,0x03},0x98, 
		0x01,0x01,112, 
	{0xCA,0x02,0x6E,0x52,0xA6,0x95,0xE7,0x2B,0xD3,0x0A,0xF9,0x28,0x19,0x6E,0xED,0xC9,
	0xFA,0xF4,0xA6,0x19,0xF2,0x49,0x2E,0x3F,0xB3,0x11,0x69,0x78,0x9C,0x27,0x6F,0xFB,
	0xB7,0xD4,0x31,0x16,0x64,0x7B,0xA9,0xE0,0xD1,0x06,0xA3,0x54,0x2E,0x39,0x65,0x29,
	0x2C,0xF7,0x78,0x23,0xDD,0x34,0xCA,0x8E,0xEC,0x7D,0xE3,0x67,0xE0,0x80,0x70,0x89,
	0x50,0x77,0xC7,0xEF,0xAD,0x93,0x99,0x24,0xCB,0x18,0x70,0x67,0xDB,0xF9,0x2C,0xB1,
	0xE7,0x85,0x91,0x7B,0xD3,0x8B,0xAC,0xE0,0xC1,0x94,0xCA,0x12,0xDF,0x0C,0xE5,0xB7,
	0xA5,0x02,0x75,0xAC,0x61,0xBE,0x7C,0x3B,0x43,0x68,0x87,0xCA,0x98,0xC9,0xFD,0x39},
	1,{0x03},{0x15,0x12,0x31},
	{0xE7,0xAC,0x9A,0xA8,0xEE,0xD1,0xB5,0xFF,0x1B,0xD5,0x32,0xCF,0x14,0x89,0xA3,0xE5,
	0x55,0x75,0x72,0xC1} 
	}; 

	// VISA 1984 BITS LIVE KEY 09
	EMV_CAPK capk_visa_v99={{0xA0,0x00,0x00,0x00,0x03},0x99, 
		0x01,0x01,128, 
	{0xAB,0x79,0xFC,0xC9,0x52,0x08,0x96,0x96,0x7E,0x77,0x6E,0x64,0x44,0x4E,0x5D,0xCD,
	0xD6,0xE1,0x36,0x11,0x87,0x4F,0x39,0x85,0x72,0x25,0x20,0x42,0x52,0x95,0xEE,0xA4,
	0xBD,0x0C,0x27,0x81,0xDE,0x7F,0x31,0xCD,0x3D,0x04,0x1F,0x56,0x5F,0x74,0x73,0x06,
	0xEE,0xD6,0x29,0x54,0xB1,0x7E,0xDA,0xBA,0x3A,0x6C,0x5B,0x85,0xA1,0xDE,0x1B,0xEB,
	0x9A,0x34,0x14,0x1A,0xF3,0x8F,0xCF,0x82,0x79,0xC9,0xDE,0xA0,0xD5,0xA6,0x71,0x0D,
	0x08,0xDB,0x41,0x24,0xF0,0x41,0x94,0x55,0x87,0xE2,0x03,0x59,0xBA,0xB4,0x7B,0x75,
	0x75,0xAD,0x94,0x26,0x2D,0x4B,0x25,0xF2,0x64,0xAF,0x33,0xDE,0xDC,0xF2,0x8E,0x09,
	0x61,0x5E,0x93,0x7D,0xE3,0x2E,0xDC,0x03,0xC5,0x44,0x45,0xFE,0x7E,0x38,0x27,0x77},
	1,{0x03},{0x15,0x12,0x31},
	{0x4A,0xBF,0xFD,0x6B,0x1C,0x51,0x21,0x2D,0x05,0x55,0x2E,0x43,0x1C,0x5B,0x17,0x00,
	0x7D,0x2F,0x5E,0x6D} 
	};

	struct{
		unsigned char KeyID;
		EMV_CAPK *KeyValue;
	}glAllLiveEmvKey[]={
		//	{0x02,&capk_amex_live02},
		{0x03,&capk_visa_v03},
		{0x0E,&capk_visa_v05},
		{0x0F,&capk_visa_v09},
		{0x92,&capk_visa_v92},
		{0x94,&capk_visa_v94},
		{0x95,&capk_visa_v95},
		{0x96,&capk_visa_v96},
		{0x98,&capk_visa_v98},
		{0x99,&capk_visa_v99}
	};


	iFd = PdkFile_Open(EMV_CAPK_LIST_FILE);
	if ( iFd < 0 ) {
		return iFd;
	}
	PdkFile_Seek(iFd, 0, SEEK_END);

	for(i=0; i < 9; i++)
	{
		iRet = PdkFile_Write(iFd, glAllLiveEmvKey[i].KeyValue, sizeof(EMV_CAPK));
	}
	g_stEmvParamInfo.usCapkNum += 9; 

	PdkFile_Close(iFd);
	return 0;
}

int writeEMVCAPK(int *piBlockIndex, int *piBlockPos)
{
	int iRet=0, i=0, iFd;
	EMVCapkInfo	stEmvCapkInfo;

	EMV_CAPK capk_visa_v01={{0xA0,0x00,0x00,0x00,0x03},0x01,
		0x01,0x01,128,
	{0xC6,0x96,0x03,0x42,0x13,0xD7,0xD8,0x54,0x69,0x84,0x57,0x9D,0x1D,0x0F,0x0E,0xA5,
	0x19,0xCF,0xF8,0xDE,0xFF,0xC4,0x29,0x35,0x4C,0xF3,0xA8,0x71,0xA6,0xF7,0x18,0x3F,
	0x12,0x28,0xDA,0x5C,0x74,0x70,0xC0,0x55,0x38,0x71,0x00,0xCB,0x93,0x5A,0x71,0x2C,
	0x4E,0x28,0x64,0xDF,0x5D,0x64,0xBA,0x93,0xFE,0x7E,0x63,0xE7,0x1F,0x25,0xB1,0xE5,
	0xF5,0x29,0x85,0x75,0xEB,0xE1,0xC6,0x3A,0xA6,0x17,0x70,0x69,0x17,0x91,0x1D,0xC2,
	0xA7,0x5A,0xC2,0x8B,0x25,0x1C,0x7E,0xF4,0x0F,0x23,0x65,0x91,0x24,0x90,0xB9,0x39,
	0xBC,0xA2,0x12,0x4A,0x30,0xA2,0x8F,0x54,0x40,0x2C,0x34,0xAE,0xCA,0x33,0x1A,0xB6,
	0x7E,0x1E,0x79,0xB2,0x85,0xDD,0x57,0x71,0xB5,0xD9,0xFF,0x79,0xEA,0x63,0x0B,0x75},
	1,{0x03},{0x15,0x12,0x31},
	{0xD3,0x4A,0x6A,0x77,0x60,0x11,0xC7,0xE7,0xCE,0x3A,0xEC,0x5F,0x03,0xAD,0x2F,0x8C,
	0xFC,0x55,0x03,0xCC}
	};

	// VISA 1152 bits Live Key 07
	EMV_CAPK capk_visa_v07={{0xA0,0x00,0x00,0x00,0x03},0x07,
		0x01,0x01,144,
	{0xA8,0x9F,0x25,0xA5,0x6F,0xA6,0xDA,0x25,0x8C,0x8C,0xA8,0xB4,0x04,0x27,0xD9,0x27,
	0xB4,0xA1,0xEB,0x4D,0x7E,0xA3,0x26,0xBB,0xB1,0x2F,0x97,0xDE,0xD7,0x0A,0xE5,0xE4,
	0x48,0x0F,0xC9,0xC5,0xE8,0xA9,0x72,0x17,0x71,0x10,0xA1,0xCC,0x31,0x8D,0x06,0xD2,
	0xF8,0xF5,0xC4,0x84,0x4A,0xC5,0xFA,0x79,0xA4,0xDC,0x47,0x0B,0xB1,0x1E,0xD6,0x35,
	0x69,0x9C,0x17,0x08,0x1B,0x90,0xF1,0xB9,0x84,0xF1,0x2E,0x92,0xC1,0xC5,0x29,0x27,
	0x6D,0x8A,0xF8,0xEC,0x7F,0x28,0x49,0x20,0x97,0xD8,0xCD,0x5B,0xEC,0xEA,0x16,0xFE,
	0x40,0x88,0xF6,0xCF,0xAB,0x4A,0x1B,0x42,0x32,0x8A,0x1B,0x99,0x6F,0x92,0x78,0xB0,
	0xB7,0xE3,0x31,0x1C,0xA5,0xEF,0x85,0x6C,0x2F,0x88,0x84,0x74,0xB8,0x36,0x12,0xA8,
	0x2E,0x4E,0x00,0xD0,0xCD,0x40,0x69,0xA6,0x78,0x31,0x40,0x43,0x3D,0x50,0x72,0x5F},
	1,{0x03},{0x15,0x12,0x31},
	{0xB4,0xBC,0x56,0xCC,0x4E,0x88,0x32,0x49,0x32,0xCB,0xC6,0x43,0xD6,0x89,0x8F,0x6F,
	0xE5,0x93,0xB1,0x72}
	};
	//Modified from old 1152 bits key to new one on Feb 6,2004.

	// VISA 1408 BITS LIVE KEY 08
	EMV_CAPK capk_visa_v08={{0xA0,0x00,0x00,0x00,0x03},0x08, 
		0x01,0x01,176, 
	{0xD9,0xFD,0x6E,0xD7,0x5D,0x51,0xD0,0xE3,0x06,0x64,0xBD,0x15,0x70,0x23,0xEA,0xA1, 
	0xFF,0xA8,0x71,0xE4,0xDA,0x65,0x67,0x2B,0x86,0x3D,0x25,0x5E,0x81,0xE1,0x37,0xA5, 
	0x1D,0xE4,0xF7,0x2B,0xCC,0x9E,0x44,0xAC,0xE1,0x21,0x27,0xF8,0x7E,0x26,0x3D,0x3A, 
	0xF9,0xDD,0x9C,0xF3,0x5C,0xA4,0xA7,0xB0,0x1E,0x90,0x70,0x00,0xBA,0x85,0xD2,0x49, 
	0x54,0xC2,0xFC,0xA3,0x07,0x48,0x25,0xDD,0xD4,0xC0,0xC8,0xF1,0x86,0xCB,0x02,0x0F, 
	0x68,0x3E,0x02,0xF2,0xDE,0xAD,0x39,0x69,0x13,0x3F,0x06,0xF7,0x84,0x51,0x66,0xAC, 
	0xEB,0x57,0xCA,0x0F,0xC2,0x60,0x34,0x45,0x46,0x98,0x11,0xD2,0x93,0xBF,0xEF,0xBA, 
	0xFA,0xB5,0x76,0x31,0xB3,0xDD,0x91,0xE7,0x96,0xBF,0x85,0x0A,0x25,0x01,0x2F,0x1A, 
	0xE3,0x8F,0x05,0xAA,0x5C,0x4D,0x6D,0x03,0xB1,0xDC,0x2E,0x56,0x86,0x12,0x78,0x59, 
	0x38,0xBB,0xC9,0xB3,0xCD,0x3A,0x91,0x0C,0x1D,0xA5,0x5A,0x5A,0x92,0x18,0xAC,0xE0, 
	0xF7,0xA2,0x12,0x87,0x75,0x26,0x82,0xF1,0x58,0x32,0xA6,0x78,0xD6,0xE1,0xED,0x0B}, 
	1,{0x03}, {0x15,0x12,0x31},
	{0x20,0xD2,0x13,0x12,0x69,0x55,0xDE,0x20,0x5A,0xDC,0x2F,0xD2,0x82,0x2B,0xD2,0x2D,
	0xE2,0x1C,0xF9,0xA8} 
	}; 
	// expired on December 31, 2016

	// Mastercard 1984 bits transaction time test Key EF
	EMV_CAPK capk_mastercard_tEF={{0xA0,0x00,0x00,0x00,0x04},0xEF,
		0x01,0x01,248,
	{0xA1,0x91,0xCB,0x87,0x47,0x3F,0x29,0x34,0x9B,0x5D,0x60,0xA8,0x8B,0x3E,0xAE,0xE0,
	0x97,0x3A,0xA6,0xF1,0xA0,0x82,0xF3,0x58,0xD8,0x49,0xFD,0xDF,0xF9,0xC0,0x91,0xF8,
	0x99,0xED,0xA9,0x79,0x2C,0xAF,0x09,0xEF,0x28,0xF5,0xD2,0x24,0x04,0xB8,0x8A,0x22,
	0x93,0xEE,0xBB,0xC1,0x94,0x9C,0x43,0xBE,0xA4,0xD6,0x0C,0xFD,0x87,0x9A,0x15,0x39,
	0x54,0x4E,0x09,0xE0,0xF0,0x9F,0x60,0xF0,0x65,0xB2,0xBF,0x2A,0x13,0xEC,0xC7,0x05,
	0xF3,0xD4,0x68,0xB9,0xD3,0x3A,0xE7,0x7A,0xD9,0xD3,0xF1,0x9C,0xA4,0x0F,0x23,0xDC,
	0xF5,0xEB,0x7C,0x04,0xDC,0x8F,0x69,0xEB,0xA5,0x65,0xB1,0xEB,0xCB,0x46,0x86,0xCD,
	0x27,0x47,0x85,0x53,0x0F,0xF6,0xF6,0xE9,0xEE,0x43,0xAA,0x43,0xFD,0xB0,0x2C,0xE0,
	0x0D,0xAE,0xC1,0x5C,0x7B,0x8F,0xD6,0xA9,0xB3,0x94,0xBA,0xBA,0x41,0x9D,0x3F,0x6D,
	0xC8,0x5E,0x16,0x56,0x9B,0xE8,0xE7,0x69,0x89,0x68,0x8E,0xFE,0xA2,0xDF,0x22,0xFF,
	0x7D,0x35,0xC0,0x43,0x33,0x8D,0xEA,0xA9,0x82,0xA0,0x2B,0x86,0x6D,0xE5,0x32,0x85,
	0x19,0xEB,0xBC,0xD6,0xF0,0x3C,0xDD,0x68,0x66,0x73,0x84,0x7F,0x84,0xDB,0x65,0x1A,
	0xB8,0x6C,0x28,0xCF,0x14,0x62,0x56,0x2C,0x57,0x7B,0x85,0x35,0x64,0xA2,0x90,0xC8,
	0x55,0x6D,0x81,0x85,0x31,0x26,0x8D,0x25,0xCC,0x98,0xA4,0xCC,0x6A,0x0B,0xDF,0xFF,
	0xDA,0x2D,0xCC,0xA3,0xA9,0x4C,0x99,0x85,0x59,0xE3,0x07,0xFD,0xDF,0x91,0x50,0x06,
	0xD9,0xA9,0x87,0xB0,0x7D,0xDA,0xEB,0x3B},
	1,{0x03},{0x15,0x12,0x31},
	{0x21,0x76,0x6E,0xBB,0x0E,0xE1,0x22,0xAF,0xB6,0x5D,0x78,0x45,0xB7,0x3D,0xB4,0x6B,
	0xAB,0x65,0x42,0x7A}
	};

	EMV_CAPK capk_mastercard_vfa={{0xA0,0x00,0x00,0x00,0x04},0xfa,
		0x01,0x01,144,
	{0xA9,0x0F,0xCD,0x55,0xAA,0x2D,0x5D,0x99,0x63,0xE3,0x5E,0xD0,0xF4,0x40,0x17,0x76,
	0x99,0x83,0x2F,0x49,0xC6,0xBA,0xB1,0x5C,0xDA,0xE5,0x79,0x4B,0xE9,0x3F,0x93,0x4D,
	0x44,0x62,0xD5,0xD1,0x27,0x62,0xE4,0x8C,0x38,0xBA,0x83,0xD8,0x44,0x5D,0xEA,0xA7,
	0x41,0x95,0xA3,0x01,0xA1,0x02,0xB2,0xF1,0x14,0xEA,0xDA,0x0D,0x18,0x0E,0xE5,0xE7,
	0xA5,0xC7,0x3E,0x0C,0x4E,0x11,0xF6,0x7A,0x43,0xDD,0xAB,0x5D,0x55,0x68,0x3B,0x14,
	0x74,0xCC,0x06,0x27,0xF4,0x4B,0x8D,0x30,0x88,0xA4,0x92,0xFF,0xAA,0xDA,0xD4,0xF4,
	0x24,0x22,0xD0,0xE7,0x01,0x35,0x36,0xC3,0xC4,0x9A,0xD3,0xD0,0xFA,0xE9,0x64,0x59,
	0xB0,0xF6,0xB1,0xB6,0x05,0x65,0x38,0xA3,0xD6,0xD4,0x46,0x40,0xF9,0x44,0x67,0xB1,
	0x08,0x86,0x7D,0xEC,0x40,0xFA,0xAE,0xCD,0x74,0x0C,0x00,0xE2,0xB7,0xA8,0x85,0x2D},
	1,{0x03},{0x15,0x12,0x31},
	{0x5B,0xED,0x40,0x68,0xD9,0x6E,0xA1,0x6D,0x2D,0x77,0xE0,0x3D,0x60,0x36,0xFC,0x7A,
	0x16,0x0E,0xA9,0x9C}
	};
	// Mastercard 1024 bits Live Key 03
	EMV_CAPK capk_mastercard_vfe={{0xA0,0x00,0x00,0x00,0x04},0xfe,
		0x01,0x01,128,
	{0xA6,0x53,0xEA,0xC1,0xC0,0xF7,0x86,0xC8,0x72,0x4F,0x73,0x7F,0x17,0x29,0x97,0xD6,
	0x3D,0x1C,0x32,0x51,0xC4,0x44,0x02,0x04,0x9B,0x86,0x5B,0xAE,0x87,0x7D,0x0F,0x39,
	0x8C,0xBF,0xBE,0x8A,0x60,0x35,0xE2,0x4A,0xFA,0x08,0x6B,0xEF,0xDE,0x93,0x51,0xE5,
	0x4B,0x95,0x70,0x8E,0xE6,0x72,0xF0,0x96,0x8B,0xCD,0x50,0xDC,0xE4,0x0F,0x78,0x33,
	0x22,0xB2,0xAB,0xA0,0x4E,0xF1,0x37,0xEF,0x18,0xAB,0xF0,0x3C,0x7D,0xBC,0x58,0x13,
	0xAE,0xAE,0xF3,0xAA,0x77,0x97,0xBA,0x15,0xDF,0x7D,0x5B,0xA1,0xCB,0xAF,0x7F,0xD5,
	0x20,0xB5,0xA4,0x82,0xD8,0xD3,0xFE,0xE1,0x05,0x07,0x78,0x71,0x11,0x3E,0x23,0xA4,
	0x9A,0xF3,0x92,0x65,0x54,0xA7,0x0F,0xE1,0x0E,0xD7,0x28,0xCF,0x79,0x3B,0x62,0xA1},
	1,{0x03},{0x15,0x12,0x31},
	{0x9A,0x29,0x5B,0x05,0xFB,0x39,0x0E,0xF7,0x92,0x3F,0x57,0x61,0x8A,0x9F,0xDA,0x29,
	0x41,0xFC,0x34,0xE0}
	};

	EMV_CAPK capk_mastercard_vf1={{0xA0,0x00,0x00,0x00,0x04},0xF1,
		0x01,0x01,176,
	{0xA0,0xDC,0xF4,0xBD,0xE1,0x9C,0x35,0x46,0xB4,0xB6,0xF0,0x41,0x4D,0x17,0x4D,0xDE,
	0x29,0x4A,0xAB,0xBB,0x82,0x8C,0x5A,0x83,0x4D,0x73,0xAA,0xE2,0x7C,0x99,0xB0,0xB0,
	0x53,0xA9,0x02,0x78,0x00,0x72,0x39,0xB6,0x45,0x9F,0xF0,0xBB,0xCD,0x7B,0x4B,0x9C,
	0x6C,0x50,0xAC,0x02,0xCE,0x91,0x36,0x8D,0xA1,0xBD,0x21,0xAA,0xEA,0xDB,0xC6,0x53,
	0x47,0x33,0x7D,0x89,0xB6,0x8F,0x5C,0x99,0xA0,0x9D,0x05,0xBE,0x02,0xDD,0x1F,0x8C,
	0x5B,0xA2,0x0E,0x2F,0x13,0xFB,0x2A,0x27,0xC4,0x1D,0x3F,0x85,0xCA,0xD5,0xCF,0x66,
	0x68,0xE7,0x58,0x51,0xEC,0x66,0xED,0xBF,0x98,0x85,0x1F,0xD4,0xE4,0x2C,0x44,0xC1,
	0xD5,0x9F,0x59,0x84,0x70,0x3B,0x27,0xD5,0xB9,0xF2,0x1B,0x8F,0xA0,0xD9,0x32,0x79,
	0xFB,0xBF,0x69,0xE0,0x90,0x64,0x29,0x09,0xC9,0xEA,0x27,0xF8,0x98,0x95,0x95,0x41,
	0xAA,0x67,0x57,0xF5,0xF6,0x24,0x10,0x4F,0x6E,0x1D,0x3A,0x95,0x32,0xF2,0xA6,0xE5,
	0x15,0x15,0xAE,0xAD,0x1B,0x43,0xB3,0xD7,0x83,0x50,0x88,0xA2,0xFA,0xFA,0x7B,0xE7},
	1,{0x03},{0x15,0x12,0x31},
	{0xD8,0xE6,0x8D,0xA1,0x67,0xAB,0x5A,0x85,0xD8,0xC3,0xD5,0x5E,0xCB,0x9B,0x05,0x17,
	0xA1,0xA5,0xB4,0xBB}
	};

	// Mastercard 1152 bits Live Key 04
	EMV_CAPK capk_mastercard_v04={{0xA0,0x00,0x00,0x00,0x04},0x04,
		0x01,0x01,144,
	{0xA6,0xDA,0x42,0x83,0x87,0xA5,0x02,0xD7,0xDD,0xFB,0x7A,0x74,0xD3,0xF4,0x12,0xBE,
	0x76,0x26,0x27,0x19,0x7B,0x25,0x43,0x5B,0x7A,0x81,0x71,0x6A,0x70,0x01,0x57,0xDD,
	0xD0,0x6F,0x7C,0xC9,0x9D,0x6C,0xA2,0x8C,0x24,0x70,0x52,0x7E,0x2C,0x03,0x61,0x6B,
	0x9C,0x59,0x21,0x73,0x57,0xC2,0x67,0x4F,0x58,0x3B,0x3B,0xA5,0xC7,0xDC,0xF2,0x83,
	0x86,0x92,0xD0,0x23,0xE3,0x56,0x24,0x20,0xB4,0x61,0x5C,0x43,0x9C,0xA9,0x7C,0x44,
	0xDC,0x9A,0x24,0x9C,0xFC,0xE7,0xB3,0xBF,0xB2,0x2F,0x68,0x22,0x8C,0x3A,0xF1,0x33,
	0x29,0xAA,0x4A,0x61,0x3C,0xF8,0xDD,0x85,0x35,0x02,0x37,0x3D,0x62,0xE4,0x9A,0xB2,
	0x56,0xD2,0xBC,0x17,0x12,0x0E,0x54,0xAE,0xDC,0xED,0x6D,0x96,0xA4,0x28,0x7A,0xCC,
	0x5C,0x04,0x67,0x7D,0x4A,0x5A,0x32,0x0D,0xB8,0xBE,0xE2,0xF7,0x75,0xE5,0xFE,0xC5},
	1,{0x03},{0x20,0x12,0x30},
	{0x38,0x1A,0x03,0x5D,0xA5,0x8B,0x48,0x2E,0xE2,0xAF,0x75,0xF4,0xC3,0xF2,0xCA,0x46,
	0x9B,0xA4,0xAA,0x6C}
	};
	// Mastercard 1408 bits live Key 05
	EMV_CAPK capk_mastercard_v05 = {{0xA0,0x00,0x00,0x00,0x04},0x05,
		0x01,0x01,176,
	{0xB8,0x04,0x8A,0xBC,0x30,0xC9,0x0D,0x97,0x63,0x36,0x54,0x3E,0x3F,0xD7,0x09,0x1C,
	0x8F,0xE4,0x80,0x0D,0xF8,0x20,0xED,0x55,0xE7,0xE9,0x48,0x13,0xED,0x00,0x55,0x5B,
	0x57,0x3F,0xEC,0xA3,0xD8,0x4A,0xF6,0x13,0x1A,0x65,0x1D,0x66,0xCF,0xF4,0x28,0x4F,
	0xB1,0x3B,0x63,0x5E,0xDD,0x0E,0xE4,0x01,0x76,0xD8,0xBF,0x04,0xB7,0xFD,0x1C,0x7B,
	0xAC,0xF9,0xAC,0x73,0x27,0xDF,0xAA,0x8A,0xA7,0x2D,0x10,0xDB,0x3B,0x8E,0x70,0xB2,
	0xDD,0xD8,0x11,0xCB,0x41,0x96,0x52,0x5E,0xA3,0x86,0xAC,0xC3,0x3C,0x0D,0x9D,0x45,
	0x75,0x91,0x64,0x69,0xC4,0xE4,0xF5,0x3E,0x8E,0x1C,0x91,0x2C,0xC6,0x18,0xCB,0x22,
	0xDD,0xE7,0xC3,0x56,0x8E,0x90,0x02,0x2E,0x6B,0xBA,0x77,0x02,0x02,0xE4,0x52,0x2A,
	0x2D,0xD6,0x23,0xD1,0x80,0xE2,0x15,0xBD,0x1D,0x15,0x07,0xFE,0x3D,0xC9,0x0C,0xA3,
	0x10,0xD2,0x7B,0x3E,0xFC,0xCD,0x8F,0x83,0xDE,0x30,0x52,0xCA,0xD1,0xE4,0x89,0x38,
	0xC6,0x8D,0x09,0x5A,0xAC,0x91,0xB5,0xF3,0x7E,0x28,0xBB,0x49,0xEC,0x7E,0xD5,0x97},
	1,{0x03},{0x14,0x12,0x31},
	{0xEB,0xFA,0x0D,0x5D,0x06,0xD8,0xCE,0x70,0x2D,0xA3,0xEA,0xE8,0x90,0x70,0x1D,0x45,
	0xE2,0x74,0xC8,0x45}
	};

	// Mastercard 1948 bits live Key 06
	EMV_CAPK capk_mastercard_v06 = {{0xA0,0x00,0x00,0x00,0x04},0x06,
		0x01,0x01,248,
	{0xCB,0x26,0xFC,0x83,0x0B,0x43,0x78,0x5B,0x2B,0xCE,0x37,0xC8,0x1E,0xD3,0x34,0x62,
	0x2F,0x96,0x22,0xF4,0xC8,0x9A,0xAE,0x64,0x10,0x46,0xB2,0x35,0x34,0x33,0x88,0x3F,
	0x30,0x7F,0xB7,0xC9,0x74,0x16,0x2D,0xA7,0x2F,0x7A,0x4E,0xC7,0x5D,0x9D,0x65,0x73,
	0x36,0x86,0x5B,0x8D,0x30,0x23,0xD3,0xD6,0x45,0x66,0x76,0x25,0xC9,0xA0,0x7A,0x6B,
	0x7A,0x13,0x7C,0xF0,0xC6,0x41,0x98,0xAE,0x38,0xFC,0x23,0x80,0x06,0xFB,0x26,0x03,
	0xF4,0x1F,0x4F,0x3B,0xB9,0xDA,0x13,0x47,0x27,0x0F,0x2F,0x5D,0x8C,0x60,0x6E,0x42,
	0x09,0x58,0xC5,0xF7,0xD5,0x0A,0x71,0xDE,0x30,0x14,0x2F,0x70,0xDE,0x46,0x88,0x89,
	0xB5,0xE3,0xA0,0x86,0x95,0xB9,0x38,0xA5,0x0F,0xC9,0x80,0x39,0x3A,0x9C,0xBC,0xE4,
	0x4A,0xD2,0xD6,0x4F,0x63,0x0B,0xB3,0x3A,0xD3,0xF5,0xF5,0xFD,0x49,0x5D,0x31,0xF3,
	0x78,0x18,0xC1,0xD9,0x40,0x71,0x34,0x2E,0x07,0xF1,0xBE,0xC2,0x19,0x4F,0x60,0x35,
	0xBA,0x5D,0xED,0x39,0x36,0x50,0x0E,0xB8,0x2D,0xFD,0xA6,0xE8,0xAF,0xB6,0x55,0xB1,
	0xEF,0x3D,0x0D,0x7E,0xBF,0x86,0xB6,0x6D,0xD9,0xF2,0x9F,0x6B,0x1D,0x32,0x4F,0xE8,
	0xB2,0x6C,0xE3,0x8A,0xB2,0x01,0x3D,0xD1,0x3F,0x61,0x1E,0x7A,0x59,0x4D,0x67,0x5C,
	0x44,0x32,0x35,0x0E,0xA2,0x44,0xCC,0x34,0xF3,0x87,0x3C,0xBA,0x06,0x59,0x29,0x87,
	0xA1,0xD7,0xE8,0x52,0xAD,0xC2,0x2E,0xF5,0xA2,0xEE,0x28,0x13,0x20,0x31,0xE4,0x8F,
	0x74,0x03,0x7E,0x3B,0x34,0xAB,0x74,0x7F},
	1,{0x03},{0x20,0x12,0x30},
	{0xF9,0x10,0xA1,0x50,0x4D,0x5F,0xFB,0x79,0x3D,0x94,0xF3,0xB5,0x00,0x76,0x5E,0x1A,
	0xBC,0xAD,0x72,0xD9}
	};

	EMV_CAPK capk_amex_live03={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x03,
		0x01, 0x01, 0x80,
	{0xB0, 0xC2, 0xC6, 0xE2, 0xA6, 0x38, 0x69, 0x33, 0xCD, 0x17, 0xC2, 0x39, 0x49, 0x6B, 0xF4, 0x8C,
	0x57, 0xE3, 0x89, 0x16, 0x4F, 0x2A, 0x96, 0xBF, 0xF1, 0x33, 0x43, 0x9A, 0xE8, 0xA7, 0x7B, 0x20,
	0x49, 0x8B, 0xD4, 0xDC, 0x69, 0x59, 0xAB, 0x0C, 0x2D, 0x05, 0xD0, 0x72, 0x3A, 0xF3, 0x66, 0x89,
	0x01, 0x93, 0x7B, 0x67, 0x4E, 0x5A, 0x2F, 0xA9, 0x2D, 0xDD, 0x5E, 0x78, 0xEA, 0x9D, 0x75, 0xD7,
	0x96, 0x20, 0x17, 0x3C, 0xC2, 0x69, 0xB3, 0x5F, 0x46, 0x3B, 0x3D, 0x4A, 0xAF, 0xF2, 0x79, 0x4F,
	0x92, 0xE6, 0xC7, 0xA3, 0xFB, 0x95, 0x32, 0x5D, 0x8A, 0xB9, 0x59, 0x60, 0xC3, 0x06, 0x6B, 0xE5,
	0x48, 0x08, 0x7B, 0xCB, 0x6C, 0xE1, 0x26, 0x88, 0x14, 0x4A, 0x8B, 0x4A, 0x66, 0x22, 0x8A, 0xE4,
	0x65, 0x9C, 0x63, 0x4C, 0x99, 0xE3, 0x60, 0x11, 0x58, 0x4C, 0x09, 0x50, 0x82, 0xA3, 0xA3, 0xE3},
	1,{0x03},{0x15, 0x12, 0x31},
	{0x87, 0x08, 0xA3, 0xE3, 0xBB, 0xC1, 0xBB, 0x0B, 0xE7, 0x3E, 0xBD, 0x8D, 0x19, 0xD4, 0xE5, 0xD2,
	0x01, 0x66, 0xBF, 0x6C}
	};

	EMV_CAPK capk_amex_live0E={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x0E,
		0x01, 0x01,144,
	{0xAA, 0x94, 0xA8, 0xC6, 0xDA, 0xD2, 0x4F, 0x9B, 0xA5, 0x6A, 0x27, 0xC0, 0x9B, 0x01, 0x02, 0x08,
	0x19, 0x56, 0x8B, 0x81, 0xA0, 0x26, 0xBE, 0x9F, 0xD0, 0xA3, 0x41, 0x6C, 0xA9, 0xA7, 0x11, 0x66,
	0xED, 0x50, 0x84, 0xED, 0x91, 0xCE, 0xD4, 0x7D, 0xD4, 0x57, 0xDB, 0x7E, 0x6C, 0xBC, 0xD5, 0x3E,
	0x56, 0x0B, 0xC5, 0xDF, 0x48, 0xAB, 0xC3, 0x80, 0x99, 0x3B, 0x6D, 0x54, 0x9F, 0x51, 0x96, 0xCF,
	0xA7, 0x7D, 0xFB, 0x20, 0xA0, 0x29, 0x61, 0x88, 0xE9, 0x69, 0xA2, 0x77, 0x2E, 0x8C, 0x41, 0x41,
	0x66, 0x5F, 0x8B, 0xB2, 0x51, 0x6B, 0xA2, 0xC7, 0xB5, 0xFC, 0x91, 0xF8, 0xDA, 0x04, 0xE8, 0xD5,
	0x12, 0xEB, 0x0F, 0x64, 0x11, 0x51, 0x6F, 0xB8, 0x6F, 0xC0, 0x21, 0xCE, 0x7E, 0x96, 0x9D, 0xA9,
	0x4D, 0x33, 0x93, 0x79, 0x09, 0xA5, 0x3A, 0x57, 0xF9, 0x07, 0xC4, 0x0C, 0x22, 0x00, 0x9D, 0xA7,
	0x53, 0x2C, 0xB3, 0xBE, 0x50, 0x9A, 0xE1, 0x73, 0xB3, 0x9A, 0xD6, 0xA0, 0x1B, 0xA5, 0xBB, 0x85},
	1,{0x03},{0x15, 0x12, 0x31},
	{0xA7, 0x26, 0x6A, 0xBA, 0xE6, 0x4B, 0x42, 0xA3, 0x66, 0x88, 0x51, 0x19, 0x1D, 0x49, 0x85, 0x6E,
	0x17, 0xF8, 0xFB, 0xCD}
	};

	EMV_CAPK capk_amex_live0F={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x0F,
		0x01, 0x01,176,
	{0xC8, 0xD5, 0xAC, 0x27, 0xA5, 0xE1, 0xFB, 0x89, 0x97, 0x8C, 0x7C, 0x64, 0x79, 0xAF, 0x99, 0x3A,
	0xB3, 0x80, 0x0E, 0xB2, 0x43, 0x99, 0x6F, 0xBB, 0x2A, 0xE2, 0x6B, 0x67, 0xB2, 0x3A, 0xC4, 0x82,
	0xC4, 0xB7, 0x46, 0x00, 0x5A, 0x51, 0xAF, 0xA7, 0xD2, 0xD8, 0x3E, 0x89, 0x4F, 0x59, 0x1A, 0x23,
	0x57, 0xB3, 0x0F, 0x85, 0xB8, 0x56, 0x27, 0xFF, 0x15, 0xDA, 0x12, 0x29, 0x0F, 0x70, 0xF0, 0x57,
	0x66, 0x55, 0x2B, 0xA1, 0x1A, 0xD3, 0x4B, 0x71, 0x09, 0xFA, 0x49, 0xDE, 0x29, 0xDC, 0xB0, 0x10,
	0x96, 0x70, 0x87, 0x5A, 0x17, 0xEA, 0x95, 0x54, 0x9E, 0x92, 0x34, 0x7B, 0x94, 0x8A, 0xA1, 0xF0,
	0x45, 0x75, 0x6D, 0xE5, 0x6B, 0x70, 0x7E, 0x38, 0x63, 0xE5, 0x9A, 0x6C, 0xBE, 0x99, 0xC1, 0x27,
	0x2E, 0xF6, 0x5F, 0xB6, 0x6C, 0xBB, 0x4C, 0xFF, 0x07, 0x0F, 0x36, 0x02, 0x9D, 0xD7, 0x62, 0x18,
	0xB2, 0x12, 0x42, 0x64, 0x5B, 0x51, 0xCA, 0x75, 0x2A, 0xF3, 0x7E, 0x70, 0xBE, 0x1A, 0x84, 0xFF,
	0x31, 0x07, 0x9D, 0xC0, 0x04, 0x8E, 0x92, 0x88, 0x83, 0xEC, 0x4F, 0xAD, 0xD4, 0x97, 0xA7, 0x19,
	0x38, 0x5C, 0x2B, 0xBB, 0xEB, 0xC5, 0xA6, 0x6A, 0xA5, 0xE5, 0x65, 0x5D, 0x18, 0x03, 0x4E, 0xC5},
	1,{0x03},{0x14, 0x12, 0x31},
	{0xA7, 0x34, 0x72, 0xB3, 0xAB, 0x55, 0x74, 0x93, 0xA9, 0xBC, 0x21, 0x79, 0xCC, 0x80, 0x14, 0x05,
	0x3B, 0x12, 0xBA, 0xB4}
	};

	//AMEX 1984 bits Live Key 10
	EMV_CAPK capk_amex_live10={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x10,
		0x01, 0x01,248,
	{0xCF, 0x98, 0xDF, 0xED, 0xB3, 0xD3, 0x72, 0x79, 0x65, 0xEE, 0x77, 0x97, 0x72, 0x33, 0x55, 0xE0,
	0x75, 0x1C, 0x81, 0xD2, 0xD3, 0xDF, 0x4D, 0x18, 0xEB, 0xAB, 0x9F, 0xB9, 0xD4, 0x9F, 0x38, 0xC8,
	0xC4, 0xA8, 0x26, 0xB9, 0x9D, 0xC9, 0xDE, 0xA3, 0xF0, 0x10, 0x43, 0xD4, 0xBF, 0x22, 0xAC, 0x35,
	0x50, 0xE2, 0x96, 0x2A, 0x59, 0x63, 0x9B, 0x13, 0x32, 0x15, 0x64, 0x22, 0xF7, 0x88, 0xB9, 0xC1,
	0x6D, 0x40, 0x13, 0x5E, 0xFD, 0x1B, 0xA9, 0x41, 0x47, 0x75, 0x05, 0x75, 0xE6, 0x36, 0xB6, 0xEB,
	0xC6, 0x18, 0x73, 0x4C, 0x91, 0xC1, 0xD1, 0xBF, 0x3E, 0xDC, 0x2A, 0x46, 0xA4, 0x39, 0x01, 0x66,
	0x8E, 0x0F, 0xFC, 0x13, 0x67, 0x74, 0x08, 0x0E, 0x88, 0x80, 0x44, 0xF6, 0xA1, 0xE6, 0x5D, 0xC9,
	0xAA, 0xA8, 0x92, 0x8D, 0xAC, 0xBE, 0xB0, 0xDB, 0x55, 0xEA, 0x35, 0x14, 0x68, 0x6C, 0x6A, 0x73,
	0x2C, 0xEF, 0x55, 0xEE, 0x27, 0xCF, 0x87, 0x7F, 0x11, 0x06, 0x52, 0x69, 0x4A, 0x0E, 0x34, 0x84,
	0xC8, 0x55, 0xD8, 0x82, 0xAE, 0x19, 0x16, 0x74, 0xE2, 0x5C, 0x29, 0x62, 0x05, 0xBB, 0xB5, 0x99,
	0x45, 0x51, 0x76, 0xFD, 0xD7, 0xBB, 0xC5, 0x49, 0xF2, 0x7B, 0xA5, 0xFE, 0x35, 0x33, 0x6F, 0x7E,
	0x29, 0xE6, 0x8D, 0x78, 0x39, 0x73, 0x19, 0x94, 0x36, 0x63, 0x3C, 0x67, 0xEE, 0x5A, 0x68, 0x0F,
	0x05, 0x16, 0x0E, 0xD1, 0x2D, 0x16, 0x65, 0xEC, 0x83, 0xD1, 0x99, 0x7F, 0x10, 0xFD, 0x05, 0xBB,
	0xDB, 0xF9, 0x43, 0x3E, 0x8F, 0x79, 0x7A, 0xEE, 0x3E, 0x9F, 0x02, 0xA3, 0x42, 0x28, 0xAC, 0xE9,
	0x27, 0xAB, 0xE6, 0x2B, 0x8B, 0x92, 0x81, 0xAD, 0x08, 0xD3, 0xDF, 0x5C, 0x73, 0x79, 0x68, 0x50,
	0x45, 0xD7, 0xBA, 0x5F, 0xCD, 0xE5, 0x86, 0x37},
	1,{0x03},{0x16, 0x12, 0x31},
	{0xC7, 0x29, 0xCF, 0x2F, 0xD2, 0x62, 0x39, 0x4A, 0xBC, 0x4C, 0xC1, 0x73, 0x50, 0x65, 0x02, 0x44,
	0x6A, 0xA9, 0xB9, 0xFD}
	};

	//discover test 5B
	EMV_CAPK capk_discover_test5B={{0xA0, 0x00, 0x00, 0x01, 0x52}, 0x5B,
		0x01, 0x01,144,
	{0xD3, 0xF4, 0x5D, 0x06, 0x5D, 0x4D, 0x90, 0x0F, 0x68, 0xB2, 0x12, 0x9A, 0xFA, 0x38, 0xF5, 0x49,
	0xAB, 0x9A, 0xE4, 0x61, 0x9E, 0x55, 0x45, 0x81, 0x4E, 0x46, 0x8F, 0x38, 0x20, 0x49, 0xA0, 0xB9,
	0x77, 0x66, 0x20, 0xDA, 0x60, 0xD6, 0x25, 0x37, 0xF0, 0x70, 0x5A, 0x2C, 0x92, 0x6D, 0xBE, 0xAD,
	0x4C, 0xA7, 0xCB, 0x43, 0xF0, 0xF0, 0xDD, 0x80, 0x95, 0x84, 0xE9, 0xF7, 0xEF, 0xBD, 0xA3, 0x77,
	0x87, 0x47, 0xBC, 0x9E, 0x25, 0xC5, 0x60, 0x65, 0x26, 0xFA, 0xB5, 0xE4, 0x91, 0x64, 0x6D, 0x4D,
	0xD2, 0x82, 0x78, 0x69, 0x1C, 0x25, 0x95, 0x6C, 0x8F, 0xED, 0x5E, 0x45, 0x2F, 0x24, 0x42, 0xE2,
	0x5E, 0xDC, 0x6B, 0x0C, 0x1A, 0xA4, 0xB2, 0xE9, 0xEC, 0x4A, 0xD9, 0xB2, 0x5A, 0x1B, 0x83, 0x62,
	0x95, 0xB8, 0x23, 0xED, 0xDC, 0x5E, 0xB6, 0xE1, 0xE0, 0xA3, 0xF4, 0x1B, 0x28, 0xDB, 0x8C, 0x3B,
	0x7E, 0x3E, 0x9B, 0x59, 0x79, 0xCD, 0x7E, 0x07, 0x9E, 0xF0, 0x24, 0x09, 0x5A, 0x1D, 0x19, 0xDD
	},
	1,{0x03},{0x16, 0x12, 0x31},
	{0x4D, 0xC5, 0xC6, 0xCA, 0xB6, 0xAE, 0x96, 0x97, 0x4D, 0x9D, 0xC8, 0xB2, 0x43, 0x5E, 0x21, 0xF5,
	0x26, 0xBC, 0x7A, 0x60}
	};

	struct{
		unsigned char KeyID;
		EMV_CAPK *KeyValue;
	}glAllLiveEmvKey[]={
		{0x03, &capk_amex_live03},
		{0x0E, &capk_amex_live0E},
		{0x0F, &capk_amex_live0F},
		{0x10, &capk_amex_live10},
		{0x5B, &capk_discover_test5B},
		{0x01, &capk_visa_v01},
		{0x07, &capk_visa_v07},
		{0x08, &capk_visa_v08},
		{0xef, &capk_mastercard_tEF},
		{0xf1, &capk_mastercard_vf1},
		{0xfa, &capk_mastercard_vfa},
		{0xfe, &capk_mastercard_vfe},
		{0x04, &capk_mastercard_v04},
		{0x05, &capk_mastercard_v05},
		{0x06, &capk_mastercard_v06},
	};

	iFd = PdkFile_Open(EMV_CAPK_LIST_FILE);
	if ( iFd < 0 ) {
		return iFd;
	}
	PdkFile_Seek(iFd, 0, SEEK_END);

	for(i=0; i < 15; i++)
	{
		iRet = PdkFile_Write(iFd, glAllLiveEmvKey[i].KeyValue, sizeof(EMV_CAPK));
	}
	g_stEmvParamInfo.usCapkNum += 15; 

	PdkFile_Close(iFd);
	return 0;
}

int WriteTestCAPK(int *piBlockIndex, int *piBlockPos)
{
	int iRet=0, i=0, iFd=0;
	EMVCapkInfo	stEmvCapkInfo;

	/************************************************
	Belows are EMV test data
	************************************************/
	EMV_CAPK capk_visa_v01={{0xA0,0x00,0x00,0x00,0x03},0x01,
		0x01,0x01,128,
		{0xC6, 0x96, 0x03, 0x42, 0x13, 0xD7, 0xD8, 0x54, 0x69, 0x84, 0x57, 0x9D, 0x1D, 0x0F, 0x0E, 0xA5, 
			0x19, 0xCF, 0xF8, 0xDE, 0xFF, 0xC4, 0x29, 0x35, 0x4C, 0xF3, 0xA8, 0x71, 0xA6, 0xF7, 0x18, 0x3F, 
			0x12, 0x28, 0xDA, 0x5C, 0x74, 0x70, 0xC0, 0x55, 0x38, 0x71, 0x00, 0xCB, 0x93, 0x5A, 0x71, 0x2C, 
			0x4E, 0x28, 0x64, 0xDF, 0x5D, 0x64, 0xBA, 0x93, 0xFE, 0x7E, 0x63, 0xE7, 0x1F, 0x25, 0xB1, 0xE5, 
			0xF5, 0x29, 0x85, 0x75, 0xEB, 0xE1, 0xC6, 0x3A, 0xA6, 0x17, 0x70, 0x69, 0x17, 0x91, 0x1D, 0xC2, 
			0xA7, 0x5A, 0xC2, 0x8B, 0x25, 0x1C, 0x7E, 0xF4, 0x0F, 0x23, 0x65, 0x91, 0x24, 0x90, 0xB9, 0x39, 
			0xBC, 0xA2, 0x12, 0x4A, 0x30, 0xA2, 0x8F, 0x54, 0x40, 0x2C, 0x34, 0xAE, 0xCA, 0x33, 0x1A, 0xB6, 
			0x7E, 0x1E, 0x79, 0xB2, 0x85, 0xDD, 0x57, 0x71, 0xB5, 0xD9, 0xFF, 0x79, 0xEA, 0x63, 0x0B, 0x75
		},
		1,{0x03},{0x09,0x12,0x31},
		{0xD3, 0x4A, 0x6A, 0x77, 0x60, 0x11, 0xC7, 0xE7, 0xCE, 0x3A, 0xEC, 0x5F, 0x03, 0xAD, 0x2F, 0x8C, 
			0xFC, 0x55, 0x03, 0xCC}
	};

	EMV_CAPK capk_visa_v07={{0xA0,0x00,0x00,0x00,0x03},0x07,
		0x01,0x01,144,
		{0xA8, 0x9F, 0x25, 0xA5, 0x6F, 0xA6, 0xDA, 0x25, 0x8C, 0x8C, 0xA8, 0xB4, 0x04, 0x27, 0xD9, 0x27, 
			0xB4, 0xA1, 0xEB, 0x4D, 0x7E, 0xA3, 0x26, 0xBB, 0xB1, 0x2F, 0x97, 0xDE, 0xD7, 0x0A, 0xE5, 0xE4, 
			0x48, 0x0F, 0xC9, 0xC5, 0xE8, 0xA9, 0x72, 0x17, 0x71, 0x10, 0xA1, 0xCC, 0x31, 0x8D, 0x06, 0xD2, 
			0xF8, 0xF5, 0xC4, 0x84, 0x4A, 0xC5, 0xFA, 0x79, 0xA4, 0xDC, 0x47, 0x0B, 0xB1, 0x1E, 0xD6, 0x35, 
			0x69, 0x9C, 0x17, 0x08, 0x1B, 0x90, 0xF1, 0xB9, 0x84, 0xF1, 0x2E, 0x92, 0xC1, 0xC5, 0x29, 0x27, 
			0x6D, 0x8A, 0xF8, 0xEC, 0x7F, 0x28, 0x49, 0x20, 0x97, 0xD8, 0xCD, 0x5B, 0xEC, 0xEA, 0x16, 0xFE, 
			0x40, 0x88, 0xF6, 0xCF, 0xAB, 0x4A, 0x1B, 0x42, 0x32, 0x8A, 0x1B, 0x99, 0x6F, 0x92, 0x78, 0xB0, 
			0xB7, 0xE3, 0x31, 0x1C, 0xA5, 0xEF, 0x85, 0x6C, 0x2F, 0x88, 0x84, 0x74, 0xB8, 0x36, 0x12, 0xA8, 
			0x2E, 0x4E, 0x00, 0xD0, 0xCD, 0x40, 0x69, 0xA6, 0x78, 0x31, 0x40, 0x43, 0x3D, 0x50, 0x72, 0x5F
		},
		1,{0x03},{0x12,0x12,0x31},
		{0xB4, 0xBC, 0x56, 0xCC, 0x4E, 0x88, 0x32, 0x49, 0x32, 0xCB, 0xC6, 0x43, 0xD6, 0x89, 0x8F, 0x6F, 
			0xE5, 0x93, 0xB1, 0x72}
	};

	EMV_CAPK capk_visa_v08={{0xA0,0x00,0x00,0x00,0x03},0x08,
		0x01,0x01,176,
		{0xD9, 0xFD, 0x6E, 0xD7, 0x5D, 0x51, 0xD0, 0xE3, 0x06, 0x64, 0xBD, 0x15, 0x70, 0x23, 0xEA, 0xA1, 
			0xFF, 0xA8, 0x71, 0xE4, 0xDA, 0x65, 0x67, 0x2B, 0x86, 0x3D, 0x25, 0x5E, 0x81, 0xE1, 0x37, 0xA5, 
			0x1D, 0xE4, 0xF7, 0x2B, 0xCC, 0x9E, 0x44, 0xAC, 0xE1, 0x21, 0x27, 0xF8, 0x7E, 0x26, 0x3D, 0x3A, 
			0xF9, 0xDD, 0x9C, 0xF3, 0x5C, 0xA4, 0xA7, 0xB0, 0x1E, 0x90, 0x70, 0x00, 0xBA, 0x85, 0xD2, 0x49, 
			0x54, 0xC2, 0xFC, 0xA3, 0x07, 0x48, 0x25, 0xDD, 0xD4, 0xC0, 0xC8, 0xF1, 0x86, 0xCB, 0x02, 0x0F, 
			0x68, 0x3E, 0x02, 0xF2, 0xDE, 0xAD, 0x39, 0x69, 0x13, 0x3F, 0x06, 0xF7, 0x84, 0x51, 0x66, 0xAC, 
			0xEB, 0x57, 0xCA, 0x0F, 0xC2, 0x60, 0x34, 0x45, 0x46, 0x98, 0x11, 0xD2, 0x93, 0xBF, 0xEF, 0xBA, 
			0xFA, 0xB5, 0x76, 0x31, 0xB3, 0xDD, 0x91, 0xE7, 0x96, 0xBF, 0x85, 0x0A, 0x25, 0x01, 0x2F, 0x1A, 
			0xE3, 0x8F, 0x05, 0xAA, 0x5C, 0x4D, 0x6D, 0x03, 0xB1, 0xDC, 0x2E, 0x56, 0x86, 0x12, 0x78, 0x59, 
			0x38, 0xBB, 0xC9, 0xB3, 0xCD, 0x3A, 0x91, 0x0C, 0x1D, 0xA5, 0x5A, 0x5A, 0x92, 0x18, 0xAC, 0xE0, 
			0xF7, 0xA2, 0x12, 0x87, 0x75, 0x26, 0x82, 0xF1, 0x58, 0x32, 0xA6, 0x78, 0xD6, 0xE1, 0xED, 0x0B
		},
		1,{0x03},{0x14,0x12,0x31},
		{0x20, 0xD2, 0x13, 0x12, 0x69, 0x55, 0xDE, 0x20, 0x5A, 0xDC, 0x2F, 0xD2, 0x82, 0x2B, 0xD2, 0x2D, 
			0xE2, 0x1C, 0xF9, 0xA8}
	};

	EMV_CAPK capk_visa_v57={{0xA0,0x00,0x00,0x00,0x03},0x57,
		0x01,0x01,96,
		{0x94, 0x2B, 0x7F, 0x2B, 0xA5, 0xEA, 0x30, 0x73, 0x12, 0xB6, 0x3D, 0xF7, 0x7C, 0x52, 0x43, 0x61, 
			0x8A, 0xCC, 0x20, 0x02, 0xBD, 0x7E, 0xCB, 0x74, 0xD8, 0x21, 0xFE, 0x7B, 0xDC, 0x78, 0xBF, 0x28, 
			0xF4, 0x9F, 0x74, 0x19, 0x0A, 0xD9, 0xB2, 0x3B, 0x97, 0x13, 0xB1, 0x40, 0xFF, 0xEC, 0x1F, 0xB4, 
			0x29, 0xD9, 0x3F, 0x56, 0xBD, 0xC7, 0xAD, 0xE4, 0xAC, 0x07, 0x5D, 0x75, 0x53, 0x2C, 0x1E, 0x59, 
			0x0B, 0x21, 0x87, 0x4C, 0x79, 0x52, 0xF2, 0x9B, 0x8C, 0x0F, 0x0C, 0x1C, 0xE3, 0xAE, 0xED, 0xC8, 
			0xDA, 0x25, 0x34, 0x31, 0x23, 0xE7, 0x1D, 0xCF, 0x86, 0xC6, 0x99, 0x8E, 0x15, 0xF7, 0x56, 0xE3
		},
		3,{0x01, 0x00, 0x01},{0x15,0x12,0x31},
		{0x25, 0x1A, 0x5F, 0x5D, 0xE6, 0x1C, 0xF2, 0x8B, 0x5C, 0x6E, 0x2B, 0x58, 0x07, 0xC0, 0x64, 0x4A, 
			0x01, 0xD4, 0x6F, 0xF5}
	};

	EMV_CAPK capk_visa_v90={{0xA0,0x00,0x00,0x00,0x03},0x90,
		0x01,0x01,64,
		{0xC2, 0x6B, 0x3C, 0xB3, 0x83, 0x3E, 0x42, 0xD8, 0x27, 0x0D, 0xC1, 0x0C, 0x89, 0x99, 0xB2, 0xDA, 
			0x18, 0x10, 0x68, 0x38, 0x65, 0x0D, 0xA0, 0xDB, 0xF1, 0x54, 0xEF, 0xD5, 0x11, 0x00, 0xAD, 0x14, 
			0x47, 0x41, 0xB2, 0xA8, 0x7D, 0x68, 0x81, 0xF8, 0x63, 0x0E, 0x33, 0x48, 0xDE, 0xA3, 0xF7, 0x80, 
			0x38, 0xE9, 0xB2, 0x1A, 0x69, 0x7E, 0xB2, 0xA6, 0x71, 0x6D, 0x32, 0xCB, 0xF2, 0x60, 0x86, 0xF1
		},
		1,{0x03},{0x15,0x12,0x31},
		{0xB3, 0xAE, 0x2B, 0xC3, 0xCA, 0xFC, 0x05, 0xEE, 0xEF, 0xAA, 0x46, 0xA2, 0xA4, 0x7E, 0xD5, 0x1D, 
			0xE6, 0x79, 0xF8, 0x23}
	};
	// ========= Add end ======================================//

	EMV_CAPK capk_visa_v03={{0xA0,0x00,0x00,0x00,0x03},0x03,
	0x01,0x01,112,
	{0xB3,0xE5,0xE6,0x67,0x50,0x6C,0x47,0xCA,0xAF,0xB1,0x2A,0x26,0x33,0x81,0x93,0x50,
	0x84,0x66,0x97,0xDD,0x65,0xA7,0x96,0xE5,0xCE,0x77,0xC5,0x7C,0x62,0x6A,0x66,0xF7,
	0x0B,0xB6,0x30,0x91,0x16,0x12,0xAD,0x28,0x32,0x90,0x9B,0x80,0x62,0x29,0x1B,0xEC,
	0xA4,0x6C,0xD3,0x3B,0x66,0xA6,0xF9,0xC9,0xD4,0x8C,0xED,0x8B,0x4F,0xC8,0x56,0x1C,
	0x8A,0x1D,0x8F,0xB1,0x58,0x62,0xC9,0xEB,0x60,0x17,0x8D,0xEA,0x2B,0xE1,0xF8,0x22,
	0x36,0xFF,0xCF,0xF4,0xF3,0x84,0x3C,0x27,0x21,0x79,0xDC,0xDD,0x38,0x4D,0x54,0x10,
	0x53,0xDA,0x6A,0x6A,0x0D,0x3C,0xE4,0x8F,0xDC,0x2D,0xC4,0xE3,0xE0,0xEE,0xE1,0x5F},
	1,{0x03},{0x15,0x12,0x31},
	{0xFE,0x70,0xAB,0x3B,0x4D,0x5A,0x1B,0x99,0x24,0x22,0x8A,0xDF,0x80,0x27,0xC7,0x58,
	0x48,0x3A,0x8B,0x7E}
	};

	EMV_CAPK capk_visa_v05={{0xA0,0x00,0x00,0x00,0x03},0x05,
	0x01,0x01,96,
	{0xD0,0x13,0x5C,0xE8,0xA4,0x43,0x6C,0x7F,0x9D,0x5C,0xC6,0x65,0x47,0xE3,0x0E,0xA4,
	0x02,0xF9,0x81,0x05,0xB7,0x17,0x22,0xE2,0x4B,0xC0,0x8D,0xCC,0x80,0xAB,0x7E,0x71,
	0xEC,0x23,0xB8,0xCE,0x6A,0x1D,0xC6,0xAC,0x2A,0x8C,0xF5,0x55,0x43,0xD7,0x4A,0x8A,
	0xE7,0xB3,0x88,0xF9,0xB1,0x74,0xB7,0xF0,0xD7,0x56,0xC2,0x2C,0xBB,0x59,0x74,0xF9,
	0x01,0x6A,0x56,0xB6,0x01,0xCC,0xA6,0x4C,0x71,0xF0,0x4B,0x78,0xE8,0x6C,0x50,0x1B,
	0x19,0x3A,0x55,0x56,0xD5,0x38,0x9E,0xCE,0x4D,0xEA,0x25,0x8A,0xB9,0x7F,0x52,0xA3},
	1,{0x03},{0x15,0x12,0x31},
	{0x86,0xDF,0x04,0x1E,0x79,0x95,0x02,0x35,0x52,0xA7,0x9E,0x26,0x23,0xE4,0x91,0x80,
	0xC0,0xCD,0x95,0x7A}
	};

	EMV_CAPK capk_visa_v09={{0xA0,0x00,0x00,0x00,0x03},0x09,
	0x01,0x01,248,
	{0x9D,0x91,0x22,0x48,0xDE,0x0A,0x4E,0x39,0xC1,0xA7,0xDD,0xE3,0xF6,0xD2,0x58,0x89,
	0x92,0xC1,0xA4,0x09,0x5A,0xFB,0xD1,0x82,0x4D,0x1B,0xA7,0x48,0x47,0xF2,0xBC,0x49,
	0x26,0xD2,0xEF,0xD9,0x04,0xB4,0xB5,0x49,0x54,0xCD,0x18,0x9A,0x54,0xC5,0xD1,0x17,
	0x96,0x54,0xF8,0xF9,0xB0,0xD2,0xAB,0x5F,0x03,0x57,0xEB,0x64,0x2F,0xED,0xA9,0x5D,
	0x39,0x12,0xC6,0x57,0x69,0x45,0xFA,0xB8,0x97,0xE7,0x06,0x2C,0xAA,0x44,0xA4,0xAA,
	0x06,0xB8,0xFE,0x6E,0x3D,0xBA,0x18,0xAF,0x6A,0xE3,0x73,0x8E,0x30,0x42,0x9E,0xE9,
	0xBE,0x03,0x42,0x7C,0x9D,0x64,0xF6,0x95,0xFA,0x8C,0xAB,0x4B,0xFE,0x37,0x68,0x53,
	0xEA,0x34,0xAD,0x1D,0x76,0xBF,0xCA,0xD1,0x59,0x08,0xC0,0x77,0xFF,0xE6,0xDC,0x55,
	0x21,0xEC,0xEF,0x5D,0x27,0x8A,0x96,0xE2,0x6F,0x57,0x35,0x9F,0xFA,0xED,0xA1,0x94,
	0x34,0xB9,0x37,0xF1,0xAD,0x99,0x9D,0xC5,0xC4,0x1E,0xB1,0x19,0x35,0xB4,0x4C,0x18,
	0x10,0x0E,0x85,0x7F,0x43,0x1A,0x4A,0x5A,0x6B,0xB6,0x51,0x14,0xF1,0x74,0xC2,0xD7,
	0xB5,0x9F,0xDF,0x23,0x7D,0x6B,0xB1,0xDD,0x09,0x16,0xE6,0x44,0xD7,0x09,0xDE,0xD5,
	0x64,0x81,0x47,0x7C,0x75,0xD9,0x5C,0xDD,0x68,0x25,0x46,0x15,0xF7,0x74,0x0E,0xC0,
	0x7F,0x33,0x0A,0xC5,0xD6,0x7B,0xCD,0x75,0xBF,0x23,0xD2,0x8A,0x14,0x08,0x26,0xC0,
	0x26,0xDB,0xDE,0x97,0x1A,0x37,0xCD,0x3E,0xF9,0xB8,0xDF,0x64,0x4A,0xC3,0x85,0x01,
	0x05,0x01,0xEF,0xC6,0x50,0x9D,0x7A,0x41},
	1,{0x03},{0x15,0x12,0x31},
	{0x1F,0xF8,0x0A,0x40,0x17,0x3F,0x52,0xD7,0xD2,0x7E,0x0F,0x26,0xA1,0x46,0xA1,0xC8,
	0xCC,0xB2,0x90,0x46}
	};

	EMV_CAPK capk_visa_v92={{0xA0,0x00,0x00,0x00,0x03},0x92,
	0x01,0x01,176,
	{0x99,0x6A,0xF5,0x6F,0x56,0x91,0x87,0xD0,0x92,0x93,0xC1,0x48,0x10,0x45,0x0E,0xD8,
	0xEE,0x33,0x57,0x39,0x7B,0x18,0xA2,0x45,0x8E,0xFA,0xA9,0x2D,0xA3,0xB6,0xDF,0x65,
	0x14,0xEC,0x06,0x01,0x95,0x31,0x8F,0xD4,0x3B,0xE9,0xB8,0xF0,0xCC,0x66,0x9E,0x3F,
	0x84,0x40,0x57,0xCB,0xDD,0xF8,0xBD,0xA1,0x91,0xBB,0x64,0x47,0x3B,0xC8,0xDC,0x9A,
	0x73,0x0D,0xB8,0xF6,0xB4,0xED,0xE3,0x92,0x41,0x86,0xFF,0xD9,0xB8,0xC7,0x73,0x57,
	0x89,0xC2,0x3A,0x36,0xBA,0x0B,0x8A,0xF6,0x53,0x72,0xEB,0x57,0xEA,0x5D,0x89,0xE7,
	0xD1,0x4E,0x9C,0x7B,0x6B,0x55,0x74,0x60,0xF1,0x08,0x85,0xDA,0x16,0xAC,0x92,0x3F,
	0x15,0xAF,0x37,0x58,0xF0,0xF0,0x3E,0xBD,0x3C,0x5C,0x2C,0x94,0x9C,0xBA,0x30,0x6D,
	0xB4,0x4E,0x6A,0x2C,0x07,0x6C,0x5F,0x67,0xE2,0x81,0xD7,0xEF,0x56,0x78,0x5D,0xC4,
	0xD7,0x59,0x45,0xE4,0x91,0xF0,0x19,0x18,0x80,0x0A,0x9E,0x2D,0xC6,0x6F,0x60,0x08,
	0x05,0x66,0xCE,0x0D,0xAF,0x8D,0x17,0xEA,0xD4,0x6A,0xD8,0xE3,0x0A,0x24,0x7C,0x9F},
	1,{0x03},{0x15,0x12,0x31},
	{0x42,0x9C,0x95,0x4A,0x38,0x59,0xCE,0xF9,0x12,0x95,0xF6,0x63,0xC9,0x63,0xE5,0x82,0xED,
	0x6E,0xB2,0x53}
	};

	/*EMV_CAPK capk_visa_v94={{0xA0,0x00,0x00,0x00,0x03},0x94,
	0x01,0x01,248,
	{0xD1,0xBE,0x39,0x61,0x5F,0x39,0x5A,0xC9,0x33,0x7E,0x33,0x07,0xAA,0x5A,0x7A,0xC3,
	0x5E,0xAE,0x00,0x36,0xBF,0x20,0xB9,0x2F,0x9A,0x45,0xD1,0x90,0xB2,0xF4,0x61,0x6A,
	0xBF,0x9D,0x34,0x0C,0xBF,0x5F,0xBB,0x3A,0x2B,0x94,0xBD,0x8F,0x2F,0x97,0x7C,0x0A,
	0x10,0xB9,0x0E,0x59,0xD4,0x20,0x1A,0xA3,0x26,0x69,0xE8,0xCB,0xE7,0x53,0xF5,0x36,
	0x11,0x9D,0xF4,0xFB,0x5E,0x63,0xCE,0xD8,0x7F,0x11,0x53,0xCE,0x91,0x4B,0x12,0x4F,
	0x3E,0x6B,0x64,0x8C,0xD5,0xC9,0x76,0x55,0xF7,0xAB,0x4D,0xF6,0x26,0x07,0xC9,0x5D,
	0xA5,0x05,0x17,0xAB,0x8B,0xE3,0x83,0x66,0x72,0xD1,0xC7,0x1B,0xCD,0xE9,0xBA,0x72,
	0x93,0xFF,0x34,0x82,0xF1,0x24,0xF8,0x66,0x91,0x13,0x0A,0xB0,0x81,0x77,0xB0,0x2F,
	0x45,0x9C,0x02,0x5A,0x1F,0x3D,0xFF,0xE0,0x88,0x4C,0xE7,0x81,0x22,0x54,0x2E,0xA1,
	0xC8,0xEA,0x09,0x2B,0x55,0x2B,0x58,0x69,0x07,0xC8,0x3A,0xD6,0x5E,0x0C,0x6F,0x91,
	0xA4,0x00,0xE4,0x85,0xE1,0x11,0x92,0xAA,0x4C,0x17,0x1C,0x5A,0x1E,0xF5,0x63,0x81,
	0xF4,0xD0,0x91,0xCC,0x7E,0xF6,0xBD,0x86,0x04,0xCB,0xC4,0xC7,0x4D,0x5D,0x77,0xFF,
	0xA0,0x7B,0x64,0x1D,0x53,0x99,0x8C,0xDB,0x5C,0x21,0xB7,0xBC,0x65,0xE0,0x82,0xA6,
	0x51,0x3F,0x42,0x4A,0x4B,0x25,0x2E,0x0D,0x77,0xFA,0x40,0x56,0x98,0x6A,0x0A,0xB0,
	0xCD,0xA6,0x15,0x5E,0xD9,0xA8,0x83,0xC6,0x9C,0xC2,0x99,0x2D,0x49,0xEC,0xBD,0x47,
	0x97,0xDD,0x28,0x64,0xFF,0xC9,0x6B,0x8D},
	3,{0x01,0x00,0x01},{0x15,0x12,0x31},
	{0x1D,0x19,0x31,0x49,0xFD,0x83,0xDC,0xB3,0x37,0xF4,0xA1,0xB5,0xCF,0xAA,0x14,0x4D,
	0x06,0x6B,0x66,0xFB}
	};*/

	EMV_CAPK capk_visa_v94={{0xA0,0x00,0x00,0x00,0x03},0x94,
	0x01,0x01,248,
	{0xAC, 0xD2, 0xB1, 0x23, 0x02, 0xEE, 0x64, 0x4F, 0x3F, 0x83, 0x5A, 0xBD, 0x1F, 0xC7, 0xA6, 0xF6, 
		0x2C, 0xCE, 0x48, 0xFF, 0xEC, 0x62, 0x2A, 0xA8, 0xEF, 0x06, 0x2B, 0xEF, 0x6F, 0xB8, 0xBA, 0x8B, 
		0xC6, 0x8B, 0xBF, 0x6A, 0xB5, 0x87, 0x0E, 0xED, 0x57, 0x9B, 0xC3, 0x97, 0x3E, 0x12, 0x13, 0x03, 
		0xD3, 0x48, 0x41, 0xA7, 0x96, 0xD6, 0xDC, 0xBC, 0x41, 0xDB, 0xF9, 0xE5, 0x2C, 0x46, 0x09, 0x79, 
		0x5C, 0x0C, 0xCF, 0x7E, 0xE8, 0x6F, 0xA1, 0xD5, 0xCB, 0x04, 0x10, 0x71, 0xED, 0x2C, 0x51, 0xD2, 
		0x20, 0x2F, 0x63, 0xF1, 0x15, 0x6C, 0x58, 0xA9, 0x2D, 0x38, 0xBC, 0x60, 0xBD, 0xF4, 0x24, 0xE1, 
		0x77, 0x6E, 0x2B, 0xC9, 0x64, 0x80, 0x78, 0xA0, 0x3B, 0x36, 0xFB, 0x55, 0x43, 0x75, 0xFC, 0x53, 
		0xD5, 0x7C, 0x73, 0xF5, 0x16, 0x0E, 0xA5, 0x9F, 0x3A, 0xFC, 0x53, 0x98, 0xEC, 0x7B, 0x67, 0x75, 
		0x8D, 0x65, 0xC9, 0xBF, 0xF7, 0x82, 0x8B, 0x6B, 0x82, 0xD4, 0xBE, 0x12, 0x4A, 0x41, 0x6A, 0xB7, 
		0x30, 0x19, 0x14, 0x31, 0x1E, 0xA4, 0x62, 0xC1, 0x9F, 0x77, 0x1F, 0x31, 0xB3, 0xB5, 0x73, 0x36, 
		0x00, 0x0D, 0xFF, 0x73, 0x2D, 0x3B, 0x83, 0xDE, 0x07, 0x05, 0x2D, 0x73, 0x03, 0x54, 0xD2, 0x97, 
		0xBE, 0xC7, 0x28, 0x71, 0xDC, 0xCF, 0x0E, 0x19, 0x3F, 0x17, 0x1A, 0xBA, 0x27, 0xEE, 0x46, 0x4C, 
		0x6A, 0x97, 0x69, 0x09, 0x43, 0xD5, 0x9B, 0xDA, 0xBB, 0x2A, 0x27, 0xEB, 0x71, 0xCE, 0xEB, 0xDA, 
		0xFA, 0x11, 0x76, 0x04, 0x64, 0x78, 0xFD, 0x62, 0xFE, 0xC4, 0x52, 0xD5, 0xCA, 0x39, 0x32, 0x96, 
		0x53, 0x0A, 0xA3, 0xF4, 0x19, 0x27, 0xAD, 0xFE, 0x43, 0x4A, 0x2D, 0xF2, 0xAE, 0x30, 0x54, 0xF8, 
		0x84, 0x06, 0x57, 0xA2, 0x6E, 0x0F, 0xC6, 0x17},
	1,{0x03},{0x15,0x12,0x31},
	{0xC4, 0xA3, 0xC4, 0x3C, 0xCF, 0x87, 0x32, 0x7D, 0x13, 0x6B, 0x80, 0x41, 0x60, 0xE4, 0x7D, 0x43, 
		0xB6, 0x0E, 0x6E, 0x0F}
	};


	EMV_CAPK capk_visa_v95={{0xA0,0x00,0x00,0x00,0x03},0x95,
	0x01,0x01,144,
	{0xBE,0x9E,0x1F,0xA5,0xE9,0xA8,0x03,0x85,0x29,0x99,0xC4,0xAB,0x43,0x2D,0xB2,0x86,
	0x00,0xDC,0xD9,0xDA,0xB7,0x6D,0xFA,0xAA,0x47,0x35,0x5A,0x0F,0xE3,0x7B,0x15,0x08,
	0xAC,0x6B,0xF3,0x88,0x60,0xD3,0xC6,0xC2,0xE5,0xB1,0x2A,0x3C,0xAA,0xF2,0xA7,0x00,
	0x5A,0x72,0x41,0xEB,0xAA,0x77,0x71,0x11,0x2C,0x74,0xCF,0x9A,0x06,0x34,0x65,0x2F,
	0xBC,0xA0,0xE5,0x98,0x0C,0x54,0xA6,0x47,0x61,0xEA,0x10,0x1A,0x11,0x4E,0x0F,0x0B,
	0x55,0x72,0xAD,0xD5,0x7D,0x01,0x0B,0x7C,0x9C,0x88,0x7E,0x10,0x4C,0xA4,0xEE,0x12,
	0x72,0xDA,0x66,0xD9,0x97,0xB9,0xA9,0x0B,0x5A,0x6D,0x62,0x4A,0xB6,0xC5,0x7E,0x73,
	0xC8,0xF9,0x19,0x00,0x0E,0xB5,0xF6,0x84,0x89,0x8E,0xF8,0xC3,0xDB,0xEF,0xB3,0x30,
	0xC6,0x26,0x60,0xBE,0xD8,0x8E,0xA7,0x8E,0x90,0x9A,0xFF,0x05,0xF6,0xDA,0x62,0x7B},
	1,{0x03},{0x15,0x12,0x31},
	{0xEE,0x15,0x11,0xCE,0xC7,0x10,0x20,0xA9,0xB9,0x04,0x43,0xB3,0x7B,0x1D,0x5F,0x6E,
	0x70,0x30,0x30,0xF6}
	};

	EMV_CAPK capk_visa_v96={{0xA0,0x00,0x00,0x00,0x03},0x96, 
	0x01,0x01,128, 
	{0xB7,0x45,0x86,0xD1,0x9A,0x20,0x7B,0xE6,0x62,0x7C,0x5B,0x0A,0xAF,0xBC,0x44,0xA2,
	0xEC,0xF5,0xA2,0x94,0x2D,0x3A,0x26,0xCE,0x19,0xC4,0xFF,0xAE,0xEE,0x92,0x05,0x21,
	0x86,0x89,0x22,0xE8,0x93,0xE7,0x83,0x82,0x25,0xA3,0x94,0x7A,0x26,0x14,0x79,0x6F,
	0xB2,0xC0,0x62,0x8C,0xE8,0xC1,0x1E,0x38,0x25,0xA5,0x6D,0x3B,0x1B,0xBA,0xEF,0x78,
	0x3A,0x5C,0x6A,0x81,0xF3,0x6F,0x86,0x25,0x39,0x51,0x26,0xFA,0x98,0x3C,0x52,0x16,
	0xD3,0x16,0x6D,0x48,0xAC,0xDE,0x8A,0x43,0x12,0x12,0xFF,0x76,0x3A,0x7F,0x79,0xD9,
	0xED,0xB7,0xFE,0xD7,0x6B,0x48,0x5D,0xE4,0x5B,0xEB,0x82,0x9A,0x3D,0x47,0x30,0x84,
	0x8A,0x36,0x6D,0x33,0x24,0xC3,0x02,0x70,0x32,0xFF,0x8D,0x16,0xA1,0xE4,0x4D,0x8D},
	1,{0x03},{0x15,0x12,0x31},
	{0x76,0x16,0xE9,0xAC,0x8B,0xE0,0x14,0xAF,0x88,0xCA,0x11,0xA8,0xFB,0x17,0x96,0x7B,
	0x73,0x94,0x03,0x0E} 
	}; 

	EMV_CAPK capk_visa_v98={{0xA0,0x00,0x00,0x00,0x03},0x98, 
	0x01,0x01,112, 
	{0xCA,0x02,0x6E,0x52,0xA6,0x95,0xE7,0x2B,0xD3,0x0A,0xF9,0x28,0x19,0x6E,0xED,0xC9,
	0xFA,0xF4,0xA6,0x19,0xF2,0x49,0x2E,0x3F,0xB3,0x11,0x69,0x78,0x9C,0x27,0x6F,0xFB,
	0xB7,0xD4,0x31,0x16,0x64,0x7B,0xA9,0xE0,0xD1,0x06,0xA3,0x54,0x2E,0x39,0x65,0x29,
	0x2C,0xF7,0x78,0x23,0xDD,0x34,0xCA,0x8E,0xEC,0x7D,0xE3,0x67,0xE0,0x80,0x70,0x89,
	0x50,0x77,0xC7,0xEF,0xAD,0x93,0x99,0x24,0xCB,0x18,0x70,0x67,0xDB,0xF9,0x2C,0xB1,
	0xE7,0x85,0x91,0x7B,0xD3,0x8B,0xAC,0xE0,0xC1,0x94,0xCA,0x12,0xDF,0x0C,0xE5,0xB7,
	0xA5,0x02,0x75,0xAC,0x61,0xBE,0x7C,0x3B,0x43,0x68,0x87,0xCA,0x98,0xC9,0xFD,0x39},
	1,{0x03},{0x15,0x12,0x31},
	{0xE7,0xAC,0x9A,0xA8,0xEE,0xD1,0xB5,0xFF,0x1B,0xD5,0x32,0xCF,0x14,0x89,0xA3,0xE5,
	0x55,0x75,0x72,0xC1} 
	}; 
	
	// VISA 1984 BITS LIVE KEY 09
	EMV_CAPK capk_visa_v99={{0xA0,0x00,0x00,0x00,0x03},0x99, 
	0x01,0x01,128, 
	{0xAB,0x79,0xFC,0xC9,0x52,0x08,0x96,0x96,0x7E,0x77,0x6E,0x64,0x44,0x4E,0x5D,0xCD,
	0xD6,0xE1,0x36,0x11,0x87,0x4F,0x39,0x85,0x72,0x25,0x20,0x42,0x52,0x95,0xEE,0xA4,
	0xBD,0x0C,0x27,0x81,0xDE,0x7F,0x31,0xCD,0x3D,0x04,0x1F,0x56,0x5F,0x74,0x73,0x06,
	0xEE,0xD6,0x29,0x54,0xB1,0x7E,0xDA,0xBA,0x3A,0x6C,0x5B,0x85,0xA1,0xDE,0x1B,0xEB,
	0x9A,0x34,0x14,0x1A,0xF3,0x8F,0xCF,0x82,0x79,0xC9,0xDE,0xA0,0xD5,0xA6,0x71,0x0D,
	0x08,0xDB,0x41,0x24,0xF0,0x41,0x94,0x55,0x87,0xE2,0x03,0x59,0xBA,0xB4,0x7B,0x75,
	0x75,0xAD,0x94,0x26,0x2D,0x4B,0x25,0xF2,0x64,0xAF,0x33,0xDE,0xDC,0xF2,0x8E,0x09,
	0x61,0x5E,0x93,0x7D,0xE3,0x2E,0xDC,0x03,0xC5,0x44,0x45,0xFE,0x7E,0x38,0x27,0x77},
	1,{0x03},{0x15,0x12,0x31},
	{0x4A,0xBF,0xFD,0x6B,0x1C,0x51,0x21,0x2D,0x05,0x55,0x2E,0x43,0x1C,0x5B,0x17,0x00,
	0x7D,0x2F,0x5E,0x6D} 
	};
	/*EMV_CAPK capk_visa_v01={{0xA0,0x00,0x00,0x00,0x03},0x01,
	0x01,0x01,128,
	{0xC6,0x96,0x03,0x42,0x13,0xD7,0xD8,0x54,0x69,0x84,0x57,0x9D,0x1D,0x0F,0x0E,0xA5,
	0x19,0xCF,0xF8,0xDE,0xFF,0xC4,0x29,0x35,0x4C,0xF3,0xA8,0x71,0xA6,0xF7,0x18,0x3F,
	0x12,0x28,0xDA,0x5C,0x74,0x70,0xC0,0x55,0x38,0x71,0x00,0xCB,0x93,0x5A,0x71,0x2C,
	0x4E,0x28,0x64,0xDF,0x5D,0x64,0xBA,0x93,0xFE,0x7E,0x63,0xE7,0x1F,0x25,0xB1,0xE5,
	0xF5,0x29,0x85,0x75,0xEB,0xE1,0xC6,0x3A,0xA6,0x17,0x70,0x69,0x17,0x91,0x1D,0xC2,
	0xA7,0x5A,0xC2,0x8B,0x25,0x1C,0x7E,0xF4,0x0F,0x23,0x65,0x91,0x24,0x90,0xB9,0x39,
	0xBC,0xA2,0x12,0x4A,0x30,0xA2,0x8F,0x54,0x40,0x2C,0x34,0xAE,0xCA,0x33,0x1A,0xB6,
	0x7E,0x1E,0x79,0xB2,0x85,0xDD,0x57,0x71,0xB5,0xD9,0xFF,0x79,0xEA,0x63,0x0B,0x75},
	1,{0x03},{0x15,0x12,0x31},
	{0xD3,0x4A,0x6A,0x77,0x60,0x11,0xC7,0xE7,0xCE,0x3A,0xEC,0x5F,0x03,0xAD,0x2F,0x8C,
	0xFC,0x55,0x03,0xCC}
	};*/
	
	// VISA 1152 bits Live Key 07
	/*EMV_CAPK capk_visa_v07={{0xA0,0x00,0x00,0x00,0x03},0x07,
	0x01,0x01,144,
	{0xA8,0x9F,0x25,0xA5,0x6F,0xA6,0xDA,0x25,0x8C,0x8C,0xA8,0xB4,0x04,0x27,0xD9,0x27,
	0xB4,0xA1,0xEB,0x4D,0x7E,0xA3,0x26,0xBB,0xB1,0x2F,0x97,0xDE,0xD7,0x0A,0xE5,0xE4,
	0x48,0x0F,0xC9,0xC5,0xE8,0xA9,0x72,0x17,0x71,0x10,0xA1,0xCC,0x31,0x8D,0x06,0xD2,
	0xF8,0xF5,0xC4,0x84,0x4A,0xC5,0xFA,0x79,0xA4,0xDC,0x47,0x0B,0xB1,0x1E,0xD6,0x35,
	0x69,0x9C,0x17,0x08,0x1B,0x90,0xF1,0xB9,0x84,0xF1,0x2E,0x92,0xC1,0xC5,0x29,0x27,
	0x6D,0x8A,0xF8,0xEC,0x7F,0x28,0x49,0x20,0x97,0xD8,0xCD,0x5B,0xEC,0xEA,0x16,0xFE,
	0x40,0x88,0xF6,0xCF,0xAB,0x4A,0x1B,0x42,0x32,0x8A,0x1B,0x99,0x6F,0x92,0x78,0xB0,
	0xB7,0xE3,0x31,0x1C,0xA5,0xEF,0x85,0x6C,0x2F,0x88,0x84,0x74,0xB8,0x36,0x12,0xA8,
	0x2E,0x4E,0x00,0xD0,0xCD,0x40,0x69,0xA6,0x78,0x31,0x40,0x43,0x3D,0x50,0x72,0x5F},
	1,{0x03},{0x15,0x12,0x31},
	{0xB4,0xBC,0x56,0xCC,0x4E,0x88,0x32,0x49,0x32,0xCB,0xC6,0x43,0xD6,0x89,0x8F,0x6F,
	0xE5,0x93,0xB1,0x72}
	};*/
	//Modified from old 1152 bits key to new one on Feb 6,2004.
	
	// VISA 1408 BITS LIVE KEY 08
	/*EMV_CAPK capk_visa_v08={{0xA0,0x00,0x00,0x00,0x03},0x08, 
	0x01,0x01,176, 
	{0xD9,0xFD,0x6E,0xD7,0x5D,0x51,0xD0,0xE3,0x06,0x64,0xBD,0x15,0x70,0x23,0xEA,0xA1, 
	0xFF,0xA8,0x71,0xE4,0xDA,0x65,0x67,0x2B,0x86,0x3D,0x25,0x5E,0x81,0xE1,0x37,0xA5, 
	0x1D,0xE4,0xF7,0x2B,0xCC,0x9E,0x44,0xAC,0xE1,0x21,0x27,0xF8,0x7E,0x26,0x3D,0x3A, 
	0xF9,0xDD,0x9C,0xF3,0x5C,0xA4,0xA7,0xB0,0x1E,0x90,0x70,0x00,0xBA,0x85,0xD2,0x49, 
	0x54,0xC2,0xFC,0xA3,0x07,0x48,0x25,0xDD,0xD4,0xC0,0xC8,0xF1,0x86,0xCB,0x02,0x0F, 
	0x68,0x3E,0x02,0xF2,0xDE,0xAD,0x39,0x69,0x13,0x3F,0x06,0xF7,0x84,0x51,0x66,0xAC, 
	0xEB,0x57,0xCA,0x0F,0xC2,0x60,0x34,0x45,0x46,0x98,0x11,0xD2,0x93,0xBF,0xEF,0xBA, 
	0xFA,0xB5,0x76,0x31,0xB3,0xDD,0x91,0xE7,0x96,0xBF,0x85,0x0A,0x25,0x01,0x2F,0x1A, 
	0xE3,0x8F,0x05,0xAA,0x5C,0x4D,0x6D,0x03,0xB1,0xDC,0x2E,0x56,0x86,0x12,0x78,0x59, 
	0x38,0xBB,0xC9,0xB3,0xCD,0x3A,0x91,0x0C,0x1D,0xA5,0x5A,0x5A,0x92,0x18,0xAC,0xE0, 
	0xF7,0xA2,0x12,0x87,0x75,0x26,0x82,0xF1,0x58,0x32,0xA6,0x78,0xD6,0xE1,0xED,0x0B}, 
	1,{0x03}, {0x15,0x12,0x31},
	{0x20,0xD2,0x13,0x12,0x69,0x55,0xDE,0x20,0x5A,0xDC,0x2F,0xD2,0x82,0x2B,0xD2,0x2D,
	0xE2,0x1C,0xF9,0xA8} 
	}; */
	// expired on December 31, 2016

	// Mastercard 1984 bits transaction time test Key EF
	EMV_CAPK capk_mastercard_tEF={{0xA0,0x00,0x00,0x00,0x04},0xEF,
	0x01,0x01,248,
	{0xA1,0x91,0xCB,0x87,0x47,0x3F,0x29,0x34,0x9B,0x5D,0x60,0xA8,0x8B,0x3E,0xAE,0xE0,
	0x97,0x3A,0xA6,0xF1,0xA0,0x82,0xF3,0x58,0xD8,0x49,0xFD,0xDF,0xF9,0xC0,0x91,0xF8,
	0x99,0xED,0xA9,0x79,0x2C,0xAF,0x09,0xEF,0x28,0xF5,0xD2,0x24,0x04,0xB8,0x8A,0x22,
	0x93,0xEE,0xBB,0xC1,0x94,0x9C,0x43,0xBE,0xA4,0xD6,0x0C,0xFD,0x87,0x9A,0x15,0x39,
	0x54,0x4E,0x09,0xE0,0xF0,0x9F,0x60,0xF0,0x65,0xB2,0xBF,0x2A,0x13,0xEC,0xC7,0x05,
	0xF3,0xD4,0x68,0xB9,0xD3,0x3A,0xE7,0x7A,0xD9,0xD3,0xF1,0x9C,0xA4,0x0F,0x23,0xDC,
	0xF5,0xEB,0x7C,0x04,0xDC,0x8F,0x69,0xEB,0xA5,0x65,0xB1,0xEB,0xCB,0x46,0x86,0xCD,
	0x27,0x47,0x85,0x53,0x0F,0xF6,0xF6,0xE9,0xEE,0x43,0xAA,0x43,0xFD,0xB0,0x2C,0xE0,
	0x0D,0xAE,0xC1,0x5C,0x7B,0x8F,0xD6,0xA9,0xB3,0x94,0xBA,0xBA,0x41,0x9D,0x3F,0x6D,
	0xC8,0x5E,0x16,0x56,0x9B,0xE8,0xE7,0x69,0x89,0x68,0x8E,0xFE,0xA2,0xDF,0x22,0xFF,
	0x7D,0x35,0xC0,0x43,0x33,0x8D,0xEA,0xA9,0x82,0xA0,0x2B,0x86,0x6D,0xE5,0x32,0x85,
	0x19,0xEB,0xBC,0xD6,0xF0,0x3C,0xDD,0x68,0x66,0x73,0x84,0x7F,0x84,0xDB,0x65,0x1A,
	0xB8,0x6C,0x28,0xCF,0x14,0x62,0x56,0x2C,0x57,0x7B,0x85,0x35,0x64,0xA2,0x90,0xC8,
	0x55,0x6D,0x81,0x85,0x31,0x26,0x8D,0x25,0xCC,0x98,0xA4,0xCC,0x6A,0x0B,0xDF,0xFF,
	0xDA,0x2D,0xCC,0xA3,0xA9,0x4C,0x99,0x85,0x59,0xE3,0x07,0xFD,0xDF,0x91,0x50,0x06,
	0xD9,0xA9,0x87,0xB0,0x7D,0xDA,0xEB,0x3B},
	1,{0x03},{0x15,0x12,0x31},
	{0x21,0x76,0x6E,0xBB,0x0E,0xE1,0x22,0xAF,0xB6,0x5D,0x78,0x45,0xB7,0x3D,0xB4,0x6B,
	0xAB,0x65,0x42,0x7A}
	};

	EMV_CAPK capk_mastercard_vfa={{0xA0,0x00,0x00,0x00,0x04},0xfa,
	0x01,0x01,144,
	{0xA9,0x0F,0xCD,0x55,0xAA,0x2D,0x5D,0x99,0x63,0xE3,0x5E,0xD0,0xF4,0x40,0x17,0x76,
	0x99,0x83,0x2F,0x49,0xC6,0xBA,0xB1,0x5C,0xDA,0xE5,0x79,0x4B,0xE9,0x3F,0x93,0x4D,
	0x44,0x62,0xD5,0xD1,0x27,0x62,0xE4,0x8C,0x38,0xBA,0x83,0xD8,0x44,0x5D,0xEA,0xA7,
	0x41,0x95,0xA3,0x01,0xA1,0x02,0xB2,0xF1,0x14,0xEA,0xDA,0x0D,0x18,0x0E,0xE5,0xE7,
	0xA5,0xC7,0x3E,0x0C,0x4E,0x11,0xF6,0x7A,0x43,0xDD,0xAB,0x5D,0x55,0x68,0x3B,0x14,
	0x74,0xCC,0x06,0x27,0xF4,0x4B,0x8D,0x30,0x88,0xA4,0x92,0xFF,0xAA,0xDA,0xD4,0xF4,
	0x24,0x22,0xD0,0xE7,0x01,0x35,0x36,0xC3,0xC4,0x9A,0xD3,0xD0,0xFA,0xE9,0x64,0x59,
	0xB0,0xF6,0xB1,0xB6,0x05,0x65,0x38,0xA3,0xD6,0xD4,0x46,0x40,0xF9,0x44,0x67,0xB1,
	0x08,0x86,0x7D,0xEC,0x40,0xFA,0xAE,0xCD,0x74,0x0C,0x00,0xE2,0xB7,0xA8,0x85,0x2D},
	1,{0x03},{0x15,0x12,0x31},
	{0x5B,0xED,0x40,0x68,0xD9,0x6E,0xA1,0x6D,0x2D,0x77,0xE0,0x3D,0x60,0x36,0xFC,0x7A,
	0x16,0x0E,0xA9,0x9C}
	};
	// Mastercard 1024 bits Live Key 03
	EMV_CAPK capk_mastercard_vfe={{0xA0,0x00,0x00,0x00,0x04},0xfe,
	0x01,0x01,128,
	{0xA6,0x53,0xEA,0xC1,0xC0,0xF7,0x86,0xC8,0x72,0x4F,0x73,0x7F,0x17,0x29,0x97,0xD6,
	0x3D,0x1C,0x32,0x51,0xC4,0x44,0x02,0x04,0x9B,0x86,0x5B,0xAE,0x87,0x7D,0x0F,0x39,
	0x8C,0xBF,0xBE,0x8A,0x60,0x35,0xE2,0x4A,0xFA,0x08,0x6B,0xEF,0xDE,0x93,0x51,0xE5,
	0x4B,0x95,0x70,0x8E,0xE6,0x72,0xF0,0x96,0x8B,0xCD,0x50,0xDC,0xE4,0x0F,0x78,0x33,
	0x22,0xB2,0xAB,0xA0,0x4E,0xF1,0x37,0xEF,0x18,0xAB,0xF0,0x3C,0x7D,0xBC,0x58,0x13,
	0xAE,0xAE,0xF3,0xAA,0x77,0x97,0xBA,0x15,0xDF,0x7D,0x5B,0xA1,0xCB,0xAF,0x7F,0xD5,
	0x20,0xB5,0xA4,0x82,0xD8,0xD3,0xFE,0xE1,0x05,0x07,0x78,0x71,0x11,0x3E,0x23,0xA4,
	0x9A,0xF3,0x92,0x65,0x54,0xA7,0x0F,0xE1,0x0E,0xD7,0x28,0xCF,0x79,0x3B,0x62,0xA1},
	1,{0x03},{0x15,0x12,0x31},
	{0x9A,0x29,0x5B,0x05,0xFB,0x39,0x0E,0xF7,0x92,0x3F,0x57,0x61,0x8A,0x9F,0xDA,0x29,
	0x41,0xFC,0x34,0xE0}
	};

	EMV_CAPK capk_mastercard_vf1={{0xA0,0x00,0x00,0x00,0x04},0xF1,
	0x01,0x01,176,
	{0xA0,0xDC,0xF4,0xBD,0xE1,0x9C,0x35,0x46,0xB4,0xB6,0xF0,0x41,0x4D,0x17,0x4D,0xDE,
	0x29,0x4A,0xAB,0xBB,0x82,0x8C,0x5A,0x83,0x4D,0x73,0xAA,0xE2,0x7C,0x99,0xB0,0xB0,
	0x53,0xA9,0x02,0x78,0x00,0x72,0x39,0xB6,0x45,0x9F,0xF0,0xBB,0xCD,0x7B,0x4B,0x9C,
	0x6C,0x50,0xAC,0x02,0xCE,0x91,0x36,0x8D,0xA1,0xBD,0x21,0xAA,0xEA,0xDB,0xC6,0x53,
	0x47,0x33,0x7D,0x89,0xB6,0x8F,0x5C,0x99,0xA0,0x9D,0x05,0xBE,0x02,0xDD,0x1F,0x8C,
	0x5B,0xA2,0x0E,0x2F,0x13,0xFB,0x2A,0x27,0xC4,0x1D,0x3F,0x85,0xCA,0xD5,0xCF,0x66,
	0x68,0xE7,0x58,0x51,0xEC,0x66,0xED,0xBF,0x98,0x85,0x1F,0xD4,0xE4,0x2C,0x44,0xC1,
	0xD5,0x9F,0x59,0x84,0x70,0x3B,0x27,0xD5,0xB9,0xF2,0x1B,0x8F,0xA0,0xD9,0x32,0x79,
	0xFB,0xBF,0x69,0xE0,0x90,0x64,0x29,0x09,0xC9,0xEA,0x27,0xF8,0x98,0x95,0x95,0x41,
	0xAA,0x67,0x57,0xF5,0xF6,0x24,0x10,0x4F,0x6E,0x1D,0x3A,0x95,0x32,0xF2,0xA6,0xE5,
	0x15,0x15,0xAE,0xAD,0x1B,0x43,0xB3,0xD7,0x83,0x50,0x88,0xA2,0xFA,0xFA,0x7B,0xE7},
	1,{0x03},{0x15,0x12,0x31},
	{0xD8,0xE6,0x8D,0xA1,0x67,0xAB,0x5A,0x85,0xD8,0xC3,0xD5,0x5E,0xCB,0x9B,0x05,0x17,
	0xA1,0xA5,0xB4,0xBB}
	};

	// Added by Idina 2015-11-19
	// =============== Mastercard ============================= //
	
	EMV_CAPK capk_mastercard_v03={{0xA0,0x00,0x00,0x00,0x04},0x03,
	0x01,0x01,128,
	{0xC2, 0x49, 0x07, 0x47, 0xFE, 0x17, 0xEB, 0x05, 0x84, 0xC8, 0x8D, 0x47, 0xB1, 0x60, 0x27, 0x04, 
		0x15, 0x0A, 0xDC, 0x88, 0xC5, 0xB9, 0x98, 0xBD, 0x59, 0xCE, 0x04, 0x3E, 0xDE, 0xBF, 0x0F, 0xFE, 
		0xE3, 0x09, 0x3A, 0xC7, 0x95, 0x6A, 0xD3, 0xB6, 0xAD, 0x45, 0x54, 0xC6, 0xDE, 0x19, 0xA1, 0x78, 
		0xD6, 0xDA, 0x29, 0x5B, 0xE1, 0x5D, 0x52, 0x20, 0x64, 0x5E, 0x3C, 0x81, 0x31, 0x66, 0x6F, 0xA4, 
		0xBE, 0x5B, 0x84, 0xFE, 0x13, 0x1E, 0xA4, 0x4B, 0x03, 0x93, 0x07, 0x63, 0x8B, 0x9E, 0x74, 0xA8, 
		0xC4, 0x25, 0x64, 0xF8, 0x92, 0xA6, 0x4D, 0xF1, 0xCB, 0x15, 0x71, 0x2B, 0x73, 0x6E, 0x33, 0x74, 
		0xF1, 0xBB, 0xB6, 0x81, 0x93, 0x71, 0x60, 0x2D, 0x89, 0x70, 0xE9, 0x7B, 0x90, 0x07, 0x93, 0xC7, 
		0xC2, 0xA8, 0x9A, 0x4A, 0x16, 0x49, 0xA5, 0x9B, 0xE6, 0x80, 0x57, 0x4D, 0xD0, 0xB6, 0x01, 0x45
	},
	1,{0x03},{0x09,0x12,0x30},
	{0x5A, 0xDD, 0xF2, 0x1D, 0x09, 0x27, 0x86, 0x61, 0x14, 0x11, 0x79, 0xCB, 0xEF, 0xF2, 0x72, 0xEA, 
		0x38, 0x4B, 0x13, 0xBB}
	};

	EMV_CAPK capk_mastercard_vf0={{0xA0,0x00,0x00,0x00,0x04},0xF0,
	0x01,0x01,208,
	{0x99, 0x9E, 0xA2, 0xD4, 0x30, 0xD6, 0x06, 0x14, 0xE1, 0x00, 0x70, 0x6C, 0x7D, 0xA2, 0x13, 0xE1, 
		0xC7, 0x7A, 0xD1, 0x8C, 0x11, 0xBD, 0x70, 0xBC, 0x42, 0xCE, 0xBD, 0x80, 0xA3, 0xC9, 0x4E, 0xC5, 
		0xE7, 0x36, 0xD3, 0x45, 0xEA, 0x7A, 0xDE, 0x2B, 0x9E, 0x0B, 0xC8, 0x81, 0x6E, 0x56, 0x7D, 0x39, 
		0x41, 0x2E, 0xB7, 0x28, 0xC2, 0xB2, 0xCC, 0xE7, 0x3D, 0xEB, 0xC9, 0xFA, 0x25, 0xD4, 0x91, 0x9B, 
		0xF5, 0x42, 0x0C, 0x98, 0x60, 0x83, 0xFB, 0xC0, 0x75, 0x08, 0x95, 0xAF, 0xBA, 0x6B, 0x9D, 0xAA, 
		0x62, 0xB1, 0xB7, 0xD8, 0x43, 0x9C, 0xF2, 0x9E, 0x72, 0x0D, 0x08, 0x5D, 0x5D, 0x09, 0x62, 0xA9, 
		0x44, 0x3B, 0x1F, 0x73, 0x8E, 0x65, 0x60, 0xEF, 0x0E, 0xED, 0x75, 0x72, 0x81, 0x5E, 0xA8, 0x7A, 
		0x1B, 0x07, 0x57, 0x0F, 0x11, 0x98, 0x67, 0xDD, 0x6C, 0xC5, 0xD4, 0xDE, 0x06, 0xAA, 0x53, 0x73, 
		0x84, 0x7D, 0x17, 0xA6, 0x10, 0xEC, 0xF9, 0x32, 0xFA, 0x2C, 0x94, 0x23, 0x4E, 0x68, 0xAF, 0x84, 
		0xA9, 0xE0, 0xDA, 0xA1, 0x81, 0x16, 0xB3, 0x26, 0x01, 0x6B, 0x70, 0x13, 0x6F, 0x49, 0x34, 0x82, 
		0xFE, 0xAE, 0x98, 0xE4, 0xAE, 0x68, 0x2B, 0xF9, 0x6C, 0x59, 0x27, 0x97, 0x52, 0x24, 0x8D, 0xEC, 
		0x91, 0x5E, 0xD6, 0xF9, 0xBB, 0x73, 0xF9, 0x20, 0x61, 0x55, 0xD9, 0x61, 0xB5, 0x08, 0x65, 0xE1, 
		0xCA, 0x6D, 0x47, 0x32, 0x2F, 0xCE, 0x22, 0xDC, 0xF1, 0x95, 0x71, 0x82, 0xB6, 0xE9, 0x9C, 0xBB
	},
	1,{0x03},{0x15,0x12,0x31},
	{0xB8, 0xEA, 0x49, 0x16, 0x9B, 0x54, 0xF3, 0xB7, 0xFF, 0x0D, 0xF3, 0xA8, 0xB6, 0x38, 0x8C, 0x82, 
		0xA1, 0xDB, 0xE7, 0x30}
	};

	EMV_CAPK capk_mastercard_vf3={{0xA0,0x00,0x00,0x00,0x04},0xF3,
	0x01,0x01,144,
	{0x98, 0xF0, 0xC7, 0x70, 0xF2, 0x38, 0x64, 0xC2, 0xE7, 0x66, 0xDF, 0x02, 0xD1, 0xE8, 0x33, 0xDF, 
		0xF4, 0xFF, 0xE9, 0x2D, 0x69, 0x6E, 0x16, 0x42, 0xF0, 0xA8, 0x8C, 0x56, 0x94, 0xC6, 0x47, 0x9D, 
		0x16, 0xDB, 0x15, 0x37, 0xBF, 0xE2, 0x9E, 0x4F, 0xDC, 0x6E, 0x6E, 0x8A, 0xFD, 0x1B, 0x0E, 0xB7, 
		0xEA, 0x01, 0x24, 0x72, 0x3C, 0x33, 0x31, 0x79, 0xBF, 0x19, 0xE9, 0x3F, 0x10, 0x65, 0x8B, 0x2F, 
		0x77, 0x6E, 0x82, 0x9E, 0x87, 0xDA, 0xED, 0xA9, 0xC9, 0x4A, 0x8B, 0x33, 0x82, 0x19, 0x9A, 0x35, 
		0x0C, 0x07, 0x79, 0x77, 0xC9, 0x7A, 0xFF, 0x08, 0xFD, 0x11, 0x31, 0x0A, 0xC9, 0x50, 0xA7, 0x2C, 
		0x3C, 0xA5, 0x00, 0x2E, 0xF5, 0x13, 0xFC, 0xCC, 0x28, 0x6E, 0x64, 0x6E, 0x3C, 0x53, 0x87, 0x53, 
		0x5D, 0x50, 0x95, 0x14, 0xB3, 0xB3, 0x26, 0xE1, 0x23, 0x4F, 0x9C, 0xB4, 0x8C, 0x36, 0xDD, 0xD4, 
		0x4B, 0x41, 0x6D, 0x23, 0x65, 0x40, 0x34, 0xA6, 0x6F, 0x40, 0x3B, 0xA5, 0x11, 0xC5, 0xEF, 0xA3
	},
	1,{0x03},{0x09,0x12,0x31},
	{0xA6, 0x9A, 0xC7, 0x60, 0x3D, 0xAF, 0x56, 0x6E, 0x97, 0x2D, 0xED, 0xC2, 0xCB, 0x43, 0x3E, 0x07, 
		0xE8, 0xB0, 0x1A, 0x9A}
	};

	EMV_CAPK capk_mastercard_vf8={{0xA0,0x00,0x00,0x00,0x04},0xF8,
	0x01,0x01,128,
	{0xA1, 0xF5, 0xE1, 0xC9, 0xBD, 0x86, 0x50, 0xBD, 0x43, 0xAB, 0x6E, 0xE5, 0x6B, 0x89, 0x1E, 0xF7, 
		0x45, 0x9C, 0x0A, 0x24, 0xFA, 0x84, 0xF9, 0x12, 0x7D, 0x1A, 0x6C, 0x79, 0xD4, 0x93, 0x0F, 0x6D, 
		0xB1, 0x85, 0x2E, 0x25, 0x10, 0xF1, 0x8B, 0x61, 0xCD, 0x35, 0x4D, 0xB8, 0x3A, 0x35, 0x6B, 0xD1, 
		0x90, 0xB8, 0x8A, 0xB8, 0xDF, 0x04, 0x28, 0x4D, 0x02, 0xA4, 0x20, 0x4A, 0x7B, 0x6C, 0xB7, 0xC5, 
		0x55, 0x19, 0x77, 0xA9, 0xB3, 0x63, 0x79, 0xCA, 0x3D, 0xE1, 0xA0, 0x8E, 0x69, 0xF3, 0x01, 0xC9, 
		0x5C, 0xC1, 0xC2, 0x05, 0x06, 0x95, 0x92, 0x75, 0xF4, 0x17, 0x23, 0xDD, 0x5D, 0x29, 0x25, 0x29, 
		0x05, 0x79, 0xE5, 0xA9, 0x5B, 0x0D, 0xF6, 0x32, 0x3F, 0xC8, 0xE9, 0x27, 0x3D, 0x6F, 0x84, 0x91, 
		0x98, 0xC4, 0x99, 0x62, 0x09, 0x16, 0x6D, 0x9B, 0xFC, 0x97, 0x3C, 0x36, 0x1C, 0xC8, 0x26, 0xE1
	},
	1,{0x03},{0x09,0x12,0x31},
	{0xF0, 0x6E, 0xCC, 0x6D, 0x2A, 0xAE, 0xBF, 0x25, 0x9B, 0x7E, 0x75, 0x5A, 0x38, 0xD9, 0xA9, 0xB2, 
		0x4E, 0x2F, 0xF3, 0xDD}
	};
	// =============== Added end ==============================//

	// Mastercard 1152 bits Live Key 04
	EMV_CAPK capk_mastercard_v04={{0xA0,0x00,0x00,0x00,0x04},0x04,
	0x01,0x01,144,
	{0xA6,0xDA,0x42,0x83,0x87,0xA5,0x02,0xD7,0xDD,0xFB,0x7A,0x74,0xD3,0xF4,0x12,0xBE,
	0x76,0x26,0x27,0x19,0x7B,0x25,0x43,0x5B,0x7A,0x81,0x71,0x6A,0x70,0x01,0x57,0xDD,
	0xD0,0x6F,0x7C,0xC9,0x9D,0x6C,0xA2,0x8C,0x24,0x70,0x52,0x7E,0x2C,0x03,0x61,0x6B,
	0x9C,0x59,0x21,0x73,0x57,0xC2,0x67,0x4F,0x58,0x3B,0x3B,0xA5,0xC7,0xDC,0xF2,0x83,
	0x86,0x92,0xD0,0x23,0xE3,0x56,0x24,0x20,0xB4,0x61,0x5C,0x43,0x9C,0xA9,0x7C,0x44,
	0xDC,0x9A,0x24,0x9C,0xFC,0xE7,0xB3,0xBF,0xB2,0x2F,0x68,0x22,0x8C,0x3A,0xF1,0x33,
	0x29,0xAA,0x4A,0x61,0x3C,0xF8,0xDD,0x85,0x35,0x02,0x37,0x3D,0x62,0xE4,0x9A,0xB2,
	0x56,0xD2,0xBC,0x17,0x12,0x0E,0x54,0xAE,0xDC,0xED,0x6D,0x96,0xA4,0x28,0x7A,0xCC,
	0x5C,0x04,0x67,0x7D,0x4A,0x5A,0x32,0x0D,0xB8,0xBE,0xE2,0xF7,0x75,0xE5,0xFE,0xC5},
	1,{0x03},{0x20,0x12,0x30},
	{0x38,0x1A,0x03,0x5D,0xA5,0x8B,0x48,0x2E,0xE2,0xAF,0x75,0xF4,0xC3,0xF2,0xCA,0x46,
	0x9B,0xA4,0xAA,0x6C}
	};

	// Mastercard 1408 bits live Key 05
	EMV_CAPK capk_mastercard_v05 = {{0xA0,0x00,0x00,0x00,0x04},0x05,
	0x01,0x01,176,
	{0xB8,0x04,0x8A,0xBC,0x30,0xC9,0x0D,0x97,0x63,0x36,0x54,0x3E,0x3F,0xD7,0x09,0x1C,
	0x8F,0xE4,0x80,0x0D,0xF8,0x20,0xED,0x55,0xE7,0xE9,0x48,0x13,0xED,0x00,0x55,0x5B,
	0x57,0x3F,0xEC,0xA3,0xD8,0x4A,0xF6,0x13,0x1A,0x65,0x1D,0x66,0xCF,0xF4,0x28,0x4F,
	0xB1,0x3B,0x63,0x5E,0xDD,0x0E,0xE4,0x01,0x76,0xD8,0xBF,0x04,0xB7,0xFD,0x1C,0x7B,
	0xAC,0xF9,0xAC,0x73,0x27,0xDF,0xAA,0x8A,0xA7,0x2D,0x10,0xDB,0x3B,0x8E,0x70,0xB2,
	0xDD,0xD8,0x11,0xCB,0x41,0x96,0x52,0x5E,0xA3,0x86,0xAC,0xC3,0x3C,0x0D,0x9D,0x45,
	0x75,0x91,0x64,0x69,0xC4,0xE4,0xF5,0x3E,0x8E,0x1C,0x91,0x2C,0xC6,0x18,0xCB,0x22,
	0xDD,0xE7,0xC3,0x56,0x8E,0x90,0x02,0x2E,0x6B,0xBA,0x77,0x02,0x02,0xE4,0x52,0x2A,
	0x2D,0xD6,0x23,0xD1,0x80,0xE2,0x15,0xBD,0x1D,0x15,0x07,0xFE,0x3D,0xC9,0x0C,0xA3,
	0x10,0xD2,0x7B,0x3E,0xFC,0xCD,0x8F,0x83,0xDE,0x30,0x52,0xCA,0xD1,0xE4,0x89,0x38,
	0xC6,0x8D,0x09,0x5A,0xAC,0x91,0xB5,0xF3,0x7E,0x28,0xBB,0x49,0xEC,0x7E,0xD5,0x97},
	1,{0x03},{0x20,0x12,0x31},
	{0xEB,0xFA,0x0D,0x5D,0x06,0xD8,0xCE,0x70,0x2D,0xA3,0xEA,0xE8,0x90,0x70,0x1D,0x45,
	0xE2,0x74,0xC8,0x45}
	};
	
	// Mastercard 1948 bits live Key 06
	EMV_CAPK capk_mastercard_v06 = {{0xA0,0x00,0x00,0x00,0x04},0x06,
	0x01,0x01,248,
	{0xCB,0x26,0xFC,0x83,0x0B,0x43,0x78,0x5B,0x2B,0xCE,0x37,0xC8,0x1E,0xD3,0x34,0x62,
	0x2F,0x96,0x22,0xF4,0xC8,0x9A,0xAE,0x64,0x10,0x46,0xB2,0x35,0x34,0x33,0x88,0x3F,
	0x30,0x7F,0xB7,0xC9,0x74,0x16,0x2D,0xA7,0x2F,0x7A,0x4E,0xC7,0x5D,0x9D,0x65,0x73,
	0x36,0x86,0x5B,0x8D,0x30,0x23,0xD3,0xD6,0x45,0x66,0x76,0x25,0xC9,0xA0,0x7A,0x6B,
	0x7A,0x13,0x7C,0xF0,0xC6,0x41,0x98,0xAE,0x38,0xFC,0x23,0x80,0x06,0xFB,0x26,0x03,
	0xF4,0x1F,0x4F,0x3B,0xB9,0xDA,0x13,0x47,0x27,0x0F,0x2F,0x5D,0x8C,0x60,0x6E,0x42,
	0x09,0x58,0xC5,0xF7,0xD5,0x0A,0x71,0xDE,0x30,0x14,0x2F,0x70,0xDE,0x46,0x88,0x89,
	0xB5,0xE3,0xA0,0x86,0x95,0xB9,0x38,0xA5,0x0F,0xC9,0x80,0x39,0x3A,0x9C,0xBC,0xE4,
	0x4A,0xD2,0xD6,0x4F,0x63,0x0B,0xB3,0x3A,0xD3,0xF5,0xF5,0xFD,0x49,0x5D,0x31,0xF3,
	0x78,0x18,0xC1,0xD9,0x40,0x71,0x34,0x2E,0x07,0xF1,0xBE,0xC2,0x19,0x4F,0x60,0x35,
	0xBA,0x5D,0xED,0x39,0x36,0x50,0x0E,0xB8,0x2D,0xFD,0xA6,0xE8,0xAF,0xB6,0x55,0xB1,
	0xEF,0x3D,0x0D,0x7E,0xBF,0x86,0xB6,0x6D,0xD9,0xF2,0x9F,0x6B,0x1D,0x32,0x4F,0xE8,
	0xB2,0x6C,0xE3,0x8A,0xB2,0x01,0x3D,0xD1,0x3F,0x61,0x1E,0x7A,0x59,0x4D,0x67,0x5C,
	0x44,0x32,0x35,0x0E,0xA2,0x44,0xCC,0x34,0xF3,0x87,0x3C,0xBA,0x06,0x59,0x29,0x87,
	0xA1,0xD7,0xE8,0x52,0xAD,0xC2,0x2E,0xF5,0xA2,0xEE,0x28,0x13,0x20,0x31,0xE4,0x8F,
	0x74,0x03,0x7E,0x3B,0x34,0xAB,0x74,0x7F},
	1,{0x03},{0x20,0x12,0x30},
	{0xF9,0x10,0xA1,0x50,0x4D,0x5F,0xFB,0x79,0x3D,0x94,0xF3,0xB5,0x00,0x76,0x5E,0x1A,
	0xBC,0xAD,0x72,0xD9}
	};
	
	EMV_CAPK capk_amex_live03={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x03,
	0x01, 0x01, 0x80,
	{0xB0, 0xC2, 0xC6, 0xE2, 0xA6, 0x38, 0x69, 0x33, 0xCD, 0x17, 0xC2, 0x39, 0x49, 0x6B, 0xF4, 0x8C,
	0x57, 0xE3, 0x89, 0x16, 0x4F, 0x2A, 0x96, 0xBF, 0xF1, 0x33, 0x43, 0x9A, 0xE8, 0xA7, 0x7B, 0x20,
	0x49, 0x8B, 0xD4, 0xDC, 0x69, 0x59, 0xAB, 0x0C, 0x2D, 0x05, 0xD0, 0x72, 0x3A, 0xF3, 0x66, 0x89,
	0x01, 0x93, 0x7B, 0x67, 0x4E, 0x5A, 0x2F, 0xA9, 0x2D, 0xDD, 0x5E, 0x78, 0xEA, 0x9D, 0x75, 0xD7,
	0x96, 0x20, 0x17, 0x3C, 0xC2, 0x69, 0xB3, 0x5F, 0x46, 0x3B, 0x3D, 0x4A, 0xAF, 0xF2, 0x79, 0x4F,
	0x92, 0xE6, 0xC7, 0xA3, 0xFB, 0x95, 0x32, 0x5D, 0x8A, 0xB9, 0x59, 0x60, 0xC3, 0x06, 0x6B, 0xE5,
	0x48, 0x08, 0x7B, 0xCB, 0x6C, 0xE1, 0x26, 0x88, 0x14, 0x4A, 0x8B, 0x4A, 0x66, 0x22, 0x8A, 0xE4,
	0x65, 0x9C, 0x63, 0x4C, 0x99, 0xE3, 0x60, 0x11, 0x58, 0x4C, 0x09, 0x50, 0x82, 0xA3, 0xA3, 0xE3},
	1,{0x03},{0x15, 0x12, 0x31},
	{0x87, 0x08, 0xA3, 0xE3, 0xBB, 0xC1, 0xBB, 0x0B, 0xE7, 0x3E, 0xBD, 0x8D, 0x19, 0xD4, 0xE5, 0xD2,
	0x01, 0x66, 0xBF, 0x6C}
	};

	// Added by Idina 2015-11-19
	// =============== AE ================================ //
	EMV_CAPK capk_amex_live04={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x04,
	0x01, 0x01, 96,
	{0xD0, 0xF5, 0x43, 0xF0, 0x3F, 0x25, 0x17, 0x13, 0x3E, 0xF2, 0xBA, 0x4A, 0x11, 0x04, 0x48, 0x67, 
		0x58, 0x63, 0x0D, 0xCF, 0xE3, 0xA8, 0x83, 0xC7, 0x7B, 0x4E, 0x48, 0x44, 0xE3, 0x9A, 0x9B, 0xD6, 
		0x36, 0x0D, 0x23, 0xE6, 0x64, 0x4E, 0x1E, 0x07, 0x1F, 0x19, 0x6D, 0xDF, 0x2E, 0x4A, 0x68, 0xB4, 
		0xA3, 0xD9, 0x3D, 0x14, 0x26, 0x8D, 0x72, 0x40, 0xF6, 0xA1, 0x4F, 0x0D, 0x71, 0x4C, 0x17, 0x82, 
		0x7D, 0x27, 0x9D, 0x19, 0x2E, 0x88, 0x93, 0x1A, 0xF7, 0x30, 0x07, 0x27, 0xAE, 0x9D, 0xA8, 0x0A, 
		0x3F, 0x0E, 0x36, 0x6A, 0xEB, 0xA6, 0x17, 0x78, 0x17, 0x17, 0x37, 0x98, 0x9E, 0x1E, 0xE3, 0x09
	},
	1,{0x03},{0x15, 0x12, 0x31},
	{0xFD, 0xD7, 0x13, 0x9E, 0xC7, 0xE0, 0xC3, 0x31, 0x67, 0xFD, 0x61, 0xAD, 0x3C, 0xAD, 0xBD, 0x68, 
		0xD6, 0x6E, 0x91, 0xC5}
	};

	EMV_CAPK capk_amex_live08={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x08,
	0x01, 0x01, 128,
	{0xB0, 0xC2, 0xC6, 0xE2, 0xA6, 0x38, 0x69, 0x33, 0xCD, 0x17, 0xC2, 0x39, 0x49, 0x6B, 0xF4, 0x8C, 
		0x57, 0xE3, 0x89, 0x16, 0x4F, 0x2A, 0x96, 0xBF, 0xF1, 0x33, 0x43, 0x9A, 0xE8, 0xA7, 0x7B, 0x20, 
		0x49, 0x8B, 0xD4, 0xDC, 0x69, 0x59, 0xAB, 0x0C, 0x2D, 0x05, 0xD0, 0x72, 0x3A, 0xF3, 0x66, 0x89, 
		0x01, 0x93, 0x7B, 0x67, 0x4E, 0x5A, 0x2F, 0xA9, 0x2D, 0xDD, 0x5E, 0x78, 0xEA, 0x9D, 0x75, 0xD7, 
		0x96, 0x20, 0x17, 0x3C, 0xC2, 0x69, 0xB3, 0x5F, 0x46, 0x3B, 0x3D, 0x4A, 0xAF, 0xF2, 0x79, 0x4F, 
		0x92, 0xE6, 0xC7, 0xA3, 0xFB, 0x95, 0x32, 0x5D, 0x8A, 0xB9, 0x59, 0x60, 0xC3, 0x06, 0x6B, 0xE5, 
		0x48, 0x08, 0x7B, 0xCB, 0x6C, 0xE1, 0x26, 0x88, 0x14, 0x4A, 0x8B, 0x4A, 0x66, 0x22, 0x8A, 0xE4, 
		0x65, 0x9C, 0x63, 0x4C, 0x99, 0xE3, 0x60, 0x11, 0x58, 0x4C, 0x09, 0x50, 0x82, 0xA3, 0xA3, 0xE3
	},
	1,{0x03},{0x15, 0x12, 0x31},
	{0xDD, 0x36, 0xD5, 0x89, 0x62, 0x28, 0xC8, 0xC4, 0x90, 0x07, 0x42, 0xF1, 0x07, 0xE2, 0xF9, 0x1F, 
		0xE5, 0x0B, 0xC7, 0xEE}
	};

	EMV_CAPK capk_amex_live62={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x62,
	0x01, 0x01, 96,
	{0xBA, 0x29, 0xDE, 0x83, 0x09, 0x0D, 0x8D, 0x5F, 0x4D, 0xFF, 0xCE, 0xB9, 0x89, 0x18, 0x99, 0x5A, 
		0x76, 0x8F, 0x41, 0xD0, 0x18, 0x3E, 0x1A, 0xCA, 0x3E, 0xF8, 0xD5, 0xED, 0x90, 0x62, 0x85, 0x3E, 
		0x40, 0x80, 0xE0, 0xD2, 0x89, 0xA5, 0xCE, 0xDD, 0x4D, 0xD9, 0x6B, 0x1F, 0xEA, 0x2C, 0x53, 0x42, 
		0x84, 0x36, 0xCE, 0x15, 0xA2, 0xA1, 0xBF, 0xE6, 0x9D, 0x46, 0x19, 0x7D, 0x3F, 0x5A, 0x79, 0xBC, 
		0xF8, 0xF4, 0x85, 0x8B, 0xFF, 0xA0, 0x4E, 0xDB, 0x07, 0xFC, 0x5B, 0xE8, 0x56, 0x0D, 0x9C, 0xE3, 
		0x8F, 0x5C, 0x3C, 0xA3, 0xC7, 0x42, 0xED, 0xFD, 0xBA, 0xE3, 0xB5, 0xE6, 0xDD, 0xA4, 0x55, 0x57
	},
	1,{0x03},{0x15, 0x12, 0x31},
	{0xCC, 0xC7, 0x30, 0x3F, 0xF2, 0x95, 0xA9, 0xF3, 0x5B, 0xA6, 0x1B, 0xD3, 0x1E, 0x27, 0xEA, 0xBD, 
		0x59, 0x65, 0x82, 0x65}
	};

	EMV_CAPK capk_amex_live64={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x64,
	0x01, 0x01, 128,
	{0xB0, 0xDD, 0x55, 0x10, 0x47, 0xDA, 0xFC, 0xD1, 0x0D, 0x9A, 0x5E, 0x33, 0xCF, 0x47, 0xA9, 0x33, 
		0x3E, 0x3B, 0x24, 0xEC, 0x57, 0xE8, 0xF0, 0x66, 0xA7, 0x2D, 0xED, 0x60, 0xE8, 0x81, 0xA8, 0xAD, 
		0x42, 0x77, 0x7C, 0x67, 0xAD, 0xDF, 0x07, 0x08, 0x04, 0x2A, 0xB9, 0x43, 0x60, 0x1E, 0xE6, 0x02, 
		0x48, 0x54, 0x0B, 0x67, 0xE0, 0x63, 0x70, 0x18, 0xEE, 0xB3, 0x91, 0x1A, 0xE9, 0xC8, 0x73, 0xDA, 
		0xD6, 0x6C, 0xB4, 0x0B, 0xC8, 0xF4, 0xDC, 0x77, 0xEB, 0x25, 0x95, 0x25, 0x2B, 0x61, 0xC2, 0x15, 
		0x18, 0xF7, 0x9B, 0x70, 0x6A, 0xAC, 0x29, 0xE7, 0xD3, 0xFD, 0x4D, 0x25, 0x9D, 0xB7, 0x2B, 0x6E, 
		0x6D, 0x44, 0x6D, 0xD6, 0x03, 0x86, 0xDB, 0x40, 0xF5, 0xFD, 0xB0, 0x76, 0xD8, 0x03, 0x74, 0xC9, 
		0x93, 0xB4, 0xBB, 0x2D, 0x1D, 0xB9, 0x77, 0xC3, 0x87, 0x08, 0x97, 0xF9, 0xDF, 0xA4, 0x54, 0xF5
		},
	1,{0x03},{0x15, 0x12, 0x31},
	{0x79, 0x2B, 0x12, 0x1D, 0x86, 0xD0, 0xF3, 0xA9, 0x95, 0x82, 0xDB, 0x06, 0x97, 0x44, 0x81, 0xF3, 
		0xB2, 0xE1, 0x84, 0x54}
	};

	EMV_CAPK capk_amex_live65={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x65,
	0x01, 0x01, 144,
	{0xE5, 0x3E, 0xB4, 0x1F, 0x83, 0x9D, 0xDF, 0xB4, 0x74, 0xF2, 0x72, 0xCD, 0x0C, 0xBE, 0x37, 0x3D, 
		0x54, 0x68, 0xEB, 0x3F, 0x50, 0xF3, 0x9C, 0x95, 0xBD, 0xF4, 0xD3, 0x9F, 0xA8, 0x2B, 0x98, 0xDA, 
		0xBC, 0x94, 0x76, 0xB6, 0xEA, 0x35, 0x0C, 0x0D, 0xCE, 0x1C, 0xD9, 0x20, 0x75, 0xD8, 0xC4, 0x4D, 
		0x1E, 0x57, 0x28, 0x31, 0x90, 0xF9, 0x6B, 0x35, 0x37, 0xD9, 0xE6, 0x32, 0xC4, 0x61, 0x81, 0x5E, 
		0xBD, 0x2B, 0xAF, 0x36, 0x89, 0x1D, 0xF6, 0xBF, 0xB1, 0xD3, 0x0F, 0xA0, 0xB7, 0x52, 0xC4, 0x3D, 
		0xCA, 0x02, 0x57, 0xD3, 0x5D, 0xFF, 0x4C, 0xCF, 0xC9, 0x8F, 0x84, 0x19, 0x8D, 0x51, 0x52, 0xEC, 
		0x61, 0xD7, 0xB5, 0xF7, 0x4B, 0xD0, 0x93, 0x83, 0xBD, 0x0E, 0x2A, 0xA4, 0x22, 0x98, 0xFF, 0xB0, 
		0x2F, 0x0D, 0x79, 0xAD, 0xB7, 0x0D, 0x72, 0x24, 0x3E, 0xE5, 0x37, 0xF7, 0x55, 0x36, 0xA8, 0xA8, 
		0xDF, 0x96, 0x25, 0x82, 0xE9, 0xE6, 0x81, 0x2F, 0x3A, 0x0B, 0xE0, 0x2A, 0x43, 0x65, 0x40, 0x0D
		},
	1,{0x03},{0x15, 0x12, 0x31},
	{0x89, 0x4C, 0x5D, 0x08, 0xD4, 0xEA, 0x28, 0xBB, 0x79, 0xDC, 0x46, 0xCE, 0xAD, 0x99, 0x8B, 0x87, 
		0x73, 0x22, 0xF4, 0x16}

	};

	EMV_CAPK capk_amex_live66={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x66,
		0x01, 0x01, 128,
		{0xBD, 0x14, 0x78, 0x87, 0x7B, 0x93, 0x33, 0x61, 0x2D, 0x25, 0x7D, 0x9E, 0x3C, 0x9C, 0x23, 0x50, 
			0x3E, 0x28, 0x33, 0x6B, 0x72, 0x3C, 0x71, 0xF4, 0x7C, 0x25, 0x83, 0x66, 0x70, 0x39, 0x53, 0x60, 
			0xF5, 0x3C, 0x10, 0x6F, 0xD7, 0x4D, 0xEE, 0xEA, 0x29, 0x12, 0x59, 0xC0, 0x01, 0xAF, 0xBE, 0x7B, 
			0x4A, 0x83, 0x65, 0x4F, 0x6E, 0x2D, 0x9E, 0x81, 0x48, 0xE2, 0xCB, 0x1D, 0x92, 0x23, 0xAC, 0x59, 
			0x03, 0xDA, 0x18, 0xB4, 0x33, 0xF8, 0xE3, 0x52, 0x92, 0x27, 0x50, 0x5D, 0xE8, 0x47, 0x48, 0xF2, 
			0x41, 0xF7, 0xBF, 0xCD, 0x21, 0x46, 0xE5, 0xE9, 0xA8, 0xC5, 0xD2, 0xA0, 0x6D, 0x19, 0x09, 0x70, 
			0x87, 0xA0, 0x69, 0xF9, 0xAE, 0x3D, 0x61, 0x0C, 0x7C, 0x8E, 0x12, 0x14, 0x48, 0x1A, 0x4F, 0x27, 
			0x02, 0x5A, 0x1A, 0x2E, 0xDB, 0x8A, 0x9C, 0xDA, 0xFA, 0x44, 0x56, 0x90, 0x51, 0x1D, 0xB8, 0x05
			},
		1,{0x03},{0x15, 0x12, 0x31},
		{0xF3, 0x67, 0xCB, 0x70, 0xF9, 0xC9, 0xB6, 0x7B, 0x58, 0x0F, 0x53, 0x38, 0x19, 0xE3, 0x02, 0xBA, 
			0xC0, 0x33, 0x00, 0x90}
	};

	EMV_CAPK capk_amex_live67={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x67,
		0x01, 0x01, 176,
		{0xC6, 0x87, 0xAD, 0xCC, 0xF3, 0xD5, 0x7D, 0x33, 0x60, 0xB1, 0x74, 0xE4, 0x71, 0xED, 0xA6, 0x93, 
			0xAA, 0x55, 0x5D, 0xFD, 0xC6, 0xC8, 0xCD, 0x39, 0x4C, 0x74, 0xBA, 0x25, 0xCC, 0xDF, 0x8E, 0xAB, 
			0xFD, 0x1F, 0x1C, 0xEA, 0xDF, 0xBE, 0x22, 0x80, 0xC9, 0xE8, 0x1F, 0x7A, 0x05, 0x89, 0x98, 0xDC, 
			0x22, 0xB7, 0xF2, 0x25, 0x76, 0xFE, 0x84, 0x71, 0x3D, 0x0B, 0xDD, 0x3D, 0x34, 0xCF, 0xCD, 0x12, 
			0xFC, 0xD0, 0xD2, 0x69, 0x01, 0xBA, 0x74, 0x10, 0x3D, 0x07, 0x5C, 0x66, 0x4D, 0xAB, 0xCC, 0xAF, 
			0x57, 0xBF, 0x78, 0x94, 0x94, 0x05, 0x1C, 0x5E, 0xC3, 0x03, 0xA2, 0xE1, 0xD7, 0x84, 0x30, 0x6D, 
			0x3D, 0xB3, 0xEB, 0x66, 0x5C, 0xD3, 0x60, 0xA5, 0x58, 0xF4, 0x0B, 0x7C, 0x05, 0xC9, 0x19, 0xB2, 
			0xF0, 0x28, 0x2F, 0xE1, 0xED, 0x9B, 0xF6, 0x26, 0x1A, 0xA8, 0x14, 0x64, 0x8F, 0xBC, 0x26, 0x3B, 
			0x14, 0x21, 0x44, 0x91, 0xDE, 0x42, 0x6D, 0x24, 0x2D, 0x65, 0xCD, 0x1F, 0xFF, 0x0F, 0xBE, 0x4D, 
			0x4D, 0xAF, 0xF5, 0xCF, 0xAC, 0xB2, 0xAD, 0xC7, 0x13, 0x1C, 0x9B, 0x14, 0x7E, 0xE7, 0x91, 0x95, 
			0x65, 0x51, 0x07, 0x62, 0x70, 0x69, 0x6B, 0x75, 0xFD, 0x97, 0x37, 0x3F, 0x1F, 0xD7, 0x80, 0x4F
			},
		1,{0x03},{0x15, 0x12, 0x31},
		{0x52, 0xA2, 0x90, 0x73, 0x00, 0xC8, 0x44, 0x5B, 0xF5, 0x4B, 0x97, 0x0C, 0x89, 0x46, 0x91, 0xFE, 
			0xAD, 0xF2, 0xD2, 0x8E}
	};

	EMV_CAPK capk_amex_live97={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x97,
		0x01, 0x01, 144,
		{0xE1, 0x78, 0xFF, 0xE8, 0x34, 0xB4, 0xB7, 0x67, 0xAF, 0x3C, 0x9A, 0x51, 0x1F, 0x97, 0x3D, 0x8E, 
			0x85, 0x05, 0xC5, 0xFC, 0xB2, 0xD3, 0x76, 0x80, 0x75, 0xAB, 0x7C, 0xC9, 0x46, 0xA9, 0x55, 0x78, 
			0x99, 0x55, 0x87, 0x9A, 0xAF, 0x73, 0x74, 0x07, 0x15, 0x15, 0x21, 0x99, 0x6D, 0xFA, 0x43, 0xC5, 
			0x8E, 0x6B, 0x13, 0x0E, 0xB1, 0xD8, 0x63, 0xB8, 0x5D, 0xC9, 0xFF, 0xB4, 0x05, 0x09, 0x47, 0xA6, 
			0x76, 0xAA, 0x6A, 0x06, 0x1A, 0x4A, 0x7A, 0xE1, 0xED, 0xB0, 0xE3, 0x6A, 0x69, 0x7E, 0x87, 0xE0, 
			0x37, 0x51, 0x7E, 0xB8, 0x92, 0x31, 0x36, 0x87, 0x5B, 0xA2, 0xCA, 0x10, 0x87, 0xCB, 0xA7, 0xEC, 
			0x76, 0x53, 0xE5, 0xE2, 0x8A, 0x0C, 0x26, 0x1A, 0x03, 0x3A, 0xF2, 0x7E, 0x3A, 0x67, 0xB6, 0x4B, 
			0xBA, 0x26, 0x95, 0x63, 0x07, 0xEC, 0x47, 0xE6, 0x74, 0xE3, 0xF8, 0xB7, 0x22, 0xB3, 0xAE, 0x49, 
			0x8D, 0xB1, 0x6C, 0x79, 0x85, 0x31, 0x0D, 0x9F, 0x3D, 0x11, 0x73, 0x00, 0xD3, 0x2B, 0x09},
		1,{0x03},{0x15, 0x12, 0x31},
		{0xEB, 0xDA, 0x52, 0x2B, 0x63, 0x1B, 0x3E, 0xB4, 0xF4, 0xCB, 0xFC, 0x06, 0x79, 0xC4, 0x50, 0x13, 
			0x9D, 0x2B, 0x69, 0xCD}
	};

	EMV_CAPK capk_amex_live98={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x98,
		0x01, 0x01, 176,
		{0xD3, 0x1A, 0x70, 0x94, 0xFB, 0x22, 0x1C, 0xBA, 0x66, 0x60, 0xFB, 0x97, 0x5A, 0xAF, 0xEA, 0x80, 
			0xDB, 0x7B, 0xB7, 0xEA, 0xFD, 0x73, 0x51, 0xE7, 0x48, 0x82, 0x7A, 0xB6, 0x2D, 0x4A, 0xEE, 0xCC, 
			0xFC, 0x17, 0x87, 0xFD, 0x47, 0xA0, 0x46, 0x99, 0xA0, 0x2D, 0xB0, 0x0D, 0x7C, 0x38, 0x2E, 0x80, 
			0xE8, 0x04, 0xB3, 0x5C, 0x59, 0x43, 0x4C, 0x60, 0x23, 0x89, 0xD6, 0x91, 0xB9, 0xCC, 0xD5, 0x1D, 
			0x06, 0xBE, 0x67, 0xA2, 0x76, 0x11, 0x9C, 0x4C, 0x10, 0xE2, 0xE4, 0x0F, 0xC4, 0xED, 0xDF, 0x9D, 
			0xF3, 0x9B, 0x9B, 0x0B, 0xDE, 0xE8, 0xD0, 0x76, 0xE2, 0xA0, 0x12, 0xE8, 0xA2, 0x92, 0xAF, 0x8E, 
			0xFE, 0x18, 0x55, 0x34, 0x70, 0x63, 0x9C, 0x1A, 0x03, 0x22, 0x52, 0xE0, 0xE5, 0x74, 0x8B, 0x25, 
			0xA3, 0xF9, 0xBA, 0x4C, 0xFC, 0xEE, 0x07, 0x30, 0x38, 0xB0, 0x61, 0x83, 0x7F, 0x2A, 0xC1, 0x04, 
			0xC2, 0x79, 0x64, 0x0F, 0x5B, 0xD1, 0x10, 0xA9, 0xDC, 0x66, 0x5E, 0xD2, 0xFA, 0x68, 0x28, 0xBD, 
			0x5D, 0x0F, 0xE8, 0x10, 0xA8, 0x92, 0xDE, 0xE6, 0xB0, 0xE7, 0x4C, 0xE8, 0x86, 0x3B, 0xDE, 0x08, 
			0xFD, 0x5F, 0xD6, 0x1A, 0x0F, 0x11, 0xFA, 0x0D, 0x14, 0x97, 0x8D, 0x8C, 0xED, 0x7D, 0xD3},
		1,{0x03},{0x20, 0x12, 0x31},
		{0xD4, 0xDB, 0xA4, 0x28, 0xCF, 0x11, 0xD4, 0x5B, 0xAE, 0xB0, 0xA3, 0x5C, 0xAE, 0xA8, 0x00, 0x7A, 
			0xD8, 0xBA, 0x8D, 0x71}
	};

	EMV_CAPK capk_amex_live99={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x99,
		0x01, 0x01, 248,
		{0xE1, 0x74, 0x00, 0x74, 0x22, 0x9F, 0xA0, 0xD2, 0x28, 0xA9, 0x62, 0x35, 0x81, 0xD7, 0xA3, 0x22, 
			0x90, 0x3F, 0xB8, 0x9B, 0xA7, 0x68, 0x67, 0x12, 0xE6, 0x01, 0xFA, 0x8A, 0xB2, 0x4A, 0x97, 0x89, 
			0x18, 0x6F, 0x15, 0xB7, 0x0C, 0xCB, 0xBE, 0x74, 0x21, 0xB1, 0xCB, 0x11, 0x0D, 0x45, 0x36, 0x16, 
			0x88, 0x13, 0x5F, 0xFD, 0x0D, 0xB1, 0x5A, 0x3F, 0x51, 0x6B, 0xB2, 0x91, 0xD4, 0xA1, 0x23, 0xEB, 
			0xF5, 0xA0, 0x6F, 0xBF, 0x7E, 0x1E, 0xE6, 0x31, 0x1B, 0x73, 0x7D, 0xAB, 0xB2, 0x89, 0x57, 0x0A, 
			0x79, 0x59, 0xD5, 0x32, 0xB2, 0x5F, 0x1D, 0xA6, 0x75, 0x8C, 0x84, 0xDD, 0xCC, 0xAD, 0xC0, 0x49, 
			0xBC, 0x76, 0x4C, 0x05, 0x39, 0x1A, 0xBD, 0x2C, 0xAD, 0xEF, 0xFA, 0x7E, 0x24, 0x2D, 0x5D, 0xD0, 
			0x6E, 0x56, 0x00, 0x1F, 0x0E, 0x68, 0x15, 0x1E, 0x33, 0x88, 0x07, 0x4B, 0xD9, 0x33, 0x0D, 0x6A, 
			0xFA, 0x57, 0xCB, 0xF3, 0x39, 0x46, 0xF5, 0x31, 0xE5, 0x1E, 0x0D, 0x49, 0x02, 0xEE, 0x23, 0x5C, 
			0x75, 0x6A, 0x90, 0x5F, 0xB7, 0x33, 0x94, 0x0E, 0x6E, 0xC8, 0x97, 0xB4, 0x94, 0x4A, 0x5E, 0xDC, 
			0x76, 0x57, 0x05, 0xE2, 0xAC, 0xF7, 0x6C, 0x78, 0xEA, 0xD7, 0x8D, 0xD9, 0xB0, 0x66, 0xDF, 0x0B, 
			0x2C, 0x88, 0x75, 0x0B, 0x8A, 0xEE, 0x00, 0xC9, 0xB4, 0xD4, 0x09, 0x1F, 0xA7, 0x33, 0x84, 0x49, 
			0xDA, 0x92, 0xDB, 0xFC, 0x90, 0x8F, 0xA0, 0x78, 0x1C, 0x01, 0x28, 0xC4, 0x92, 0xDB, 0x99, 0x3C, 
			0x88, 0xBA, 0x8B, 0xB7, 0xCA, 0xDF, 0xE2, 0x38, 0xD4, 0x77, 0xF2, 0x51, 0x7E, 0x0E, 0x7E, 0x3D, 
			0x2B, 0x11, 0x79, 0x6A, 0x03, 0x18, 0xCE, 0x2A, 0xD4, 0xDA, 0x1D, 0xB8, 0xE5, 0x4A, 0xB0, 0xD9, 
			0x4F, 0x10, 0x9D, 0xB9, 0xCA, 0xEE, 0xFB, 0xEF},
		1,{0x03},{0x20, 0x12, 0x31},
		{0x94, 0x79, 0x0D, 0x02, 0x0F, 0x4F, 0x69, 0x2D, 0x59, 0x28, 0x9F, 0x36, 0x45, 0x18, 0x72, 0x07, 
			0x80, 0x05, 0xB6, 0x3B}
	};

	EMV_CAPK capk_amex_liveA1={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xA1,
		0x01, 0x01, 176,
		{0xA1, 0x1A, 0x7A, 0x12, 0x9E, 0x15, 0xAD, 0x81, 0x2D, 0x5E, 0x18, 0x2D, 0x18, 0x73, 0xA0, 0x22, 
			0xD0, 0x01, 0x4D, 0x50, 0x60, 0xCE, 0xDC, 0x07, 0xBB, 0x4E, 0x9F, 0x42, 0xD2, 0xBE, 0x99, 0x5F, 
			0x40, 0x26, 0xA3, 0xC5, 0xC8, 0xB7, 0x27, 0xD5, 0x60, 0xC4, 0x01, 0x13, 0x14, 0x27, 0xA7, 0x6D, 
			0xDD, 0x23, 0xE4, 0x2B, 0xF9, 0x07, 0x8A, 0xB9, 0xAE, 0x95, 0x40, 0x74, 0x08, 0xDB, 0x89, 0x20, 
			0x03, 0xF3, 0x3B, 0x7D, 0xD9, 0xB0, 0x62, 0x05, 0xC7, 0xD9, 0x36, 0x18, 0x39, 0x1B, 0x47, 0x72, 
			0x64, 0x54, 0xE7, 0xB9, 0x78, 0xC9, 0xAD, 0x67, 0x74, 0xB9, 0xB8, 0xB8, 0x40, 0x77, 0x48, 0x93, 
			0xD2, 0x51, 0x66, 0x6B, 0xD1, 0xA9, 0x61, 0xB0, 0x61, 0x52, 0xE7, 0xD0, 0x9A, 0xA0, 0xA6, 0x0B, 
			0x9F, 0x3B, 0xC4, 0x75, 0x37, 0x01, 0xB4, 0x31, 0x16, 0x6F, 0x28, 0x5C, 0xE0, 0x87, 0x3C, 0xD8, 
			0x11, 0x28, 0xE0, 0xA4, 0xF5, 0x6D, 0x58, 0x73, 0x3E, 0x98, 0xEC, 0x62, 0x4F, 0x98, 0xA7, 0xA8, 
			0x1D, 0x40, 0x39, 0x00, 0xD0, 0xE2, 0xF6, 0x15, 0x28, 0x5D, 0x0C, 0xAE, 0xEC, 0x5E, 0xDC, 0xED, 
			0x4E, 0xDE, 0xAC, 0x62, 0xE3, 0x90, 0x78, 0xAC, 0xF8, 0xF2, 0x96, 0x6D, 0x70, 0x10, 0x1C, 0xAD
			},
		1,{0x03},{0x15, 0x12, 0x31},
		{0x50, 0xD9, 0xE2, 0x95, 0xD8, 0x0E, 0xF1, 0x93, 0xA0, 0x3C, 0xA4, 0x01, 0xF0, 0x4F, 0xE3, 0x39, 
			0x4B, 0x9C, 0xFF, 0x1E}
	};

	EMV_CAPK capk_amex_liveC1={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xC1,
		0x01, 0x01, 144,
		{0xE6, 0x9E, 0x31, 0x9C, 0x34, 0xD1, 0xB4, 0xFB, 0x43, 0xAE, 0xD4, 0xBD, 0x8B, 0xBA, 0x6F, 0x7A, 
			0x8B, 0x76, 0x3F, 0x2F, 0x6E, 0xE5, 0xDD, 0xF7, 0xC9, 0x25, 0x79, 0xA9, 0x84, 0xF8, 0x9C, 0x4A, 
			0x9C, 0x15, 0xB2, 0x70, 0x37, 0x76, 0x4C, 0x58, 0xAC, 0x7E, 0x45, 0xEF, 0xBC, 0x34, 0xE1, 0x38, 
			0xE5, 0x6B, 0xA3, 0x8F, 0x76, 0xE8, 0x03, 0x12, 0x9A, 0x8D, 0xDE, 0xB5, 0xE1, 0xCC, 0x8C, 0x6B, 
			0x30, 0xCF, 0x63, 0x4A, 0x9C, 0x9C, 0x12, 0x24, 0xBF, 0x1F, 0x0A, 0x9A, 0x18, 0xD7, 0x9E, 0xD4, 
			0x1E, 0xBC, 0xF1, 0xBE, 0x78, 0x08, 0x7A, 0xE8, 0xB7, 0xD2, 0xF8, 0x96, 0xB1, 0xDE, 0x8B, 0x7E, 
			0x78, 0x41, 0x61, 0xA1, 0x38, 0xA0, 0xF2, 0x16, 0x9A, 0xD3, 0x3E, 0x14, 0x6D, 0x1B, 0x16, 0xAB, 
			0x59, 0x5F, 0x9D, 0x7D, 0x98, 0xBE, 0x67, 0x10, 0x62, 0xD2, 0x17, 0xF4, 0x4E, 0xB6, 0x8C, 0x68, 
			0x64, 0x0C, 0x7D, 0x57, 0x46, 0x5A, 0x06, 0x3F, 0x6B, 0xAC, 0x77, 0x6D, 0x3E, 0x2D, 0xAC, 0x61
			},
		1,{0x03},{0x22, 0x12, 0x31},
		{0xDC, 0x79, 0xD6, 0xB5, 0xFC, 0x87, 0x93, 0x62, 0x29, 0x9B, 0xC5, 0xA6, 0x37, 0xDA, 0xD2, 0xE0, 
			0xD9, 0x96, 0x56, 0xB8}
	};

	EMV_CAPK capk_amex_liveC2={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xC2,
		0x01, 0x01, 176,
		{0xB8, 0x75, 0x00, 0x2F, 0x38, 0xBA, 0x26, 0xD6, 0x11, 0x67, 0xC5, 0xD4, 0x40, 0x36, 0x76, 0x04, 
			0xAD, 0x38, 0xDF, 0x2E, 0x93, 0xD8, 0xEE, 0x8D, 0xA0, 0xE8, 0xD9, 0xC0, 0xCF, 0x4C, 0xC5, 0x78, 
			0x8D, 0x11, 0xDE, 0xA6, 0x89, 0xE5, 0xF4, 0x1D, 0x23, 0xA3, 0xDA, 0x3E, 0x0B, 0x1F, 0xA5, 0x87, 
			0x5A, 0xE2, 0x56, 0x20, 0xF5, 0xA6, 0xBC, 0xCE, 0xE0, 0x98, 0xC1, 0xB3, 0x5C, 0x69, 0x18, 0x89, 
			0xD7, 0xD0, 0xEF, 0x67, 0x0E, 0xB8, 0x31, 0x2E, 0x71, 0x23, 0xFC, 0xC5, 0xDC, 0x7D, 0x2F, 0x07, 
			0x19, 0xCC, 0x80, 0xE1, 0xA9, 0x30, 0x17, 0xF9, 0x44, 0xD0, 0x97, 0x33, 0x0E, 0xDF, 0x94, 0x57, 
			0x62, 0xFE, 0xE6, 0x2B, 0x7B, 0x0B, 0xA0, 0x34, 0x82, 0x28, 0xDB, 0xF3, 0x8D, 0x42, 0x16, 0xE5, 
			0xA6, 0x7A, 0x7E, 0xF7, 0x4F, 0x5D, 0x31, 0x11, 0xC4, 0x4A, 0xA3, 0x13, 0x20, 0xF6, 0x23, 0xCB, 
			0x3C, 0x53, 0xE6, 0x09, 0x66, 0xD6, 0x92, 0x00, 0x67, 0xC9, 0xE0, 0x82, 0xB7, 0x46, 0x11, 0x7E, 
			0x48, 0xE4, 0xF0, 0x0E, 0x11, 0x09, 0x50, 0xCA, 0x54, 0xDA, 0x3E, 0x38, 0xE5, 0x45, 0x3B, 0xD5, 
			0x54, 0x4E, 0x3A, 0x67, 0x60, 0xE3, 0xA6, 0xA4, 0x27, 0x66, 0xAD, 0x22, 0x84, 0xE0, 0xC9, 0xAF
			},
		1,{0x03},{0x22, 0x12, 0x31},
		{0x8E, 0x74, 0x82, 0x96, 0x35, 0x9A, 0x74, 0x28, 0xF5, 0x36, 0xAD, 0xDA, 0x8E, 0x2C, 0x03, 0x7E, 
			0x2B, 0x69, 0x7E, 0xF6}
	};

	EMV_CAPK capk_amex_liveC3={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xC3,
		0x01, 0x01, 248,
		{0xB9, 0x31, 0x82, 0xAB, 0xE3, 0x43, 0xDF, 0xBF, 0x38, 0x8C, 0x71, 0xC4, 0xD6, 0x74, 0x7D, 0xCD, 
			0xEC, 0x60, 0x36, 0x7F, 0xE6, 0x3C, 0xFA, 0xA9, 0x42, 0xD7, 0xD3, 0x23, 0xE6, 0x88, 0xD0, 0x83, 
			0x28, 0x36, 0x54, 0x8B, 0xF0, 0xED, 0xFF, 0x1E, 0xDE, 0xEB, 0x88, 0x2C, 0x75, 0x09, 0x9F, 0xF8, 
			0x1A, 0x93, 0xFA, 0x52, 0x5C, 0x32, 0x42, 0x5B, 0x36, 0x02, 0x3E, 0xA0, 0x2A, 0x88, 0x99, 0xB9, 
			0xBF, 0x7D, 0x79, 0x34, 0xE8, 0x6F, 0x99, 0x78, 0x91, 0x82, 0x30, 0x06, 0xCE, 0xAA, 0x93, 0x09, 
			0x1A, 0x73, 0xC1, 0xFD, 0xE1, 0x8A, 0xBD, 0x4F, 0x87, 0xA2, 0x23, 0x08, 0x64, 0x0C, 0x06, 0x4C, 
			0x8C, 0x02, 0x76, 0x85, 0xF1, 0xB2, 0xDB, 0x7B, 0x74, 0x1B, 0x67, 0xAB, 0x0D, 0xE0, 0x5E, 0x87, 
			0x04, 0x81, 0xC5, 0xF9, 0x72, 0x50, 0x8C, 0x17, 0xF5, 0x7E, 0x4F, 0x83, 0x3D, 0x63, 0x22, 0x0F, 
			0x6E, 0xA2, 0xCF, 0xBB, 0x87, 0x87, 0x28, 0xAA, 0x58, 0x87, 0xDE, 0x40, 0x7D, 0x10, 0xC6, 0xB8, 
			0xF5, 0x8D, 0x46, 0x77, 0x9E, 0xCE, 0xC1, 0xE2, 0x15, 0x54, 0x87, 0xD5, 0x2C, 0x78, 0xA5, 0xC0, 
			0x38, 0x97, 0xF2, 0xBB, 0x58, 0x0E, 0x0A, 0x2B, 0xBD, 0xE8, 0xEA, 0x2E, 0x1C, 0x18, 0xF6, 0xAA, 
			0xF3, 0xEB, 0x3D, 0x04, 0xC3, 0x47, 0x7D, 0xEA, 0xB8, 0x8F, 0x15, 0x0C, 0x88, 0x10, 0xFD, 0x1E, 
			0xF8, 0xEB, 0x05, 0x96, 0x86, 0x63, 0x36, 0xFE, 0x2C, 0x1F, 0xBC, 0x6B, 0xEC, 0x22, 0xB4, 0xFE, 
			0x5D, 0x88, 0x56, 0x47, 0x72, 0x6D, 0xB5, 0x97, 0x09, 0xA5, 0x05, 0xF7, 0x5C, 0x49, 0xE0, 0xD8, 
			0xD7, 0x1B, 0xF5, 0x1E, 0x41, 0x81, 0x21, 0x2B, 0xE2, 0x14, 0x2A, 0xB2, 0xA1, 0xE8, 0xC0, 0xD3, 
			0xB7, 0x13, 0x6C, 0xD7, 0xB7, 0x70, 0x8E, 0x4D},
		1,{0x03},{0x22, 0x12, 0x31},
		{0x12, 0xF1, 0x79, 0x0C, 0xB0, 0x27, 0x3D, 0xC7, 0x3C, 0x6E, 0x70, 0x78, 0x4B, 0xC2, 0x4C, 0x12, 
			0xE8, 0xDB, 0x71, 0xF6}

	};


	EMV_CAPK capk_amex_liveC7={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xC7,
		0x01, 0x01, 90,
		{0xcd, 0x23, 0x7e, 0x34, 0xe0, 0x29, 0x9d, 0xe4, 0x8f, 0x1a, 0x2c, 0x94, 0xf4, 0x78, 0xfe, 0x97, 
			0x28, 0x96, 0x01, 0x1e, 0x1c, 0xa6, 0xab, 0x46, 0x2b, 0x68, 0xfe, 0x0f, 0x61, 0x09, 0xc9, 0xa9, 
			0x7c, 0x2d, 0xbe, 0xea, 0x65, 0x93, 0x2c, 0xde, 0x06, 0x25, 0x13, 0x8b, 0x9f, 0x16, 0x2b, 0x92, 
			0x97, 0x9d, 0xaa, 0xb0, 0x19, 0xd3, 0xb5, 0x56, 0x1d, 0x31, 0xeb, 0x2d, 0x4f, 0x09, 0xf1, 0x2f, 
			0x92, 0x7e, 0xa8, 0xf7, 0x40, 0xce, 0x0e, 0x87, 0x15, 0x49, 0x65, 0x50, 0x5e, 0x22, 0x72, 0xf6, 
			0x90, 0x42, 0xb1, 0x5d, 0x57, 0xcc, 0xc7, 0xf7, 0x71, 0x91, 0x91, 0x23, 0x97, 0x82, 0x83, 0xb3, 
			0xcc, 0xe5, 0x24, 0xd9, 0x71, 0x52, 0x07, 0xbf, 0x5f, 0x5a, 0xd3, 0x69, 0x10, 0x21, 0x76, 0xf0, 
			0xf7, 0xa7, 0x8a, 0x6d, 0xeb, 0x2b, 0xff, 0x0e, 0xdc, 0xe1, 0x65, 0xf3, 0xb1, 0x4f, 0x14, 0xd0, 
			0x03, 0x5b, 0x27, 0x56, 0x86, 0x1f, 0xe0, 0x3c, 0x43, 0x39, 0x6e, 0xd0, 0x02, 0xc8, 0x94, 0xa3
			},
		1,{0x03},{0x22, 0x12, 0x31},
		{0x62, 0x21, 0xE0, 0xC7, 0x26, 0xBA, 0xC8, 0xF8, 0xAC, 0x25, 0xF8, 0xF9, 0x3B, 0x81, 0x1D, 0x1F, 
			0xFD, 0x4C, 0x13, 0x1C}
	};

	EMV_CAPK capk_amex_liveC8={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xC8,
		0x01, 0x01, 144,
		{0xBF, 0x0C, 0xFC, 0xED, 0x70, 0x8F, 0xB6, 0xB0, 0x48, 0xE3, 0x01, 0x43, 0x36, 0xEA, 0x24, 0xAA, 
				0x00, 0x7D, 0x79, 0x67, 0xB8, 0xAA, 0x4E, 0x61, 0x3D, 0x26, 0xD0, 0x15, 0xC4, 0xFE, 0x78, 0x05, 
				0xD9, 0xDB, 0x13, 0x1C, 0xED, 0x0D, 0x2A, 0x8E, 0xD5, 0x04, 0xC3, 0xB5, 0xCC, 0xD4, 0x8C, 0x33, 
				0x19, 0x9E, 0x5A, 0x5B, 0xF6, 0x44, 0xDA, 0x04, 0x3B, 0x54, 0xDB, 0xF6, 0x02, 0x76, 0xF0, 0x5B, 
				0x17, 0x50, 0xFA, 0xB3, 0x90, 0x98, 0xC7, 0x51, 0x1D, 0x04, 0xBA, 0xBC, 0x64, 0x94, 0x82, 0xDD, 
				0xCF, 0x7C, 0xC4, 0x2C, 0x8C, 0x43, 0x5B, 0xAB, 0x8D, 0xD0, 0xEB, 0x1A, 0x62, 0x0C, 0x31, 0x11, 
				0x1D, 0x1A, 0xAA, 0xF9, 0xAF, 0x65, 0x71, 0xEE, 0xBD, 0x4C, 0xF5, 0xA0, 0x84, 0x96, 0xD5, 0x7E, 
				0x7A, 0xBD, 0xBB, 0x51, 0x80, 0xE0, 0xA4, 0x2D, 0xA8, 0x69, 0xAB, 0x95, 0xFB, 0x62, 0x0E, 0xFF, 
				0x26, 0x41, 0xC3, 0x70, 0x2A, 0xF3, 0xBE, 0x0B, 0x0C, 0x13, 0x8E, 0xAE, 0xF2, 0x02, 0xE2, 0x1D
				},
		1,{0x03},{0x17, 0x12, 0x31},
		{0x33, 0xBD, 0x7A, 0x05, 0x9F, 0xAB, 0x09, 0x49, 0x39, 0xB9, 0x0A, 0x8F, 0x35, 0x84, 0x5C, 0x9D, 
			0xC7, 0x79, 0xBD, 0x50}
	};

	EMV_CAPK capk_amex_liveC9={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xC9,
		0x01, 0x01, 176,
		{0xB3, 0x62, 0xDB, 0x57, 0x33, 0xC1, 0x5B, 0x87, 0x97, 0xB8, 0xEC, 0xEE, 0x55, 0xCB, 0x1A, 0x37, 
			0x1F, 0x76, 0x0E, 0x0B, 0xED, 0xD3, 0x71, 0x5B, 0xB2, 0x70, 0x42, 0x4F, 0xD4, 0xEA, 0x26, 0x06, 
			0x2C, 0x38, 0xC3, 0xF4, 0xAA, 0xA3, 0x73, 0x2A, 0x83, 0xD3, 0x6E, 0xA8, 0xE9, 0x60, 0x2F, 0x66, 
			0x83, 0xEE, 0xCC, 0x6B, 0xAF, 0xF6, 0x3D, 0xD2, 0xD4, 0x90, 0x14, 0xBD, 0xE4, 0xD6, 0xD6, 0x03, 
			0xCD, 0x74, 0x42, 0x06, 0xB0, 0x5B, 0x4B, 0xAD, 0x0C, 0x64, 0xC6, 0x3A, 0xB3, 0x97, 0x6B, 0x5C, 
			0x8C, 0xAA, 0xF8, 0x53, 0x95, 0x49, 0xF5, 0x92, 0x1C, 0x0B, 0x70, 0x0D, 0x5B, 0x0F, 0x83, 0xC4, 
			0xE7, 0xE9, 0x46, 0x06, 0x8B, 0xAA, 0xAB, 0x54, 0x63, 0x54, 0x4D, 0xB1, 0x8C, 0x63, 0x80, 0x11, 
			0x18, 0xF2, 0x18, 0x2E, 0xFC, 0xC8, 0xA1, 0xE8, 0x5E, 0x53, 0xC2, 0xA7, 0xAE, 0x83, 0x9A, 0x5C, 
			0x6A, 0x3C, 0xAB, 0xE7, 0x37, 0x62, 0xB7, 0x0D, 0x17, 0x0A, 0xB6, 0x4A, 0xFC, 0x6C, 0xA4, 0x82, 
			0x94, 0x49, 0x02, 0x61, 0x1F, 0xB0, 0x06, 0x1E, 0x09, 0xA6, 0x7A, 0xCB, 0x77, 0xE4, 0x93, 0xD9, 
			0x98, 0xA0, 0xCC, 0xF9, 0x3D, 0x81, 0xA4, 0xF6, 0xC0, 0xDC, 0x6B, 0x7D, 0xF2, 0x2E, 0x62, 0xDB
			},
		1,{0x03},{0x22, 0x12, 0x31},
		{0x8E, 0x8D, 0xFF, 0x44, 0x3D, 0x78, 0xCD, 0x91, 0xDE, 0x88, 0x82, 0x1D, 0x70, 0xC9, 0x8F, 0x06, 
			0x38, 0xE5, 0x1E, 0x49}
	};

	EMV_CAPK capk_amex_liveCA={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0xCA,
		0x01, 0x01, 248,
		{0xC2, 0x3E, 0xCB, 0xD7, 0x11, 0x9F, 0x47, 0x9C, 0x2E, 0xE5, 0x46, 0xC1, 0x23, 0xA5, 0x85, 0xD6, 
			0x97, 0xA7, 0xD1, 0x0B, 0x55, 0xC2, 0xD2, 0x8B, 0xEF, 0x0D, 0x29, 0x9C, 0x01, 0xDC, 0x65, 0x42, 
			0x0A, 0x03, 0xFE, 0x52, 0x27, 0xEC, 0xDE, 0xCB, 0x80, 0x25, 0xFB, 0xC8, 0x6E, 0xEB, 0xC1, 0x93, 
			0x52, 0x98, 0xC1, 0x75, 0x3A, 0xB8, 0x49, 0x93, 0x67, 0x49, 0x71, 0x95, 0x91, 0x75, 0x8C, 0x31, 
			0x5F, 0xA1, 0x50, 0x40, 0x07, 0x89, 0xBB, 0x14, 0xFA, 0xDD, 0x6E, 0xAE, 0x2A, 0xD6, 0x17, 0xDA, 
			0x38, 0x16, 0x31, 0x99, 0xD1, 0xBA, 0xD5, 0xD3, 0xF8, 0xF6, 0xA7, 0xA2, 0x0A, 0xEF, 0x42, 0x0A, 
			0xDF, 0xE2, 0x40, 0x4D, 0x30, 0xB2, 0x19, 0x35, 0x9C, 0x6A, 0x49, 0x52, 0x56, 0x5C, 0xCC, 0xA6, 
			0xF1, 0x1E, 0xC5, 0xBE, 0x56, 0x4B, 0x49, 0xB0, 0xEA, 0x5B, 0xF5, 0xB3, 0xDC, 0x8C, 0x5C, 0x64, 
			0x01, 0x20, 0x8D, 0x00, 0x29, 0xC3, 0x95, 0x7A, 0x8C, 0x59, 0x22, 0xCB, 0xDE, 0x39, 0xD3, 0xA5, 
			0x64, 0xC6, 0xDE, 0xBB, 0x6B, 0xD2, 0xAE, 0xF9, 0x1F, 0xC2, 0x7B, 0xB3, 0xD3, 0x89, 0x2B, 0xEB, 
			0x96, 0x46, 0xDC, 0xE2, 0xE1, 0xEF, 0x85, 0x81, 0xEF, 0xFA, 0x71, 0x21, 0x58, 0xAA, 0xEC, 0x54, 
			0x1C, 0x0B, 0xBB, 0x4B, 0x3E, 0x27, 0x9D, 0x7D, 0xA5, 0x4E, 0x45, 0xA0, 0xAC, 0xC3, 0x57, 0x0E, 
			0x71, 0x2C, 0x9F, 0x7C, 0xDF, 0x98, 0x5C, 0xFA, 0xFD, 0x38, 0x2A, 0xE1, 0x3A, 0x3B, 0x21, 0x4A, 
			0x9E, 0x8E, 0x1E, 0x71, 0xAB, 0x1E, 0xA7, 0x07, 0x89, 0x51, 0x12, 0xAB, 0xC3, 0xA9, 0x7D, 0x0F, 
			0xCB, 0x0A, 0xE2, 0xEE, 0x5C, 0x85, 0x49, 0x2B, 0x6C, 0xFD, 0x54, 0x88, 0x5C, 0xDD, 0x63, 0x37, 
			0xE8, 0x95, 0xCC, 0x70, 0xFB, 0x32, 0x55, 0xE3},
		1,{0x03},{0x22, 0x12, 0x31},
		{0x6B, 0xDA, 0x32, 0xB1, 0xAA, 0x17, 0x14, 0x44, 0xC7, 0xE8, 0xF8, 0x80, 0x75, 0xA7, 0x4F, 0xBF, 
			0xE8, 0x45, 0x76, 0x5F}
	};

	// =============== Added end =========================//
	
	EMV_CAPK capk_amex_live0E={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x0E,
	0x01, 0x01,144,
	{0xAA, 0x94, 0xA8, 0xC6, 0xDA, 0xD2, 0x4F, 0x9B, 0xA5, 0x6A, 0x27, 0xC0, 0x9B, 0x01, 0x02, 0x08,
	0x19, 0x56, 0x8B, 0x81, 0xA0, 0x26, 0xBE, 0x9F, 0xD0, 0xA3, 0x41, 0x6C, 0xA9, 0xA7, 0x11, 0x66,
	0xED, 0x50, 0x84, 0xED, 0x91, 0xCE, 0xD4, 0x7D, 0xD4, 0x57, 0xDB, 0x7E, 0x6C, 0xBC, 0xD5, 0x3E,
	0x56, 0x0B, 0xC5, 0xDF, 0x48, 0xAB, 0xC3, 0x80, 0x99, 0x3B, 0x6D, 0x54, 0x9F, 0x51, 0x96, 0xCF,
	0xA7, 0x7D, 0xFB, 0x20, 0xA0, 0x29, 0x61, 0x88, 0xE9, 0x69, 0xA2, 0x77, 0x2E, 0x8C, 0x41, 0x41,
	0x66, 0x5F, 0x8B, 0xB2, 0x51, 0x6B, 0xA2, 0xC7, 0xB5, 0xFC, 0x91, 0xF8, 0xDA, 0x04, 0xE8, 0xD5,
	0x12, 0xEB, 0x0F, 0x64, 0x11, 0x51, 0x6F, 0xB8, 0x6F, 0xC0, 0x21, 0xCE, 0x7E, 0x96, 0x9D, 0xA9,
	0x4D, 0x33, 0x93, 0x79, 0x09, 0xA5, 0x3A, 0x57, 0xF9, 0x07, 0xC4, 0x0C, 0x22, 0x00, 0x9D, 0xA7,
	0x53, 0x2C, 0xB3, 0xBE, 0x50, 0x9A, 0xE1, 0x73, 0xB3, 0x9A, 0xD6, 0xA0, 0x1B, 0xA5, 0xBB, 0x85},
	1,{0x03},{0x15, 0x12, 0x31},
	{0xA7, 0x26, 0x6A, 0xBA, 0xE6, 0x4B, 0x42, 0xA3, 0x66, 0x88, 0x51, 0x19, 0x1D, 0x49, 0x85, 0x6E,
	0x17, 0xF8, 0xFB, 0xCD}
	};
	
	EMV_CAPK capk_amex_live0F={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x0F,
	0x01, 0x01,176,
	{0xC8, 0xD5, 0xAC, 0x27, 0xA5, 0xE1, 0xFB, 0x89, 0x97, 0x8C, 0x7C, 0x64, 0x79, 0xAF, 0x99, 0x3A,
	0xB3, 0x80, 0x0E, 0xB2, 0x43, 0x99, 0x6F, 0xBB, 0x2A, 0xE2, 0x6B, 0x67, 0xB2, 0x3A, 0xC4, 0x82,
	0xC4, 0xB7, 0x46, 0x00, 0x5A, 0x51, 0xAF, 0xA7, 0xD2, 0xD8, 0x3E, 0x89, 0x4F, 0x59, 0x1A, 0x23,
	0x57, 0xB3, 0x0F, 0x85, 0xB8, 0x56, 0x27, 0xFF, 0x15, 0xDA, 0x12, 0x29, 0x0F, 0x70, 0xF0, 0x57,
	0x66, 0x55, 0x2B, 0xA1, 0x1A, 0xD3, 0x4B, 0x71, 0x09, 0xFA, 0x49, 0xDE, 0x29, 0xDC, 0xB0, 0x10,
	0x96, 0x70, 0x87, 0x5A, 0x17, 0xEA, 0x95, 0x54, 0x9E, 0x92, 0x34, 0x7B, 0x94, 0x8A, 0xA1, 0xF0,
	0x45, 0x75, 0x6D, 0xE5, 0x6B, 0x70, 0x7E, 0x38, 0x63, 0xE5, 0x9A, 0x6C, 0xBE, 0x99, 0xC1, 0x27,
	0x2E, 0xF6, 0x5F, 0xB6, 0x6C, 0xBB, 0x4C, 0xFF, 0x07, 0x0F, 0x36, 0x02, 0x9D, 0xD7, 0x62, 0x18,
	0xB2, 0x12, 0x42, 0x64, 0x5B, 0x51, 0xCA, 0x75, 0x2A, 0xF3, 0x7E, 0x70, 0xBE, 0x1A, 0x84, 0xFF,
	0x31, 0x07, 0x9D, 0xC0, 0x04, 0x8E, 0x92, 0x88, 0x83, 0xEC, 0x4F, 0xAD, 0xD4, 0x97, 0xA7, 0x19,
	0x38, 0x5C, 0x2B, 0xBB, 0xEB, 0xC5, 0xA6, 0x6A, 0xA5, 0xE5, 0x65, 0x5D, 0x18, 0x03, 0x4E, 0xC5},
	1,{0x03},{0x14, 0x12, 0x31},
	{0xA7, 0x34, 0x72, 0xB3, 0xAB, 0x55, 0x74, 0x93, 0xA9, 0xBC, 0x21, 0x79, 0xCC, 0x80, 0x14, 0x05,
	0x3B, 0x12, 0xBA, 0xB4}
	};
	
	//AMEX 1984 bits Live Key 10
	EMV_CAPK capk_amex_live10={{0xA0, 0x00, 0x00, 0x00, 0x25}, 0x10,
	0x01, 0x01,248,
	{0xCF, 0x98, 0xDF, 0xED, 0xB3, 0xD3, 0x72, 0x79, 0x65, 0xEE, 0x77, 0x97, 0x72, 0x33, 0x55, 0xE0,
	0x75, 0x1C, 0x81, 0xD2, 0xD3, 0xDF, 0x4D, 0x18, 0xEB, 0xAB, 0x9F, 0xB9, 0xD4, 0x9F, 0x38, 0xC8,
	0xC4, 0xA8, 0x26, 0xB9, 0x9D, 0xC9, 0xDE, 0xA3, 0xF0, 0x10, 0x43, 0xD4, 0xBF, 0x22, 0xAC, 0x35,
	0x50, 0xE2, 0x96, 0x2A, 0x59, 0x63, 0x9B, 0x13, 0x32, 0x15, 0x64, 0x22, 0xF7, 0x88, 0xB9, 0xC1,
	0x6D, 0x40, 0x13, 0x5E, 0xFD, 0x1B, 0xA9, 0x41, 0x47, 0x75, 0x05, 0x75, 0xE6, 0x36, 0xB6, 0xEB,
	0xC6, 0x18, 0x73, 0x4C, 0x91, 0xC1, 0xD1, 0xBF, 0x3E, 0xDC, 0x2A, 0x46, 0xA4, 0x39, 0x01, 0x66,
	0x8E, 0x0F, 0xFC, 0x13, 0x67, 0x74, 0x08, 0x0E, 0x88, 0x80, 0x44, 0xF6, 0xA1, 0xE6, 0x5D, 0xC9,
	0xAA, 0xA8, 0x92, 0x8D, 0xAC, 0xBE, 0xB0, 0xDB, 0x55, 0xEA, 0x35, 0x14, 0x68, 0x6C, 0x6A, 0x73,
	0x2C, 0xEF, 0x55, 0xEE, 0x27, 0xCF, 0x87, 0x7F, 0x11, 0x06, 0x52, 0x69, 0x4A, 0x0E, 0x34, 0x84,
	0xC8, 0x55, 0xD8, 0x82, 0xAE, 0x19, 0x16, 0x74, 0xE2, 0x5C, 0x29, 0x62, 0x05, 0xBB, 0xB5, 0x99,
	0x45, 0x51, 0x76, 0xFD, 0xD7, 0xBB, 0xC5, 0x49, 0xF2, 0x7B, 0xA5, 0xFE, 0x35, 0x33, 0x6F, 0x7E,
	0x29, 0xE6, 0x8D, 0x78, 0x39, 0x73, 0x19, 0x94, 0x36, 0x63, 0x3C, 0x67, 0xEE, 0x5A, 0x68, 0x0F,
	0x05, 0x16, 0x0E, 0xD1, 0x2D, 0x16, 0x65, 0xEC, 0x83, 0xD1, 0x99, 0x7F, 0x10, 0xFD, 0x05, 0xBB,
	0xDB, 0xF9, 0x43, 0x3E, 0x8F, 0x79, 0x7A, 0xEE, 0x3E, 0x9F, 0x02, 0xA3, 0x42, 0x28, 0xAC, 0xE9,
	0x27, 0xAB, 0xE6, 0x2B, 0x8B, 0x92, 0x81, 0xAD, 0x08, 0xD3, 0xDF, 0x5C, 0x73, 0x79, 0x68, 0x50,
	0x45, 0xD7, 0xBA, 0x5F, 0xCD, 0xE5, 0x86, 0x37},
	1,{0x03},{0x16, 0x12, 0x31},
	{0xC7, 0x29, 0xCF, 0x2F, 0xD2, 0x62, 0x39, 0x4A, 0xBC, 0x4C, 0xC1, 0x73, 0x50, 0x65, 0x02, 0x44,
	0x6A, 0xA9, 0xB9, 0xFD}
	};

	//discover test 5B
	EMV_CAPK capk_discover_test5B={{0xA0, 0x00, 0x00, 0x01, 0x52}, 0x5B,
	0x01, 0x01,144,
	{0xD3, 0xF4, 0x5D, 0x06, 0x5D, 0x4D, 0x90, 0x0F, 0x68, 0xB2, 0x12, 0x9A, 0xFA, 0x38, 0xF5, 0x49,
	0xAB, 0x9A, 0xE4, 0x61, 0x9E, 0x55, 0x45, 0x81, 0x4E, 0x46, 0x8F, 0x38, 0x20, 0x49, 0xA0, 0xB9,
	0x77, 0x66, 0x20, 0xDA, 0x60, 0xD6, 0x25, 0x37, 0xF0, 0x70, 0x5A, 0x2C, 0x92, 0x6D, 0xBE, 0xAD,
	0x4C, 0xA7, 0xCB, 0x43, 0xF0, 0xF0, 0xDD, 0x80, 0x95, 0x84, 0xE9, 0xF7, 0xEF, 0xBD, 0xA3, 0x77,
	0x87, 0x47, 0xBC, 0x9E, 0x25, 0xC5, 0x60, 0x65, 0x26, 0xFA, 0xB5, 0xE4, 0x91, 0x64, 0x6D, 0x4D,
	0xD2, 0x82, 0x78, 0x69, 0x1C, 0x25, 0x95, 0x6C, 0x8F, 0xED, 0x5E, 0x45, 0x2F, 0x24, 0x42, 0xE2,
	0x5E, 0xDC, 0x6B, 0x0C, 0x1A, 0xA4, 0xB2, 0xE9, 0xEC, 0x4A, 0xD9, 0xB2, 0x5A, 0x1B, 0x83, 0x62,
	0x95, 0xB8, 0x23, 0xED, 0xDC, 0x5E, 0xB6, 0xE1, 0xE0, 0xA3, 0xF4, 0x1B, 0x28, 0xDB, 0x8C, 0x3B,
	0x7E, 0x3E, 0x9B, 0x59, 0x79, 0xCD, 0x7E, 0x07, 0x9E, 0xF0, 0x24, 0x09, 0x5A, 0x1D, 0x19, 0xDD
	},
	1,{0x03},{0x16, 0x12, 0x31},
	{0x4D, 0xC5, 0xC6, 0xCA, 0xB6, 0xAE, 0x96, 0x97, 0x4D, 0x9D, 0xC8, 0xB2, 0x43, 0x5E, 0x21, 0xF5,
	0x26, 0xBC, 0x7A, 0x60}
	};

	// Added by Idina 2015-11-19	
	// ============ Discover ===============================================//
	EMV_CAPK capk_discover_test01={{0xA0, 0x00, 0x00, 0x01, 0x52}, 0x01,
	0x01, 0x01,128,
	{0x8D, 0x17, 0x27, 0xAB, 0x9D, 0xC8, 0x52, 0x45, 0x31, 0x93, 0xEA, 0x08, 0x10, 0xB1, 0x10, 0xF2, 
		0xA3, 0xFD, 0x30, 0x4B, 0xE2, 0x58, 0x33, 0x8A, 0xC2, 0x65, 0x0F, 0xA2, 0xA0, 0x40, 0xFA, 0x10, 
		0x30, 0x1E, 0xA5, 0x3D, 0xF1, 0x8F, 0xD9, 0xF4, 0x0F, 0x55, 0xC4, 0x4F, 0xE0, 0xEE, 0x7C, 0x72, 
		0x23, 0xBC, 0x64, 0x9B, 0x8F, 0x93, 0x28, 0x92, 0x57, 0x07, 0x77, 0x6C, 0xB8, 0x6F, 0x3A, 0xC3, 
		0x7D, 0x1B, 0x22, 0x30, 0x0D, 0x00, 0x83, 0xB4, 0x93, 0x50, 0xE0, 0x9A, 0xBB, 0x4B, 0x62, 0xA9, 
		0x63, 0x63, 0xB0, 0x1E, 0x41, 0x80, 0xE1, 0x58, 0xEA, 0xDD, 0xD6, 0x87, 0x8E, 0x85, 0xA6, 0xC9, 
		0xD5, 0x65, 0x09, 0xBF, 0x68, 0xF0, 0x40, 0x0A, 0xFF, 0xBC, 0x44, 0x1D, 0xDC, 0xCD, 0xAF, 0x91, 
		0x63, 0xC4, 0xAA, 0xCE, 0xB2, 0xC3, 0xE1, 0xEC, 0x13, 0x69, 0x9D, 0x23, 0xCD, 0xA9, 0xD3, 0xAD
		},
	1,{0x03},{0x15, 0x12, 0x31},
	{0xE0, 0xC2, 0xC1, 0xEA, 0x41, 0x1D, 0xB2, 0x4E, 0xC3, 0xE7, 0x6A, 0x94, 0x03, 0xF0, 0xB7, 0xB6, 
		0xF4, 0x06, 0xF3, 0x98}
	};

	EMV_CAPK capk_discover_test5A={{0xA0, 0x00, 0x00, 0x01, 0x52}, 0x5A,
	0x01, 0x01,128,
	{0xED, 0xD8, 0x25, 0x24, 0x68, 0xA7, 0x05, 0x61, 0x4B, 0x4D, 0x07, 0xDE, 0x32, 0x11, 0xB3, 0x00, 
		0x31, 0xAE, 0xDB, 0x6D, 0x33, 0xA4, 0x31, 0x5F, 0x2C, 0xFF, 0x7C, 0x97, 0xDB, 0x91, 0x89, 0x93, 
		0xC2, 0xDC, 0x02, 0xE7, 0x9E, 0x2F, 0xF8, 0xA2, 0x68, 0x3D, 0x5B, 0xBD, 0x0F, 0x61, 0x4B, 0xC9, 
		0xAB, 0x36, 0x0A, 0x44, 0x82, 0x83, 0xEF, 0x8B, 0x9C, 0xF6, 0x73, 0x1D, 0x71, 0xD6, 0xBE, 0x93, 
		0x9B, 0x7C, 0x5D, 0x0B, 0x04, 0x52, 0xD6, 0x60, 0xCF, 0x24, 0xC2, 0x1C, 0x47, 0xCA, 0xC8, 0xE2, 
		0x69, 0x48, 0xC8, 0xEE, 0xD8, 0xE3, 0xD0, 0x0C, 0x01, 0x68, 0x28, 0xD6, 0x42, 0x81, 0x6E, 0x65, 
		0x8D, 0xC2, 0xCF, 0xC6, 0x1E, 0x7E, 0x7D, 0x77, 0x40, 0x63, 0x3B, 0xEF, 0xE3, 0x41, 0x07, 0xC1, 
		0xFB, 0x55, 0xDE, 0xA7, 0xFA, 0xAE, 0xA2, 0xB2, 0x5E, 0x85, 0xBE, 0xD9, 0x48, 0x89, 0x3D, 0x07
		},
	1,{0x03},{0x15, 0x12, 0x31},
	{0x95, 0xF4, 0xD0, 0x45, 0x42, 0x2D, 0x09, 0x20, 0xD0, 0x4E, 0x96, 0x14, 0xB7, 0x14, 0xD9, 0x36, 
		0xDE, 0xA1, 0xAA, 0xCA}
	};

	EMV_CAPK capk_discover_test5C={{0xA0, 0x00, 0x00, 0x01, 0x52}, 0x5C,
	0x01, 0x01,177,
	{0x83, 0x3F, 0x27, 0x5F, 0xCF, 0x5C, 0xA4, 0xCB, 0x6F, 0x1B, 0xF8, 0x80, 0xE5, 0x4D, 0xCF, 0xEB, 
		0x72, 0x1A, 0x31, 0x66, 0x92, 0xCA, 0xFE, 0xB2, 0x8B, 0x69, 0x8C, 0xAE, 0xCA, 0xFA, 0x2B, 0x2D, 
		0x2A, 0xD8, 0x51, 0x7B, 0x1E, 0xFB, 0x59, 0xDD, 0xEF, 0xC3, 0x9F, 0x9C, 0x3B, 0x33, 0xDD, 0xEE, 
		0x40, 0xE7, 0xA6, 0x3C, 0x03, 0xE9, 0x0A, 0x4D, 0xD2, 0x61, 0xBC, 0x0F, 0x28, 0xB4, 0x2E, 0xA6, 
		0xE7, 0xA1, 0xF3, 0x07, 0x17, 0x8E, 0x2D, 0x63, 0xFA, 0x16, 0x49, 0x15, 0x5C, 0x3A, 0x5F, 0x92, 
		0x6B, 0x4C, 0x7D, 0x7C, 0x25, 0x8B, 0xCA, 0x98, 0xEF, 0x90, 0xC7, 0xF4, 0x11, 0x7C, 0x20, 0x5E, 
		0x8E, 0x32, 0xC4, 0x5D, 0x10, 0xE3, 0xD4, 0x94, 0x05, 0x9D, 0x2F, 0x29, 0x33, 0x89, 0x1B, 0x97, 
		0x9C, 0xE4, 0xA8, 0x31, 0xB3, 0x01, 0xB0, 0x55, 0x0C, 0xDA, 0xE9, 0xB6, 0x70, 0x64, 0xB3, 0x1D, 
		0x8B, 0x48, 0x1B, 0x85, 0xA5, 0xB0, 0x46, 0xBE, 0x8F, 0xFA, 0x7B, 0xDB, 0x58, 0xDC, 0x0D, 0x70, 
		0x32, 0x52, 0x52, 0x97, 0xF2, 0x6F, 0xF6, 0x19, 0xAF, 0x7F, 0x15, 0xBC, 0xEC, 0x0C, 0x92, 0xBC, 
		0xDC, 0xBC, 0x4F, 0xB2, 0x07, 0xD1, 0x15, 0xAA, 0x65, 0xCD, 0x04, 0xC1, 0xCF, 0x98, 0x21, 0x91
		},
	1,{0x03},{0x15, 0x12, 0x31},
	{0x60, 0x15, 0x40, 0x98, 0xCB, 0xBA, 0x35, 0x0F, 0x5F, 0x48, 0x6C, 0xA3, 0x10, 0x83, 0xD1, 0xFC, 
		0x47, 0x4E, 0x31, 0xF8}
	};
	// ============ Added end ===============================================//

	EMV_CAPK capk_jcb_t11={{0xA0,0x00,0x00,0x00,0x65},0x11,
		0x01,0x01,176,
		{0xA2, 0x58, 0x3A, 0xA4, 0x07, 0x46, 0xE3, 0xA6, 0x3C, 0x22, 0x47, 0x8F, 0x57, 0x6D, 0x1E, 0xFC, 
			0x5F, 0xB0, 0x46, 0x13, 0x5A, 0x6F, 0xC7, 0x39, 0xE8, 0x2B, 0x55, 0x03, 0x5F, 0x71, 0xB0, 0x9B, 
			0xEB, 0x56, 0x6E, 0xDB, 0x99, 0x68, 0xDD, 0x64, 0x9B, 0x94, 0xB6, 0xDE, 0xDC, 0x03, 0x38, 0x99, 
			0x88, 0x4E, 0x90, 0x8C, 0x27, 0xBE, 0x1C, 0xD2, 0x91, 0xE5, 0x43, 0x6F, 0x76, 0x25, 0x53, 0x29, 
			0x77, 0x63, 0xDA, 0xA3, 0xB8, 0x90, 0xD7, 0x78, 0xC0, 0xF0, 0x1E, 0x33, 0x44, 0xCE, 0xCD, 0xFB, 
			0x3B, 0xA7, 0x0D, 0x7E, 0x05, 0x5B, 0x8C, 0x76, 0x0D, 0x01, 0x79, 0xA4, 0x03, 0xD6, 0xB5, 0x5F, 
			0x2B, 0x3B, 0x08, 0x39, 0x12, 0xB1, 0x83, 0xAD, 0xB7, 0x92, 0x74, 0x41, 0xBE, 0xD3, 0x39, 0x5A, 
			0x19, 0x9E, 0xEF, 0xE0, 0xDE, 0xBD, 0x1F, 0x5F, 0xC3, 0x26, 0x40, 0x33, 0xDA, 0x85, 0x6F, 0x4A, 
			0x8B, 0x93, 0x91, 0x68, 0x85, 0xBD, 0x42, 0xF9, 0xC1, 0xF4, 0x56, 0xAA, 0xB8, 0xCF, 0xA8, 0x3A, 
			0xC5, 0x74, 0x83, 0x3E, 0xB5, 0xE8, 0x7B, 0xB9, 0xD4, 0xC0, 0x06, 0xA4, 0xB5, 0x34, 0x6B, 0xD9, 
			0xE1, 0x7E, 0x13, 0x9A, 0xB6, 0x55, 0x2D, 0x9C, 0x58, 0xBC, 0x04, 0x11, 0x95, 0x33, 0x64, 0x85
			},
		1,{0x03}, {0x20,0x12,0x31},
		{0xD9, 0xFD, 0x62, 0xC9, 0xDD, 0x4E, 0x6D, 0xE7, 0x74, 0x1E, 0x9A, 0x17, 0xFB, 0x1F, 0xF2, 0xC5, 
			0xDB, 0x94, 0x8B, 0xCB}
		};

	struct{
		unsigned char KeyID;
		EMV_CAPK *KeyValue;
	}AllTestEmvKey[]={
	//	{0x02,&capk_amex_live02},
		{0x03,&capk_visa_v03},
		{0x0E,&capk_visa_v05},
		{0x0F,&capk_visa_v09},
		{0x57,&capk_visa_v57},
		{0x90,&capk_visa_v90},
		{0x92,&capk_visa_v92},
		{0x94,&capk_visa_v94},
		{0x95,&capk_visa_v95},
		{0x96,&capk_visa_v96},
		{0x98,&capk_visa_v98},
		{0x99,&capk_visa_v99},
		{0x03, &capk_amex_live03},
		{0x0E, &capk_amex_live0E},
		{0x0F, &capk_amex_live0F},
		{0x10, &capk_amex_live10},
		{0x5B, &capk_discover_test5B},
		{0x01, &capk_visa_v01},
		{0x07, &capk_visa_v07},
		{0x08, &capk_visa_v08},
		{0xef, &capk_mastercard_tEF},
		{0xf1, &capk_mastercard_vf1},
		{0xfa, &capk_mastercard_vfa},
		{0xfe, &capk_mastercard_vfe},
		{0x04, &capk_mastercard_v04},
		{0x05, &capk_mastercard_v05},
		{0x03, &capk_mastercard_v03},
		{0xf0, &capk_mastercard_vf0},
		{0xf3, &capk_mastercard_vf3},
		{0xf8, &capk_mastercard_vf8},
		{0x06, &capk_mastercard_v06},
		// Added by Idina 2015-11-19
		// MC
		{0xF8,&capk_mastercard_vf8},	
		{0xF3,&capk_mastercard_vf3},
		{0xF0,&capk_mastercard_vf0},
		{0x03,&capk_mastercard_v03},
		// AE
		{0xCA,&capk_amex_liveCA},
		{0xC9,&capk_amex_liveC9},
		{0xC8,&capk_amex_liveC8},
		{0xC7,&capk_amex_liveC7},
		{0xC3,&capk_amex_liveC3},
		{0xC2,&capk_amex_liveC2},
		{0xC1,&capk_amex_liveC1},
		{0xA1,&capk_amex_liveA1},
		{0x99,&capk_amex_live99},
		{0x98,&capk_amex_live98},
		{0x97,&capk_amex_live97},
		{0x67,&capk_amex_live67},
		{0x66,&capk_amex_live66},
		{0x65,&capk_amex_live65},
		{0x64,&capk_amex_live64},
		{0x62,&capk_amex_live62},
		{0x08,&capk_amex_live08},
		{0x04,&capk_amex_live04}, 

		// Discover
		{0x5C,&capk_discover_test5C},
		{0x5A,&capk_discover_test5A},
		{0x01,&capk_discover_test01},

		// JCB
		{0x11,&capk_jcb_t11}
	};

	iFd = PdkFile_Open(EMV_CAPK_LIST_FILE);
	if ( iFd < 0 ) {
		return iFd;
	}

	PdkFile_Seek(iFd, 0, SEEK_END);

	for(i=0; i < 56; i++)
	{
		iRet = PdkFile_Write(iFd, AllTestEmvKey[i].KeyValue, sizeof(EMV_CAPK));
	}
	g_stEmvParamInfo.usCapkNum += 56; 

	PdkFile_Close(iFd);

	return 0;
}

void writeEMVPARAM(void)
{
	EMV_PARAM EmvParam;

	memcpy(EmvParam.MerchName,"LINING",strlen("LINING")+1);
	memcpy(EmvParam.MerchId,"1234",strlen("1234")+1);
	memcpy(EmvParam.TermId,"12345",strlen("12345")+1);
	memcpy(EmvParam.Capability, "\xE0\xF1\xC8", 3);
    memcpy(EmvParam.ExCapability, "\xE0\x00\xF0\xA0\x01", 5);
    EmvParam.ForceOnline = 0;
    EmvParam.GetDataPIN = 3;
    memcpy(EmvParam.MerchCateCode, "\x00\x00", 2);
    EmvParam.ReferCurrCon = 1000;
    EmvParam.ReferCurrExp = 0x02;
    EmvParam.SurportPSESel = 1;
    EmvParam.TerminalType = 0x22;
    EmvParam.TransCurrExp = 0x02;
    EmvParam.TransType = EMV_GOODS;
	memcpy(EmvParam.CountryCode, "\x08\x40", 2);
	memcpy(EmvParam.ReferCurrCode, "\x08\x40", 2);
	memcpy(EmvParam.TransCurrCode, "\x08\x40", 2);

	TableFsWrite(g_stEmvParamInfo.usParamBlkIdx, 0, sizeof(EMV_PARAM), (uchar *)(&EmvParam));

	return;
}

void InitEmvParamInfo(void)
{
	g_stEmvParamInfo.usAidCurBlkIdx = 0;
	g_stEmvParamInfo.usCapkCurBlkIdx = 0;
	g_stEmvParamInfo.usCapkCurBlkPos = 0;
	g_stEmvParamInfo.usRevokeCapkBlkIdx = 0;
	g_stEmvParamInfo.usRevokeCapkBlkPos = 0;
}

void WriteEMVPARA(void)
{	
	int iCapkInfoBlockIndex = FILE_EMV_CAPK_INFO_BLOCK_START, iCapkInfoBlockPos = 0;
	writeEMVAPP();
	//writeEMVCAPK(&iCapkInfoBlockIndex, &iCapkInfoBlockPos);
	//writeEMVCAPK_MoreVisa(&iCapkInfoBlockIndex, &iCapkInfoBlockPos);
	WriteTestCAPK(&iCapkInfoBlockIndex, &iCapkInfoBlockPos);
	writeEMVPARAM();
	
	g_stEmvParamInfo.ucFlag = 0x01;
	TableFsWrite(FILE_EMV_PARAM_INFO_BLOCK_START, 0, sizeof(g_stEmvParamInfo), (uchar *)(&(g_stEmvParamInfo)));

	InitEmvParamInfo();
}

void EMVSetPARAM(void)
{
	EMV_PARAM EmvParam;

	memcpy(EmvParam.MerchName,"LINING",strlen("LINING")+1);
	memcpy(EmvParam.MerchId,"1234",strlen("1234")+1);
	memcpy(EmvParam.TermId,"12345",strlen("12345")+1);
	memcpy(EmvParam.Capability, "\xE0\xF1\xC8", 3);
    memcpy(EmvParam.ExCapability, "\xE0\x00\xF0\xA0\x01", 5);
    EmvParam.ForceOnline = 0;
    EmvParam.GetDataPIN = 3;
    memcpy(EmvParam.MerchCateCode, "\x00\x00", 2);
    EmvParam.ReferCurrCon = 1000;
    EmvParam.ReferCurrExp = 0x02;
    EmvParam.SurportPSESel = 1;
    EmvParam.TerminalType = 0x22;
    EmvParam.TransCurrExp = 0x02;
    EmvParam.TransType = EMV_GOODS;
	memcpy(EmvParam.CountryCode, "\x08\x40", 2);
	memcpy(EmvParam.ReferCurrCode, "\x08\x40", 2);
	memcpy(EmvParam.TransCurrCode, "\x08\x40", 2);

	EMVSetParameter(&EmvParam);
}


// Load EMV application parameters from table file system
int EMVLoadAppFromFile()
{
	int				iRet=0, i=0, iBlockIndex=FILE_EMV_AID_BLOCK_START, iFd=0;
	EMV_APPLIST		stEmvApp;

	iFd = PdkFile_Open(EMV_APP_LIST_FILE);
	if(iFd < 0)
	{
		return iFd;
	}

#ifdef EMV_PARAM_TEST_
	for(i=0; i<g_stEmvParamInfo.usAidNum; i++)
	{
		memset(&stEmvApp, 0, sizeof(EMV_APPLIST));
		//TableFsRead(iBlockIndex, 0, sizeof(EMV_APPLIST), (unsigned char *)&stEmvApp);
		iRet = PdkFile_Read(iFd, (uchar *)&stEmvApp, sizeof(EMV_APPLIST));
		if(iRet == sizeof(EMV_APPLIST))
		{
#ifndef _WIN32
			EMVAddApp(&stEmvApp);
#endif
		}
//		iBlockIndex ++;
	}
#else
	// TODO
#endif

	PdkFile_Close(iFd);

	return iRet;
}

int EMVLoadSpecificApp(unsigned char *pucAid, int iAidLen, EMV_APPLIST *pstEmvApp)
{
	int iFd=0, iRet=-1, i=0;
	EMV_APPLIST stEmvApp;

	iFd = PdkFile_Open(EMV_APP_LIST_FILE);
	if(iFd < 0)
	{
		return iFd;
	}

	for(i=0; i<g_stEmvParamInfo.usAidNum; i++)
	{
		iRet = PdkFile_Read(iFd, (uchar *)&stEmvApp, sizeof(EMV_APPLIST));
		if(iRet == sizeof(EMV_APPLIST))
		{
			if(memcmp(stEmvApp.AID, pucAid, iAidLen) == 0)
			{
				memcpy(pstEmvApp, &stEmvApp, sizeof(EMV_APPLIST));
				iRet = 0;
				break;
			}
		}
	}

	PdkFile_Close(iFd);

	return iRet;
}

int EMVLoadSpecificApp1(unsigned char *pucAid, int iAidLen, EMV_APPLIST *pstEmvApp)
{
	int				iRet=-1, iFd=0, i=0, iCnt=0, iBlockIndex=FILE_EMV_AID_INFO_BLOCK_START, iReadLen=0, iOffset=0, iInnerOffet=0, iEmvAppInfoLen=0;
	EMV_APPLIST		stEmvApp;
	EMVAppInfo		stEmvAppInfo;
	unsigned char	aucBuff[TABLE_FS_BLOCK_SIZE+1];

#ifdef EMV_PARAM_TEST_
	iEmvAppInfoLen = g_stEmvParamInfo.usAidNum * sizeof(EMVAppInfo);

#ifdef DEBUG_
	{
		unsigned char aucStrAid[34+1];

		memset(aucStrAid, 0, sizeof(aucStrAid));
		PubBcd2Asc(pucAid, iAidLen, aucStrAid);
		AppLog("[EMVLoadSpecificApp] AID=%s, iAidLen=%d, iEmvAppInfoLen=%d, AidNum=%d\n", aucStrAid, iAidLen, iEmvAppInfoLen, g_stEmvParamInfo.usAidNum);
	}
#endif
	
	while(iOffset < iEmvAppInfoLen)
	{
		if(iEmvAppInfoLen - iOffset > TABLE_FS_BLOCK_SIZE)
		{
			iReadLen = TABLE_FS_BLOCK_SIZE;
		}
		else
		{
			iReadLen = iEmvAppInfoLen - iOffset;
		}

		memset(aucBuff, 0, sizeof(aucBuff));
		TableFsRead(iBlockIndex, 0, iReadLen, aucBuff);
#ifdef DEBUG_
		AppLog("[EMVLoadSpecificApp] Read AppInfo, BlockIndex=%d, ReadLen=%d \n",  iBlockIndex, iReadLen);
		AppHexLog("[EMVLoadSpecificApp] AppInfo HEX: ",  aucBuff, iReadLen);
#endif
		for(i=iCnt; i<g_stEmvParamInfo.usAidNum && iInnerOffet < MIN(TABLE_FS_BLOCK_SIZE, iReadLen); i++)
		{
			memcpy((unsigned char *)&stEmvAppInfo, aucBuff + iInnerOffet, sizeof(EMVAppInfo));
#ifdef DEBUG_
			{
				unsigned char aucStrAid[34+1];

				memset(aucStrAid, 0, sizeof(aucStrAid));
				PubBcd2Asc(stEmvAppInfo.aucAid, 17, aucStrAid);

				AppLog("[EMVLoadSpecificApp] i=%d, AID Num=%d, iInnerOffset=%d, iReadLen=%d\n", i, g_stEmvParamInfo.usAidNum, iInnerOffet, iReadLen);
				AppLog("[EMVLoadSpecificApp] AID read from file: %s\n", aucStrAid);
				AppLog("[EMVLoadSpecificApp] -------------------------------------------------\n");
			}
#endif
			if(memcmp(stEmvAppInfo.aucAid, pucAid, iAidLen) == 0)
			{
				memset(&stEmvApp, 0, sizeof(EMV_APPLIST));
				TableFsRead(stEmvAppInfo.usAidBlkIdx, 0, sizeof(EMV_APPLIST), (unsigned char *)&stEmvApp);
				pstEmvApp = &stEmvApp;

				return 0;
			}

			iInnerOffet += sizeof(EMVAppInfo);
		}

		iBlockIndex ++;
		iOffset += iReadLen;
		iCnt = i;
		i=0;
		iInnerOffet = 0;
	}	
#else
	// TODO
#endif

	return iRet;
}

int EMVLoadSpecificCapk(unsigned char *pucRid, unsigned char ucKeyIndex, EMV_CAPK *pstEmvCapk)
{
	int				iRet=-1, i=0, iCnt=0, iReadLen=0, iOffset=0, iInnerOffset=0, iEmvCapkInfoLen=0, iFd=0;
	EMVCapkInfo		stEmvCapkInfo;
	EMV_CAPK		stEmvCapk;
	unsigned char	aucBuff[TABLE_FS_BLOCK_SIZE+1];

	iFd = PdkFile_Open(EMV_CAPK_LIST_FILE);
	if ( iFd < 0 ) {
		return iFd;
	}

	for(i=0; i < g_stEmvParamInfo.usCapkNum; i++)
	{
		memset(&stEmvCapk, 0, sizeof(EMV_CAPK));
		iRet = PdkFile_Read(iFd, &stEmvCapk, sizeof(EMV_CAPK));
		if ( iRet == sizeof(EMV_CAPK) ) {
			if ( 0 == memcmp(pucRid, stEmvCapk.RID, sizeof(stEmvCapk.RID)) && ucKeyIndex == stEmvCapk.KeyID) {
				memcpy(pstEmvCapk, &stEmvCapk, sizeof(EMV_CAPK));
				break;
			}
		}
		
	}

	PdkFile_Close(iFd);

	return iRet;
}


void AppLog(char *formatString, ...)
{
#ifdef DEBUG_SERIAL
    unsigned char timeBuffer[8];
    unsigned char buffer[1024];
    va_list ap;

    GetTime(timeBuffer);
    sprintf(buffer, "%02x/%02x/%02x %02x:%02x:%02x -- ", timeBuffer[0], timeBuffer[1], timeBuffer[2], timeBuffer[3], timeBuffer[4], timeBuffer[5]);

    va_start(ap, formatString);
    vsprintf(buffer+strlen(buffer), formatString, ap);
    va_end(ap);
	
	PortSends(PORT_USB, buffer, strlen(buffer));

	//PortSend(PORT_USB, '\n');

	DelayMs(20);
#endif
}

void AppStrLog(char *formatString, ...)
{
#ifdef DEBUG_SERIAL
    unsigned char buffer[1024];
    va_list ap;

	memset(buffer, 0, sizeof(buffer));
    va_start(ap, formatString);
    vsprintf(buffer+strlen(buffer), formatString, ap);
    va_end(ap);
	
	PortSends(PORT_USB, buffer, strlen(buffer));

	//PortSend(PORT_USB, '\n');

	DelayMs(20);
#endif
}

void AppHexLog(unsigned char *pucMsg, unsigned char *pucData, int iDataLen)
{
#ifdef DEBUG_SERIAL
    unsigned char timeBuffer[8], aucBuf[8+1];
    unsigned char buffer[1024];
	int i=0;

    GetTime(timeBuffer);
    sprintf(buffer, "%02x/%02x/%02x %02x:%02x:%02x -- %s", timeBuffer[0], timeBuffer[1], timeBuffer[2], timeBuffer[3], timeBuffer[4], timeBuffer[5], pucMsg);
	PortSends(PORT_USB, buffer, strlen(buffer));

    for(i=0; i<iDataLen; i++)
	{
		memset(aucBuf, 0, sizeof(aucBuf));
		sprintf(aucBuf, "%02x ", pucData[i]);
		PortSends(PORT_USB, aucBuf, 3);
	}
	
	PortSend(PORT_USB, '\n');

	DelayMs(50);
	
#endif
}

#endif


